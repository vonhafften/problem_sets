mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Unconditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue")
lines(x, pp_high, col ="blue")
abline(v= bp_mean, lty = 2, col = "red")
abline(v= pp_mean, lty = 2, col = "blue")
rho <- 0.5
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Unconditional Loan Returns")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Unconditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue")
lines(x, pp_high, col ="blue")
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue")
lines(x, pp_low, col ="blue", lty = 4)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue", lty = 4)
plot(x, bp_low, type = "l", col = "red",lty = 4, ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue")
plot(x, bp_low, type = "l", col = "red",lty = 4, ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue", lty = 4)
lines(x, pp_high, col ="blue")
mu <-  0.04
sigma <- 0.04
rho <- 0.25
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Unconditional Loan Returns")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
plot(x, bp_low, type = "l", col = "red",lty = 4, ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue", lty = 4)
lines(x, pp_high, col ="blue")
plot(x, bp_low, type = "l", col = "red",lty = 4, ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue", lty = 4)
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
abline(v= pp_high_mean, lty = 2, col = "blue")
rho <- 0.3
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Unconditional Loan Returns")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
plot(x, bp_low, type = "l", col = "red",lty = 4, ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue", lty = 4)
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
abline(v= pp_high_mean, lty = 2, col = "blue")
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional Loan Returns")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Limited Liability with Conditional Loan Returns")
lines(x, bp_high, col ="red")
lines(x, pp_low, col ="blue")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Loan Returns Conditional on High Signal")
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Loan Returns Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Loan Returns Conditional on High Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
library("truncnorm")
mu <-  0.04
sigma <- 0.04
rho <- 0.3
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
png("ll_u.png", width = 480, height = 360)
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional Loan Returns")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
png("ll_high.png", width = 480, height = 360)
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Loan Returns Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
png("ll_low.png", width = 480, height = 360)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Loan Returns Conditional on High Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
library("truncnorm")
setwd("/Users/vonhafften/Documents/UW Madison/problem_sets/econ_717b/proposal/")
mu <-  0.04
sigma <- 0.04
rho <- 0.3
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
png("ll_u.png", width = 480, height = 360)
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional Loan Returns")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
png("ll_high.png", width = 480, height = 360)
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Loan Returns Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
png("ll_low.png", width = 480, height = 360)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Loan Returns Conditional on High Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
library("truncnorm")
setwd("/Users/vonhafften/Documents/UW Madison/problem_sets/econ_717b/proposal/")
mu <-  0.04
sigma <- 0.04
rho <- 0.3
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
png("ll_u.png", width = 480, height = 360)
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
png("ll_high.png", width = 480, height = 360)
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
png("ll_low.png", width = 480, height = 360)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on Low Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
library("truncnorm")
setwd("/Users/vonhafften/Documents/UW Madison/problem_sets/econ_717b/proposal/")
mu <-  0.04
sigma <- 0.04
rho <- 0.5
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
png("ll_u.png", width = 480, height = 360)
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
png("ll_high.png", width = 480, height = 360)
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
png("ll_low.png", width = 480, height = 360)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on Low Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
library("truncnorm")
setwd("/Users/vonhafften/Documents/UW Madison/problem_sets/econ_717b/proposal/")
mu <-  0.04
sigma <- 0.04
rho <- 0.5
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
png("ll_u.png", width = 480, height = 360)
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
png("ll_high.png", width = 480, height = 360)
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
png("ll_low.png", width = 480, height = 360)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on Low Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topleft", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
library("truncnorm")
setwd("/Users/vonhafften/Documents/UW Madison/problem_sets/econ_717b/proposal/")
mu <-  0.04
sigma <- 0.04
rho <- 0.5
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
png("ll_u.png", width = 480, height = 360)
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
mu_low <- mu - sigma*rho*2
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*2
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
png("ll_high.png", width = 480, height = 360)
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topleft", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
png("ll_low.png", width = 480, height = 360)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on Low Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
library("truncnorm")
setwd("/Users/vonhafften/Documents/UW Madison/problem_sets/econ_717b/proposal/")
mu <-  0.04
sigma <- 0.04
rho <- 0.5
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
png("ll_u.png", width = 480, height = 360)
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
mu_low <- mu - sigma*rho
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
png("ll_high.png", width = 480, height = 360)
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topleft", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
png("ll_low.png", width = 480, height = 360)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on Low Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
library("truncnorm")
setwd("/Users/vonhafften/Documents/UW Madison/problem_sets/econ_717b/proposal/")
mu <-  0.04
sigma <- 0.04
rho <- 0.5
x <- seq(-0.1, 0.2, length = 1000)
pp_u <- dnorm(x, mu, sigma)
pp_u_mean <- sum(x * pp_u/sum(pp_u))
bp_u <- dtruncnorm(x, a=0, mean = mu, sd = sigma)
bp_u_mean <- sum(x * bp_u/sum(bp_u))
png("ll_u.png", width = 480, height = 360)
plot(x, bp_u, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Unconditional")
lines(x, pp_u, col ="blue")
abline(v= bp_u_mean, lty = 2, col = "red")
abline(v= pp_u_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
mu_low <- mu - sigma*rho*1
sigma_low <- sqrt((1 - rho^2)*sigma^2)
pp_low <- dnorm(x, mu_low, sigma_low)
pp_low_mean <- sum(x * pp_low/sum(pp_low))
bp_low <- dtruncnorm(x, a=0, mean = mu_low, sd = sigma_low)
bp_low_mean <- sum(x * bp_low/sum(bp_low))
mu_high <- mu + sigma*rho*1
sigma_high <-  sqrt((1 - rho^2)*sigma^2)
pp_high <- dnorm(x, mu_high, sigma_high)
pp_high_mean <- sum(x * pp_high/sum(pp_high))
bp_high <- dtruncnorm(x, a=0, mean = mu_high, sd = sigma_high)
bp_high_mean <- sum(x * bp_high/sum(bp_high))
png("ll_high.png", width = 480, height = 360)
plot(x, bp_high, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on High Signal")
lines(x, pp_high, col ="blue")
abline(v= bp_high_mean, lty = 2, col = "red")
abline(v= pp_high_mean, lty = 2, col = "blue")
legend("topleft", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
png("ll_low.png", width = 480, height = 360)
plot(x, bp_low, type = "l", col = "red", ylab = "Probability", xlab = "i", main = "Conditional on Low Signal")
lines(x, pp_low, col ="blue")
abline(v= bp_low_mean, lty = 2, col = "red")
abline(v= pp_low_mean, lty = 2, col = "blue")
legend("topright", c("Planner Problem", "Bank Problem"), lty = c(1, 1), col = c("blue", "red"))
dev.off()
