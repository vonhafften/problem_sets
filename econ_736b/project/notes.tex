\documentclass{article}
\usepackage{amsmath,amsthm,amssymb,amsfonts}
\usepackage{setspace,enumitem}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{natbib}
\usepackage{afterpage}
\usepackage{xcolor}
\usepackage{etoolbox}
\usepackage{bbm}
\usepackage{booktabs}
\usepackage{pdfpages}
\usepackage{multicol}
\usepackage{soul}
\usepackage{geometry}
\usepackage{accents}
\usepackage{accents}
\hypersetup{
	colorlinks,
	linkcolor={blue!90!black},
	citecolor={red!90!black},
	urlcolor={blue!90!black}
}
\usepackage{setspace}

\newtheorem{theorem}{Theorem}
\newtheorem{assumption}{Assumption}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{lemma}{Lemma}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Lfn}{\mathcal{L}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\one}{\mathbbm{1}}
\newcommand{\Int}{\text{Int}}
\newcommand{\ubar}[1]{\underaccent{\bar}{#1}}
\newcommand{\xbf}{\mathbf{x}}
\newcommand{\Abf}{\mathbf{A}}
\newcommand{\Bbf}{\mathbf{B}}
\newcommand{\Gbf}{\mathbf{G}}
\newcommand{\bbf}{\mathbf{b}}
\newcommand{\Ebf}{\mathbf{E}}
\setlength\parindent{0pt}

\newtheorem{innercustomthm}{Proposition}
\newenvironment{customthm}[1]
  {\renewcommand\theinnercustomthm{#1}\innercustomthm}
  {\endinnercustomthm}

\title{Notes on Heathcote, Storesletten, and Violante (2017)}
\author{Alex von Hafften}
\date{\today}

\begin{document}

\maketitle

My notes follow the organization of the paper. Particular focus is on sections 3, 4, and 5. In creating these notes, I used the online appendix for the original paper. The appendix has notes from Job's lecture on related papers, Heathcote, Storesletten, and Violante (2014) and Boerma and Karabarbounis (2021).



\section{Introduction}



\begin{itemize}
\item What is the optimal degree of progressivity of tax/transfer system?
\item Reasons for more progressivity
\begin{itemize}
\item Counteracts inequality in initial conditions
\item Substitutes for imperfect private insurance against idiosyncratic earnings risk
\end{itemize}
\item Reasons for less progressivity
\begin{itemize}
\item Reduces incentives to work
\item Reduces incentives to invest in skills
\end{itemize}
\item Develop general equilibrium model with these four trade-offs
\item Results for U.S. calibration:
\begin{itemize}
\item Baseline model indicates current system is too progressive
\item Adding that poverty constrains skill investment indicates the current system is close to optimal
\end{itemize}
\end{itemize}



\section{Tax Function}



\begin{itemize}
\item Tax revenue for pre-tax income $y$ is
\begin{align}
T(y) &= y - \lambda y^{1 - \tau} \label{tax_function}
\end{align}
\item After-tax income $\tilde y_i$ for pre-tax income $y_i$
\begin{align}
\tilde y_i 
&= y_i - T(y_i) \nonumber \\
&= y_i - y_i + \lambda y_i^{1 - \tau} \nonumber \\
&= \lambda y_i^{1-\tau} 
\end{align}
Thus, $1-\tau$ is elasticity of after-tax income to pre-tax income.
\item If $\tau > 0$ then marginal rates exceed average rates (progressive), if $\tau < 0$, marginal rates are smaller than average rates (regressive), and, if $\tau = 0$, marginal rates and average are the same $\implies$ flat tax.
\begin{align}
\frac{1 - T'(y_i)}{1 - \frac{T(y_i)}{y_i}} 
&= \frac{1 - (1 - \lambda (1-\tau)y^{- \tau}) }{1 - (1-\lambda y^{-\tau})} \nonumber \\
&=1 - \tau
\end{align}
\item With balanced budget $g Y = \int T(y_i)di$, so income-weighted marginal rate is
\begin{align}
\int T'(y_i) \Bigg( \frac{y_i}{Y} \Bigg) di 
&= \int (1 - (1-\tau)\lambda y_i^{-\tau}) \Bigg( \frac{y_i}{Y} \Bigg) di   \nonumber \\
&= \frac{1}{Y}\int y_i di - (1-\tau)\frac{1}{Y}\int \lambda y_i^{1-\tau} di   \nonumber \\
&= 1 - (1-\tau)\frac{1}{Y}\int y_i -T(y_i) di   \nonumber \\
&= 1 - (1-\tau)\frac{1}{Y}(Y - gY)   \nonumber \\
&= 1 - (1-\tau)(1-g)
\end{align}
\end{itemize}

\subsection{Empirical Fit}

\subsection{Robustness}

\subsection{Discussion}

\section{Economic Environment}



\begin{itemize}
\item Economy is steady state, so time subscripts omitted.
\end{itemize}



\subsection{Demographics}


\begin{itemize}
\item Agents indexed by $i = [0,1]$.
\item Yaari perpetual youth structure: 
\begin{itemize}
\item At every age $a$, an agent survives to next period with probability $\delta < 1$.
\item Each period newborn agents of size $1-\delta$ enter economy.
\end{itemize}
\end{itemize}


\subsection{Life Cycle}


\begin{itemize}
\item At beginning of live, agent $i$ chooses initial investment in skills $s_i$.
\item Agent $i$ then enters labor market and faces random  fluctuations in labor productivity $z_i$.
\item Every period, agent $i$ chooses hours of work $h_i \ge 0$ and consumption of private good $c_i$.
\end{itemize}



\subsection{Technology}



\begin{itemize}
\item $\theta > 1$ denotes elasticity of substitution across skill types
\item $N(s)$ denotes average effective hours worked by individuals with skill type $s$
\item $m(s)$ denotes the density of individuals with skill type $s$
\item Output $Y$ is constant elasticity of substitution aggregate of effective hours supplied by continuum of skill types $s \in [0,\infty)$:
\begin{align}
Y = \Bigg( \int_0^\infty [N(s) \cdot m(s)]^{\frac{\theta - 1}{\theta}} ds \Bigg)^{\frac{\theta}{\theta - 1}} \label{fg_production}
\end{align}
\item Marginal product from an additional unit of effective hours of skill type $s$ is
\begin{align*}
\frac{\partial Y}{\partial N(s)} &= \frac{\theta}{\theta - 1}\Bigg( \int_0^\infty [N(s) \cdot m(s)]^{\frac{\theta - 1}{\theta}} ds \Bigg)^{\frac{\theta}{\theta - 1} - 1}\\
&= \Bigg( \frac{Y}{N(s)\cdot m(s)} \Bigg)^{\frac{1}{\theta}}
\end{align*}
\item Resource constraint is
\begin{align}
Y &= \int_0^1 c_i di + G \label{rc}
\end{align}
\end{itemize}



\subsection{Preferences}



\begin{itemize}
\item $\beta$ is the ``pure" discount factor
\item Agent $i$ has preferences over private consumption, hours worked, public goods, and skill investment effort:
\begin{align}
U_i = - v_i(s_i) + (1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a u_i(c_{ia}, h_{ia}, G) \label{utility}
\end{align}
where expectations are taken over the future idiosyncratic productivity shocks.
\item $\psi \ge 0$ denotes the elasticity of skill investment wrt to the return to skill
\item $\kappa_i \ge 0$ is an individual-specific parameter that determine the utility cost of acquiring skills (larger $\kappa_i \implies$ the skills are cheaper, so $\kappa_i$ can be thought of as learning ability); $\kappa_i$ is assumed to be distributed exponential with parameter $\eta$: $\kappa_i \sim Exp(\eta)$
\item The disutility of the initial skill investment $s_i \ge 0$ is
\begin{align}
v_i(s_i) = \frac{\psi}{1 + \psi} \kappa_i^{-\frac{1}{\psi}} s_i^\frac{1 + \psi}{\psi} \label{disutility_skill}
\end{align}
\item Let $\exp[(1+\sigma) \varphi_i]$ be the disutility of work effort with $\varphi_i \sim N(\frac{v_\varphi}{2}, v_\varphi)$ and $\kappa_i$ and $\varphi_i$ are uncorrelated.
\item Let $\sigma > 0$ determine aversion to hours fluctuations
\item Let $\chi \ge 0$ measure the taste for public goods relative to private consumption goods
\item The period utility function
\begin{align}
u_i(c_{ia}, h_{ia}, G) = \log c_{ia} - \frac{\exp [(1+\sigma) \varphi_i] }{1 + \sigma} (h_{ia})^{1 + \sigma} + \chi \log G
\end{align}
\item Define the tax-modified Frisch elasticity $\hat \sigma$ as:
\begin{align}
\frac{1}{\hat \sigma} \equiv \frac{1 - \tau}{\sigma + \tau}
\end{align}
\end{itemize}



\subsection{Labor Productivity and Earnings}




\begin{itemize}
\item Log labor efficiency $z_{ia}$ is sum of a random walk and orthogonal white noise
\begin{align}
\log z_{ia} &= \alpha_{ia} + \varepsilon_{ia} \\
\text{where }
\alpha_{ia} &= \alpha_{i, a - 1} + \omega_{ia} \nonumber\\
\omega_{ia} &\sim^{iid} N(-\frac{v_w}{2}, v_w) \nonumber \\
\alpha_{i0} &= 0 \nonumber\\
\varepsilon_{ia} &\sim^{iid} N(-\frac{v_\varepsilon}{2}, v_\varepsilon) \nonumber
\end{align}
\item Individual earnings $y_{ia}$ is the product of the equilibrium price for labor from skill type $s_i$, individual labor productivity, and the number of hours worked.
\begin{align}
y_{ia} &= p(s_i) \times \exp( \alpha_{ia} + \varepsilon_{ia}) \times h_{ia}
\end{align}
\end{itemize}



\subsection{Financial Assets}



\begin{itemize}
\item Partial insurance structure with $\varepsilon$ shocks fully insurable but $\alpha$ shocks are not
\item Full set of state-contingent claims indexed by the $\varepsilon$ shocks.
\item Let $B(\Ebf)$ and $Q(\Ebf)$ denote the quantity and the price of insurance claims purchased that pay one unit of consumption iff $\varepsilon \in \Ebf \subset \R$.
\item Insurance claims in zero net supply and newborn agents start with zero initial holdings
\item Notice special cases of autarky with $v_\varepsilon = 0$ and full insurance with $v_\omega = 0$
\end{itemize}



\subsection{Markets}

\begin{itemize}
\item Competitive market for final consumption good, all types of labor services, and financial claims.
\item Final consumption good is numeraire
\end{itemize}



\subsection{Government}



\begin{itemize}
\item Government chooses $(g,\tau)$ where $g$ is government consumption as fraction of aggregate output and $\tau$ determines the degree of progressivity of the tax system.
\item Given $(g, \tau)$, the average level of taxation $\lambda$ balances its budget:
\begin{align}
G \equiv gY = g \int_0^1 y_i di = \int_0^1 (y_i - \lambda y_i^{1-\tau}) di \label{gbc}
\end{align}
\end{itemize}



\subsection{Agent's Problem}


\begin{itemize}
\item At $a = 0$, given $(\kappa_i, \varphi_i)$, agent chooses a skill level given. FOC of (\ref{utility}) wrt $s_i$
\begin{align*}
\frac{\partial v_i(s_i)}{\partial s_i} = (1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a \frac{\partial u_i(c_{ia}, h_{ia}, G)}{\partial s_i}
\end{align*}
In words, the marginal disutility of skill investment must equal the present discounted value of the higher associated expected lifetime wages. The derivative of (\ref{disutility_skill}) is
\begin{align*}
\frac{\partial v_i(s_i)}{\partial s_i} = \frac{\psi}{1 + \psi} \frac{1 + \psi}{\psi}\kappa_i^{-\frac{1}{\psi}} s_i^\frac{1}{\psi} = \Bigg(\frac{s_i}{\kappa_i}\Bigg)^{\frac{1}{\psi}}
\end{align*}
Combining
\begin{align}
\Bigg(\frac{s_i}{\kappa_i}\Bigg)^{\frac{1}{\psi}} = (1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a \frac{\partial u_i(c_{ia}, h_{ia}, G)}{\partial s_i} \label{optimal_skills}
\end{align}
\item At $a > 0$, timing is: 
\begin{enumerate}
\item $\omega_{ia}$ realized
\item Insurance market for $\varepsilon$ shocks opens and individual buys claims $B(\cdot)$
\item $\varepsilon_{ia}$ is realized
\item Chooses hours $h_{ia}$, receives $y_{ia}$, pays taxes, and chooses private consumption $c_{ia}$
\end{enumerate}
\item When insurance purchases are made (middle of period), budget constraint is
\begin{align}
\int_E Q(\varepsilon) B(\varepsilon) d\varepsilon = 0
\end{align}
\item When paying taxes and choosing consumption (end of period), budget constraint is
\begin{align}
c_{ia} 
&= y_{ia} - T(y_{ia})  + B(\varepsilon_{ia})\nonumber \\
&= y_{ia} - y_{ia} + \lambda y_{ia}^{1-\tau}  + B(\varepsilon_{ia})\nonumber \\
&= \lambda [p(s_i) \exp(\alpha_{ia} + \varepsilon_{ia}) h_{ia}]^{1-\tau} + B(\varepsilon_{ia})
\end{align}
\item Thus, given $s_i$, an agent solves
\begin{align*}
\max_{\{c_{ia}, h_{ia}\}_{a = 1, ..., \infty}} &
 E_0 \sum_{a = 0}^\infty (\beta \delta)^a u_i(c_{ia}, h_{ia}, G)\\
\text{s.t. }
0 &= \int_E Q(\varepsilon) B(\varepsilon) d\varepsilon \\
c_{ia} &= \lambda [p(s_i) \exp(\alpha_{ia} + \varepsilon_{ia}) h_{ia}]^{1-\tau} + B(\varepsilon_{ia})
\end{align*}
\end{itemize}



\subsection{A Special Case: The Representative Agent's Problem}




\begin{itemize}
\item Consider the representative agent case of this model.
\item The rep agent problem entails no cross-sectional dispersion in disutility of work effort ($v_\varphi = 0$), no idiosyncratic labor efficiency permanent shocks ($v_\omega = 0$), no idiosyncratic labor efficiency transitory shocks ($v_\varepsilon = 0$), and perfectly elastic production across skill types ($\theta = \infty$).
\item The relevant state variable for the general model is the skill investment and the current level of the productivity random walk, but the rep agent both are degenerate, thus the rep agent problem a static consumption/leisure choice where $(\lambda, g, \tau)$ are given:
\begin{align}
\max_{C, H} \log C &- \frac{H^{1 + \sigma}}{1 + \sigma} + \chi \log G\\
\text{s.t. } C &= \lambda H^{1-\tau} \nonumber \\
\implies \max_{H} \log (\lambda H^{1-\tau}) &- \frac{H^{1 + \sigma}}{1 + \sigma} + \chi \log G \nonumber
\end{align}
\item FOC wrt $H$
\begin{align}
\frac{(1-\tau)\lambda H^{-\tau}}{\lambda H^{1-\tau}} &= H^\sigma  \nonumber \\
\implies
(1-\tau) &= H^{\sigma+1} \nonumber \\
\implies \log H^{RA}(\tau) &= \frac{1}{1 + \sigma} \log ( 1 - \tau)
\end{align}
Taking logs of both sides of the budget constraint and substituting:
\begin{align}
\log C^{RA}(g, \tau, \lambda) 
&= \log \lambda + (1-\tau) \log H^{RA}(\tau) \nonumber \\
&= \log \lambda +  \frac{1-\tau}{1 + \sigma} \log ( 1 - \tau) \label{c_ra_lambda}
\end{align}
\item With degenerate skill distribution, aggregate output equals aggregate hours $Y=H$. The government budget constraint implies
\begin{align*}
G &= gY = gH = Y - \lambda Y^{1-\tau} = H - \lambda H^{1-\tau} \\
\implies
g &= 1 - \lambda H^{-\tau}\\
\implies
\lambda(g, \tau)  &= H^{\tau}(1 - g)
\end{align*}
Substituting into (\ref{c_ra_lambda}),
\begin{align*}
\log C^{RA}(g, \tau) 
&= 
\log C^{RA}(g, \tau, \lambda(g, \tau)) \\
&= \log (H^{\tau}(1 - g)) +  \frac{1-\tau}{1 + \sigma} \log ( 1 - \tau) \\
&=\tau \log (H) + \log (1 - g) +  \frac{1-\tau}{1 + \sigma} \log ( 1 - \tau) \\
&=\tau \frac{1}{1 + \sigma} \log (1 - \tau) + \log (1 - g) +  \frac{1-\tau}{1 + \sigma} \log ( 1 - \tau) \\
&= \log (1 - g) +  \frac{1}{1 + \sigma} \log ( 1 - \tau)
\end{align*}
\item More progressivity lowers rep agent labor supply:
\begin{align*}
\frac{\partial \log H^{RA}(\tau)}{\partial \tau} &= \frac{-1}{(1 + \sigma)(1 - \tau)} < 0
\end{align*}
\item More progressivity lowers rep agent consumption:
\begin{align*}
\frac{\partial \log C^{RA}(\tau)}{\partial \tau} &=  \frac{-1}{(1 + \sigma)( 1 - \tau)} < 0
\end{align*}
\item At high enough levels of progressivity, the rep agent stops working
\begin{align*}
\lim_{\tau \to 1} H^{RA} (\tau) 
&= \lim_{\tau \to 1} \max\{0, \frac{1}{1 + \sigma} \log ( 1 - \tau)\}\\
&= \max\{0, -\infty\}\\
&= 0
\end{align*}
\end{itemize}




\section{Equilibrium}



\begin{itemize}
\item Recursive formulation to define stationary competitive equilibrium
\item Individual state variables:
\begin{itemize}
\item $(\kappa, \varphi)$ for skill accumulation decision at $a = 0$
\item $(\varphi, \alpha, s)$ for beginning-of-period insurance claims purchasing decisions
\item $(\varphi, \alpha, \varepsilon, \bar B)$ for end-of-period consumption and labor supply decisions where $\bar B = B(\varepsilon; \varphi, \alpha, s)$
\end{itemize}
\item Given $(g, \tau)$, a \underline{stationary recursive competitive equilibrium} is a tax level $\lambda$; asset prices $Q(\cdot)$; skill prices $p(s)$; decision rules $s(\kappa, \varepsilon), c(\varphi, \alpha, \varepsilon, s), h(\varphi, \alpha, \varepsilon, s)$, and $B(\cdot; \varphi, \alpha, s)$; and aggregate quantities $N(s)$ such that:
\begin{enumerate}
\item HHs solve their problem and $s(\kappa, \varepsilon), c(\varphi, \alpha, \varepsilon, s), h(\varphi, \alpha, \varepsilon, s)$, and $B(\cdot; \varphi, \alpha, s)$ are the associated decision rules.
\item Labor markets for each skill type clear and $p(s)$ is the value of the marginal product from an additional unit of effective hours of skill type $s$:
$$
p(s) = \Bigg( \frac{Y}{N(s)\cdot m(s)} \Bigg)^{\frac{1}{\theta}}
$$
\item Asset markets clear, and the prices $Q(\cdot)$ of insurance claims are actuarially fair.
\item Government budget constraint holds (i.e., $\lambda$ satisfies ($\ref{gbc}$)).
\end{enumerate}
\end{itemize}



{
\proposition The equilibrium hours-worked allocation is
\begin{align}
\log h(\varphi, \varepsilon; \tau) = \log H^{RA}(\tau) - \varphi + \frac{1}{\hat{\sigma}} \varepsilon - \frac{1}{\hat \sigma (1- \tau)} \M (v_\varepsilon; \tau) \label{prop1_h}
\end{align}
where $\M ( v_\varepsilon; \tau) = \frac{(1-\tau)(1 - \tau(1+\hat \sigma))}{\hat \sigma} \frac{v_\varepsilon}{2}$. The consumption allocation is 
\begin{align}
\log c(\varphi, \alpha, s; g, \tau) = \log [C^{RA}(\tau)\vartheta(\tau)] + (1 - \tau) [\log p(s; \tau) + \alpha - \varphi] + \M (v_\varepsilon; \tau) \label{prop1_c}
\end{align}
where $\vartheta(\tau)$ is common across agents.
}



\bigskip



\textbf{Proof of Proposition 1:} 

\begin{itemize}
\item The roadmap of the proof is to (1) separate the economy into ``island" for each $(\varphi, s, \alpha)$, (2) solve the static ``island planner problem", and (3) verify that this allocation satisfies the conditions of the CE. The intuition behind this result is that, since the market is complete wrt to $\varepsilon$, so the CE allocation is efficient, so it can be computed as the solution to an island-specific planner problem. 
\item Since each island transfers zero net financial wealth between periods and preferences are time separable, each island-specific planner problem is static.
\item Island-specific resource constraint is island-aggregate consumption equals island-aggregate after-tax income:
\begin{align*}
\int_E c(\varepsilon) dF_\varepsilon 
&= \lambda \int_E [ p(s)\exp (\alpha + \varepsilon) h(\varepsilon)]^{1-\tau} dF_\varepsilon\\
&= \lambda \int_E \exp [(1-\tau)(\log p(s)+ \alpha + \varepsilon)] h(\varepsilon)^{1-\tau} dF_\varepsilon\\
&= \lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \int_E \exp [(1-\tau) \varepsilon] h(\varepsilon)^{1-\tau} dF_\varepsilon
\end{align*}
\item Taking $(\varphi, s, \alpha)$, $(G, \lambda, \tau)$, and $p(s)$ as given, the island planner problem is
\begin{align*}
\max_{\{c(\varepsilon), h(\varepsilon)\}} \int_E \Bigg\{ \log c(\varepsilon) &- \frac{\exp[(1+\sigma)\varphi]}{1 + \sigma} h(\varepsilon)^{1+\sigma} + \chi \log G \Bigg\} dF_\varepsilon\\
\text{s.t. } \int_E c(\varepsilon) dF_\varepsilon 
&= \lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \int_E \exp [(1-\tau) \varepsilon] h(\varepsilon)^{1-\tau} dF_\varepsilon
\end{align*}
\item Let $\gamma$ be the multiplier on the resource constraint. The lagrangian is
\begin{align*}
\Lfn = \int_E \Bigg\{ \log c(\varepsilon) &- \frac{\exp[(1+\sigma)\varphi]}{1 + \sigma} h(\varepsilon)^{1+\sigma} + \chi \log G \Bigg\} dF_\varepsilon \\
&+ \gamma \Bigg[\lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \int_E \exp [(1-\tau) \varepsilon] h(\varepsilon)^{1-\tau} dF_\varepsilon - \int_E c(\varepsilon) dF_\varepsilon \Bigg]
\end{align*}
\item FOC wrt $c(\varepsilon)$:
\begin{align*}
\frac{1}{c(\varepsilon)} = \gamma \implies c(\varepsilon) = c = \frac{1}{\gamma} \;\;\; \forall \varepsilon
\end{align*}
Thus, consumption is the same across agents on an island regardless of their realization of $\varepsilon \implies$ perfect consumption risk sharing
\item FOC wrt $h(\varepsilon)$:
\begin{align*}
\exp[(1+\sigma) \varphi] h(\varepsilon)^{\sigma} &= \gamma \lambda (1-\tau) \exp [(1-\tau)(\log p(s)+ \alpha)]  \exp [(1-\tau) \varepsilon] h(\varepsilon)^{-\tau} \\
\implies
h(\varepsilon)^{\sigma+\tau} &= \gamma \lambda (1-\tau) \exp [(1-\tau)(\log p(s)+ \alpha)-(1+\sigma) \varphi]  \exp [(1-\tau) \varepsilon] \\
\implies
h(\varepsilon) &= \gamma^{\frac{1}{\sigma+\tau}} [\lambda (1-\tau)]^{\frac{1}{\sigma+\tau}} \exp \Bigg[\frac{1-\tau}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{1+\sigma}{\sigma+\tau} \varphi \Bigg]  \exp  \Bigg[\frac{1-\tau}{\sigma+\tau} \varepsilon  \Bigg]
\end{align*}
\item Substituting both conditions into the resource constraint
The resource constraint can be expressed as
\begin{align*}
c
&= \lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \int_E \exp [(1-\tau) \varepsilon] h(\varepsilon)^{1-\tau} dF_\varepsilon \\
\implies
\gamma^{-1}
&= \lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \\
&\cdot \int_E \exp [(1-\tau) \varepsilon]  \gamma^{\frac{1 - \tau}{\sigma+\tau}} [\lambda (1-\tau)]^{\frac{1 - \tau}{\sigma+\tau}} \\&\exp \Bigg[\frac{(1-\tau)^2}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{(1+\sigma)(1-\tau)}{\sigma+\tau} \varphi \Bigg]  \exp  \Bigg[\frac{(1-\tau)^2}{\sigma+\tau} \varepsilon  \Bigg] dF_\varepsilon\\
\implies
\gamma^{\frac{-\sigma -1 }{\sigma+\tau}}
&= \lambda^{\frac{1+\sigma}{\sigma +\tau}}  (1-\tau)^{\frac{1 - \tau}{\sigma+\tau}} \exp [(1-\tau)( \log p(s)+ \alpha)]   \exp \Bigg[\frac{(1-\tau)^2}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{(1+\sigma)(1-\tau)}{\sigma+\tau} \varphi \Bigg]\\
&\cdot \int_E  \exp  \Bigg[\Bigg(\frac{(1-\tau)^2 + (1 -\tau)(\sigma+\tau)}{\sigma+\tau} \Bigg) \varepsilon  \Bigg] dF_\varepsilon\\
\gamma^{\frac{-\sigma -1 }{\sigma+\tau}}
&= \lambda^{\frac{1+\sigma}{\sigma +\tau}}  (1-\tau)^{\frac{1 - \tau}{\sigma+\tau}}  \exp \Bigg[\frac{(1-\tau)(1+\sigma)}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{(1+\sigma)(1-\tau)}{\sigma+\tau} \varphi \Bigg]\\
&\cdot \int_E  \exp  \Bigg[\Bigg(\frac{(1-\tau)(1+\sigma)}{\sigma+\tau} \Bigg) \varepsilon  \Bigg] dF_\varepsilon
\end{align*}
\item Focusing in on the last term, we can solve using MGF of normal distribution:\footnote{If $X \sim N(\mu, \sigma^2)$, then $E[\exp(aX)] = \exp(a\mu + \frac{a^2\sigma^2}{2})$ (Casella and Berger, \textit{Statistical Inference}).}
\begin{align*}
\int_E  \exp  \Bigg[\frac{(1-\tau)(1+\sigma)}{\sigma+\tau}  \varepsilon  \Bigg] dF_\varepsilon
&= \exp  \Bigg[ \frac{(1-\tau)(1+\sigma)}{\sigma+\tau}\frac{-v_\varepsilon}{2} +   \frac{1}{2}\frac{(1-\tau)^2(1+\sigma)^2}{(\sigma+\tau)^2} v_\varepsilon \Bigg]\\
&= \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)^2(1+\sigma)^2}{(\sigma+\tau)^2} - \frac{(1-\tau)(1+\sigma)}{\sigma+\tau}\Bigg) \Bigg]\\
&= \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)^2(1+\sigma)^2 - (1-\tau)(1+\sigma)(\sigma+\tau)}{(\sigma+\tau)^2}\Bigg) \Bigg]\\
&= \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1+\sigma)[(1-\tau)(1+\sigma) - (\sigma+\tau)]}{(\sigma+\tau)^2}\Bigg) \Bigg]\\
&= \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1+\sigma)(1-2\tau-\tau\sigma)}{(\sigma+\tau)^2}\Bigg) \Bigg]
\end{align*}
Plugging back into resource constraint:
\begin{align*}
\gamma^{\frac{-\sigma -1 }{\sigma+\tau}}
&= \lambda^{\frac{1+\sigma}{\sigma +\tau}}  (1-\tau)^{\frac{1 - \tau}{\sigma+\tau}}  \exp \Bigg[\frac{(1-\tau)(1+\sigma)}{\sigma +\tau}(\log p(s)+ \alpha - \varphi) \Bigg]\\
&\cdot \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1+\sigma)(1-2\tau-\tau\sigma)}{(\sigma+\tau)^2}\Bigg) \Bigg]\\
\implies
\gamma^{-1}
&= \lambda (1-\tau)^{\frac{1 - \tau}{1+\sigma}}  \exp \Bigg[(1-\tau)(\log p(s)+ \alpha -\varphi) \Bigg] \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1-2\tau-\tau\sigma)}{(\sigma+\tau)}\Bigg) \Bigg]\\
\log c &= \log \lambda + \frac{1-\tau}{1 +\sigma}\log(1-\tau) + (1-\tau)[\log p(s) + \alpha - \varphi] + \frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1-2\tau-\tau\sigma)}{(\sigma+\tau)}\Bigg)
\end{align*}
\item Defining the last term as $\M ( v_\varepsilon; \tau)$:
\begin{align*}
\M ( v_\varepsilon; \tau) 
&= \frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1-2\tau-\tau\sigma)}{(\sigma+\tau)}\Bigg)\\
&= \frac{v_\varepsilon}{2}\Bigg( \frac{1-2\tau-\tau\sigma}{\hat \sigma}\Bigg)\\
&= \frac{v_\varepsilon}{2}\Bigg( \frac{1-\tau-\tau(1+\sigma)}{\hat \sigma}\Bigg)\\
&= \frac{(1-\tau)(1 - \tau(1+\hat \sigma))}{\hat \sigma} \frac{v_\varepsilon}{2}
\end{align*}
\item Recall that $\log C^{RA} = \log (1 - g) +  \frac{1}{1 + \sigma} \log ( 1 - \tau)$, so we can rewrite consumption as
\begin{align*}
\log c = \log [C^{RA}\vartheta] + (1 - \tau) [\log p(s) + \alpha - \varphi] + \M (v_\varepsilon; \tau)
\end{align*}
where $\log \vartheta \equiv \log \lambda - \log(1-g) - \frac{\tau}{1+\sigma} \log(1-\tau)$. This equation matches (\ref{prop1_c}).
\item Turning back to the intratemporal FOC and taking logs and substituting in consumption:
\begin{align*}
\log h(\varepsilon) 
&= \frac{1}{\sigma+\tau}\log\gamma + \frac{1}{\sigma+\tau} \log \lambda + \frac{1}{\sigma+\tau} \log(1-\tau) + \frac{1-\tau}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{1+\sigma}{\sigma+\tau} \varphi   +  \frac{1-\tau}{\sigma+\tau} \varepsilon  \\
&= \frac{-1}{\sigma+\tau}\Bigg[ \log \lambda + \frac{1-\tau}{1 +\sigma}\log(1-\tau) + (1-\tau)[\log p(s) + \alpha - \varphi] + \M ( v_\varepsilon; \tau) \Bigg] \\
&+ \frac{1}{\sigma+\tau} \log \lambda + \frac{1}{\sigma+\tau} \log(1-\tau) + \frac{1-\tau}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{1+\sigma}{\sigma+\tau} \varphi   +  \frac{1-\tau}{\sigma+\tau} \varepsilon\\
&= \Bigg[\frac{-1}{\sigma + \tau} + \frac{1}{\sigma + \tau}  \Bigg] \log \lambda
+ \Bigg[\frac{-1(1-\tau)}{(\sigma + \tau)(1+\sigma)} + \frac{1}{\sigma + \tau}\Bigg] \log (1-\tau)
\\&+ \Bigg[\frac{-(1-\tau)}{(\sigma + \tau)} + \frac{(1-\tau)}{(\sigma+\tau)}\Bigg] [\log p(s) + \alpha]
+ \Bigg[\frac{-1(1-\tau)}{\sigma+\tau} -\frac{1+\sigma}{\sigma+\tau} \Bigg] \varphi
+ \frac{1-\tau}{\sigma+\tau} \varepsilon
- \frac{1}{\sigma+\tau} \M ( v_\varepsilon; \tau)\\
&=  \frac{1}{1+\sigma} \log (1-\tau) - \varphi
+ \frac{1-\tau}{\sigma+\tau} \varepsilon
- \frac{1}{\sigma+\tau} \M ( v_\varepsilon; \tau)
\end{align*}
\item Recall that $\log H^{RA}(\tau) = \frac{1}{1 + \sigma} \log ( 1 - \tau)$, so this equation can be rewritten to match (\ref{prop1_h}):
$$
\log h(\varepsilon) 
=  \log H^{RA}(\tau) - \varphi
+ \frac{1-\tau}{\sigma+\tau} \varepsilon
- \frac{1}{\sigma+\tau} \M ( v_\varepsilon; \tau)
$$
$\square$

\item With log utility and zero wealth, income and substitution effects on labor supply from different $\alpha$ and $s$ exactly offset, so hours are independent of $\alpha$ and $s$

\item Decompose hours into four terms:
\begin{align*}
\log h(\varphi, \varepsilon; \tau) 
= 
\underbrace{\log H^{RA}(\tau)}_{\text{rep agent hours}} 
- 
\underbrace{\varphi}_{\text{idiosyncratic disutiltiy of work}}
+
\underbrace{\frac{1}{\hat{\sigma}} \varepsilon }_{\text{insurable shock}}
- 
\underbrace{\frac{1}{\hat \sigma (1- \tau)} \M (v_\varepsilon; \tau)}_{\text{effect of insurable wage variation}}
\end{align*}
Notice that the insurable shock $\varepsilon$ has no income effect (because insurable) and is mediated by $\hat \sigma^{-1}$ which is lowered by more progressivity. The idea with the last term is that insurable wage variation means that agents are able to work more when they are productive and take more leisure when unproductive; this raises average productivity.

\item Decompose consumption into five terms:
\begin{align*}
\log c(\varphi, \alpha, s; g, \tau) 
&= 
\underbrace{\log [C^{RA}(\tau)\vartheta(\tau)]}_{\text{rep agent}} 
+
\underbrace{(1 - \tau) \log p(s; \tau)}_{\text{$c$ is inc. in skill/skill price}} 
+
\underbrace{(1 - \tau) \alpha }_{\text{$c$ is inc. in uninsurable productivity}}\\
&- 
\underbrace{(1 - \tau) \varphi }_{\text{$h$ is dec. in disutility of work, so $c$ is too}}
+ 
\underbrace{\M (v_\varepsilon; \tau)}_{\text{effect of insurable wage variation}}
\end{align*}
Notice that more progressivity (higher $\tau$) reduces passthrough of skills (skill prices), uninsurable labor productivity, and disutility of work

\end{itemize}

{
\proposition In equilibrium, skill prices are given by
\begin{align}
\log p(s; \tau) &= \pi_0(\tau) + \pi_1(\tau) \cdot s(\kappa; \tau) \text{, where} \label{prop2_s}\\
\pi_1(\tau) &= \Bigg( \frac{\eta}{\theta} \Bigg)^{\frac{1}{1+\psi}}(1-\tau)^{-\frac{\psi}{1+\psi}} \label{prop2_pi1}\\
\pi_0(\tau) &= \frac{1}{\theta-1} \Bigg\{ \frac{1}{1+\psi} \Bigg[\psi \log \Bigg( \frac{1-\tau}{\theta}\Bigg) - \log (\eta)\Bigg] + \log\Bigg(\frac{\theta}{\theta - 1}\Bigg) \Bigg\} \label{prop2_pi0}
\end{align} 
The skill investment allocation is given by
\begin{align}
s(\kappa;\tau) = [(1-\tau)\pi_1(\tau)]^{\psi} \cdot \kappa = \Bigg[ \frac{\eta}{\theta}(1-\tau) \Bigg]^{\frac{\psi}{1+\psi}}\cdot \kappa 
\label{prop2_s}
\end{align} 
and the equilibrium skill density $m(s)$ is exponential with parameter $\eta^{\frac{1}{1+\psi}} [\frac{\theta}{1-\tau}]^{\frac{\psi}{1+\psi}}$.
}

\pagebreak

\textbf{Proof of Proposition 2:} 
\begin{itemize}
\item Recall from (\ref{disutility_skill}) that the disutility of the initial skill investment is
\begin{align*}
v(s) = \frac{\psi}{1 + \psi} \kappa^{-\frac{1}{\psi}} s^\frac{1 + \psi}{\psi} 
\end{align*}
where $\kappa \sim \exp(\eta)$.
\item Recall from (\ref{optimal_skills}) that the optimality condition for skill investment is
\begin{align*}
\frac{\partial v(s)}{\partial s} =\Bigg(\frac{s}{\kappa}\Bigg)^{\frac{1}{\psi}} = (1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a \frac{\partial u(c(\varphi, \alpha, s;g, \tau), h(\varphi, \varepsilon; \tau), g)}{\partial s}
\end{align*}
\item Using the hours and consumption solutions from Proposition 1,
\begin{align*}
\frac{\partial }{\partial s}  u(c(\varphi, \alpha, s;g, \tau), h(\varphi, \varepsilon; \tau), g)
&= 
\frac{\partial }{\partial s}\Bigg[\log c(\varphi, \alpha, s;g, \tau) - \frac{\exp [(1+\sigma) \varphi_i] }{1 + \sigma} (h(\varphi, \varepsilon; \tau))^{1 + \sigma} + \chi \log G\Bigg] \\
&= 
\frac{\partial }{\partial s} \Bigg[\log [C^{RA}\vartheta] + (1 - \tau) [\log p(s; \tau) + \alpha - \varphi] + \M (v_\varepsilon; \tau)\Bigg]\\
&= (1-\tau) \frac{\partial \log p(s; \tau)}{\partial s}
\end{align*}
\item Plugging to the above optimality condition,
\begin{align*}
\Bigg(\frac{s}{\kappa}\Bigg)^{\frac{1}{\psi}} 
&= (1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a  \Bigg[ (1-\tau)\frac{\partial \log p(s; \tau)}{\partial s} \Bigg] \\
&= \Bigg[ (1-\tau)\frac{\partial \log p(s; \tau)}{\partial s} \Bigg](1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a   \\
&= \Bigg[ (1-\tau)\frac{\partial \log p(s; \tau)}{\partial s} \Bigg](1 - \beta \delta) (1 - \beta \delta)^{-1}   \\
&= (1-\tau)\frac{\partial \log p(s; \tau)}{\partial s}
\end{align*}
\item Guess that 
$$
\log p(s; \tau) = \pi_0(\tau) + \pi_1(\tau) \cdot s \implies \frac{\partial \log p(s; \tau)}{\partial s} = \pi_1(\tau)  
$$
for some $\pi_0(\tau)$ and $\pi_1(\tau)$
\item Thus, the guess implies that
\begin{align*}
\Bigg(\frac{s}{\kappa}\Bigg)^{\frac{1}{\psi}} &= (1-\tau)\pi_1(\tau) \implies s(\kappa;\tau) = [(1-\tau) \pi_1(\tau)]^{\psi} \cdot \kappa
\end{align*}
\item Since $\kappa \sim Exp(\eta) \implies s(\kappa; \tau) \sim Exp(\zeta)$ where $\zeta \equiv \eta [(1-\tau)\pi_1(\tau)]^{-\psi}$ with density $m(s) = \zeta \exp(-\zeta s)$.\footnote{In general, if $X \sim Exp(\lambda)$ then $aX \sim Exp(\frac{\lambda}{a})$ (Casella and Berger, \textit{Statistical Inference}).}
\item Turning to production side of economy, Proposition 1 implies that effective hours worked $N(s)$ are independent of skill type $s$, so $N(s) = N$ for all $s$, so aggregate output is
$$
Y = \Bigg( \int_0^\infty [N \cdot m(s)]^{\frac{\theta - 1}{\theta}} ds \Bigg)^{\frac{\theta}{\theta - 1}} 
$$
Equilibrium requires that $p(s)$ is the value of the marginal product of effective hours of skill type $s$:
\begin{align*}
p(s) 
&= \Bigg[\frac{Y}{N \cdot m(s)}\Bigg]^{\frac{1}{\theta}} \\
\implies \log p(s) 
&= \frac{1}{\theta} \log\Bigg(\frac{Y}{N}\Bigg) - \frac{1}{\theta}\log(m(s))\\
&= \frac{1}{\theta} \log\Bigg(\frac{Y}{N}\Bigg) - \frac{1}{\theta}\log[\zeta \exp(-\zeta s)]\\
&= \frac{1}{\theta} \log\Bigg(\frac{Y}{N\zeta}\Bigg) + \frac{\zeta}{\theta} s\\
\end{align*}
\item Matching coefficients, we can derive $\pi_1(\tau)$
\begin{align*}
\pi_1(\tau) 
&= \frac{\zeta}{\theta} \\
&= \frac{\eta}{\theta[(1-\tau)\pi_1(\tau)]^{\psi}} \\
\implies
[\pi_1(\tau)]^{1+\psi} 
&= \frac{\eta}{\theta(1-\tau)^{\psi}} \\
\implies
\pi_1(\tau) &= \Bigg(\frac{\eta}{\theta}\Bigg)^{\frac{1}{1+\psi}} (1-\tau)^{\frac{-\psi}{1+\psi}}
\end{align*}
Thus, we get (\ref{prop2_pi1})
\item Thus, $\zeta$ is
\begin{align*}
\zeta 
&= \eta [(1-\tau)\pi_1(\tau)]^{-\psi}\\
&= \eta (1-\tau)^{-\psi} \Bigg(\frac{\eta}{\theta}\Bigg)^{\frac{-\psi}{1+\psi}} (1-\tau)^{\frac{-\psi^2}{1+\psi}}\\
&= \eta^{\frac{1}{1+\psi}} \Bigg(\frac{\theta}{1- \tau}\Bigg)^{\frac{\psi}{1+\psi}}
\end{align*}
\item Plugging into $m(s)$, we get
\begin{align*}
m(s) 
&= \zeta \exp(-\zeta s)\\
&= \eta^{\frac{1}{1+\psi}} \Bigg(\frac{\theta}{1- \tau}\Bigg)^{\frac{\psi}{1+\psi}} \exp \Bigg(-\eta^{\frac{1}{1+\psi}} \Bigg(\frac{\theta}{1- \tau}\Bigg)^{\frac{\psi}{1+\psi}} s\Bigg)
\end{align*}
\item Furthermore, we get $s(\kappa; \tau)$
\begin{align*}
s(\kappa; \tau) 
&= [(1-\tau) \pi_1(\tau)]^{\psi} \cdot \kappa\\
&= \Bigg[(1-\tau) \Bigg(\frac{\eta}{\theta}\Bigg)^{\frac{1}{1+\psi}} (1-\tau)^{\frac{-\psi}{1+\psi}}\Bigg]^{\psi} \cdot \kappa\\
&= \Bigg[\frac{\eta}{\theta} (1-\tau)\Bigg]^{\frac{\psi}{1+\psi}} \cdot \kappa\\
\end{align*}
Thus, we get (\ref{prop2_s}).
\item Again matching coefficients, we get derive $\pi_0(\tau)$ in terms of aggregate output and effective hours:
\begin{align*}
\pi_0(\tau) 
&= \frac{1}{\theta} \log\Bigg(\frac{Y}{N\zeta}\Bigg)\\
&= \frac{1}{\theta} \log\Bigg(\frac{Y}{N}\Bigg) - \frac{1}{\theta(1+\psi)} \log\Bigg(\frac{\eta}{\theta}\Bigg) + \frac{\psi}{\theta(1+\psi)} \log(1-\tau)
\end{align*}
Using $Y = \frac{\theta}{\theta - 1} \exp(\pi_0(\tau)) N$ from Corollary 2 below, we get
\begin{align*}
\pi_0(\tau) 
&= \frac{1}{\theta} \log\Bigg(\frac{\frac{\theta}{\theta - 1} \exp(\pi_0(\tau)) N}{N}\Bigg) - \frac{1}{\theta(1+\psi)} \log\Bigg(\frac{\eta}{\theta}\Bigg) + \frac{\psi}{\theta(1+\psi)} \log(1-\tau) \\
&= \frac{1}{\theta} \pi_0(\tau) + \frac{1}{\theta}\log\Bigg(\frac{\theta}{\theta - 1} \Bigg) - \frac{1}{\theta(1+\psi)} \log\Bigg(\frac{\eta}{\theta}\Bigg) + \frac{\psi}{\theta(1+\psi)} \log(1-\tau)\\
\implies
\frac{\theta - 1}{\theta} \pi_0(\tau) 
&=\frac{1}{\theta}\log\Bigg(\frac{\theta}{\theta - 1} \Bigg) - \frac{1}{\theta(1+\psi)} \log\Bigg(\frac{\eta}{\theta}\Bigg) + \frac{\psi}{\theta(1+\psi)} \log(1-\tau)\\
\implies
\pi_0(\tau) 
&=\frac{1}{\theta-1}\log\Bigg(\frac{\theta}{\theta - 1} \Bigg) - \frac{1}{(\theta-1)(1+\psi)} \log\Bigg(\frac{\eta}{\theta}\Bigg) + \frac{\psi}{(\theta-1)(1+\psi)} \log(1-\tau)\\
&=\frac{1}{(\theta- 1)(1+\psi)}\Bigg[\psi \log\Bigg(\frac{1-\tau}{\theta} - \log (\eta) \Bigg)\Bigg] + \frac{1}{\theta - 1}\log\Bigg(\frac{\theta}{\theta-1}\Bigg)
\end{align*}
Thus, we get (\ref{prop2_pi0})
\end{itemize}
$\square$

\begin{itemize}
\item Notice ``Mincerian" form of log equilibrium skill price (i.e., affine function of $s$): 
\begin{align*}
\log p(s; \tau) &= \underbrace{\pi_0(\tau)}_{\text{base log-price of lowest skill level}} + \underbrace{\pi_1(\tau)}_{\text{pretax marginal return to skill}} \cdot s(\kappa; \tau)
\end{align*}
\item Notice from (\ref{prop2_s}) that higher progressivity reduces the after-tax returns to investing in skills $\implies$ depresses skill investment
\item Notice from (\ref{prop2_pi1}) that progressivity increases the equilibrium pretax marginal return to skill. Stiglitz effect: Higher $\tau$ means more compressed skill distribution toward zero, so high skills are more scarce $\implies$ imperfect substitutability in production drives up the pretax return to skills.
\end{itemize}

{
\corollary The distribution of log skill premia $\pi_1(\tau) \cdot s(\kappa;\tau)$ is exponential with parameter $\theta$. Thus, the variance of log skill prices is 
$$
var(\log p(s;\tau)) = \frac{1}{\theta^2}
$$
The distribution of skill prices $p(s; \tau)$ is levels is Pareto with scale (lower ound parameter $\exp(\pi_0(\tau))$ and Pareto parameter $\theta$.
}

\pagebreak

\textbf{Proof of Corollary 1:}

\begin{itemize}
\item The log of the skill premium for an agent with ability $\kappa$ is
\begin{align*}
\pi_1(\tau) \cdot s(\kappa; \tau) 
&= \pi_1(\tau)[(1-\tau)\pi_1(\tau)]^{\psi} \cdot \kappa\\
&= [\pi_1(\tau)]^{1+\psi}(1-\tau)^{\psi} \cdot \kappa\\
&= \Bigg(\frac{\eta}{\theta}\Bigg) (1-\tau)^{-\psi}(1-\tau)^{\psi} \cdot \kappa\\
&= \frac{\eta}{\theta} \cdot \kappa\\
\end{align*}
\item Therefore, since $\kappa \sim Exp(\eta) \implies \pi_1(\tau) \cdot s(\kappa; \tau)  \sim Exp(\theta)$
\item The variance of log skill prices is\footnote{If $X \sim Exp(\lambda)$, then $var(X) = \frac{1}{\lambda^2}$ (Casella and Berger, \textit{Statistical Inference}).}
$$
var(\log p(s;\tau)) = var(\pi_0(\tau) + \pi_1(\tau) \cdot s(\kappa;\tau)) = var(\pi_1(\tau) \cdot s(\kappa;\tau)) = \frac{1}{\theta^2}
$$
\item Since log skill premia are exponentially distributed, skill prices in levels are distributed Pareto with lower bound parameter (or scale) $\exp(\pi_0(\tau))$ and Pareto parameter (or shape) is $\theta$.\footnote{In general, if $X \sim Exp(\lambda)$, $k \exp(X) \sim Pareto(k, \lambda)$ (Casella and Berger, \textit{Statistical Inference}).}
\begin{align*}
\pi_1(\tau) \cdot s(\kappa;\tau) &\sim Exp(\theta) \\
\implies \exp(\pi_0(\tau)+ \pi_1(\tau) \cdot s(\kappa;\tau)) = \exp(\pi_0(\tau)) \exp(\pi_1(\tau) \cdot s(\kappa;\tau)) &\sim Pareto(\exp(\pi_0(\tau)), \theta)
\end{align*}
\end{itemize}
$\square$

\begin{itemize}
\item Notice that inequality in skill prices is independent of progressivity $\tau$. Why? Two forces perfectly offset: (1) Stiglitz effect and (2) higher progressivity compresses skill distribution.
\item Skill prices are Pareto and other stochastic components of wages are log normal, so wages and earnings have Pareto right tails, which is well supported empirically (e.g. Atkinson, Piketty, and Saez 2011). Consumption also has Pareto right tails (consistent with Toda 2015).
\end{itemize}

{
\corollary Average hours worked $H(\tau)$ and average effective hours $N(\tau)$ are independent of skill type $s$. $H(\tau)$, $N(\tau)$, and output $Y(\tau)$ are given by
\begin{align}
H(\tau) &= E[h(\varphi, \varepsilon; \tau)] = (1-\tau)^{\frac{1}{1+\sigma}} \cdot \exp\Bigg[\Bigg(\frac{\tau(1+\hat \sigma)}{\hat \sigma^2} - \frac{1}{\hat\sigma}\Bigg)\frac{v_\varepsilon}{2}\Bigg] \label{cor2_h}\\
N(\tau) &= E[\exp(\alpha + \varepsilon) h(\varphi, \varepsilon; \tau)] = H(\tau) \exp\Bigg(\frac{1}{\hat\sigma} v_\varepsilon\Bigg) \label{cor2_n}\\
Y(\tau) &= E[p(s; \tau) \exp(\alpha + \varepsilon) h(\varphi, \varepsilon; \tau)] = N(\tau) E[p(s; \tau) ]\label{cor2_y}
\end{align}
where $E[p(s; \tau)] = \exp(\pi_0(\tau)) \cdot \frac{\theta}{\theta - 1}$. Aggregate labor productivity is 
$\frac{Y(\tau)}{H(\tau)} = \frac{Y(\tau)}{N(\tau)} \cdot \frac{N(\tau)}{H(\tau)} = E[p(s; \tau) ]\exp(\frac{1}{\hat\sigma} v_\varepsilon)$
}

\pagebreak

\textbf{Proof of Corollary 2:}

\begin{itemize}
\item Aggregate hours is 
\begin{align*}
H(\tau) 
&= \int \int h(\varphi, \varepsilon; \tau) dF_\varphi dF_\varepsilon\\
&= \int \int \exp\Bigg[\frac{1}{1+\sigma}\log(1 - \tau) - \varphi + \frac{1}{\hat\sigma} \varepsilon - \frac{1}{\hat \sigma(1-\tau)} \Bigg( \frac{(1-\tau)(1-\tau(1+\hat\sigma))}{\hat \sigma}\frac{v_\varepsilon}{2} \Bigg)\Bigg] dF_\varphi dF_\varepsilon\\
&= \exp\Bigg[\frac{1}{1+\sigma}\log(1 - \tau) - \frac{1}{\hat \sigma(1-\tau)} \Bigg( \frac{(1-\tau)(1-\tau(1+\hat\sigma))}{\hat \sigma}\frac{v_\varepsilon}{2} \Bigg)\Bigg]
\int \exp[ - \varphi] dF_\varphi \int \exp\Bigg[ \frac{1}{\hat\sigma} \varepsilon \Bigg]dF_\varepsilon \\
&= (1 - \tau)^{ \frac{1}{1+\sigma}}  \exp\Bigg[- \frac{1}{\hat \sigma(1-\tau)} \Bigg( \frac{(1-\tau)(1-\tau(1+\hat\sigma))}{\hat \sigma}\frac{v_\varepsilon}{2} \Bigg)\Bigg]
\exp\Bigg[ - \frac{v_\varphi}{2} + \frac{v_\varphi}{2} \Bigg] \exp\Bigg[ -\frac{v_\varepsilon}{2\hat\sigma} +\frac{v_\varepsilon}{2\hat\sigma^2}  \Bigg]  \\
&= (1 - \tau)^{ \frac{1}{1+\sigma}} \exp\Bigg[ - \frac{1}{\hat \sigma(1-\tau)} \Bigg( \frac{(1-\tau)(1-\tau(1+\hat\sigma))}{\hat \sigma}\frac{v_\varepsilon}{2} \Bigg) -\frac{v_\varepsilon}{2\hat\sigma} +\frac{v_\varepsilon}{2\hat\sigma^2}  \Bigg]  \\
&= (1-\tau)^{\frac{1}{1+\sigma}} \exp\Bigg( \frac{\tau(1+\hat\sigma) - \hat \sigma}{\hat \sigma^2}\frac{v_\varepsilon}{2}\Bigg)
\end{align*}
Thus, we get (\ref{cor2_h}).
\item Aggregate effective hours is
\begin{align*}
N(\tau) 
&= \int \int \int \exp(\alpha + \varepsilon) h(\varphi, \varepsilon; \tau) dF_\varphi dF_\alpha dF_\varepsilon\\
&=\int \int \int \exp\Bigg[\alpha + \varepsilon +\frac{1}{1+\sigma}\log(1 - \tau) - \varphi + \frac{1}{\hat\sigma} \varepsilon - \frac{1}{\hat \sigma(1-\tau)} \Bigg( \frac{(1-\tau)(1-\tau(1+\hat\sigma))}{\hat \sigma}\frac{v_\varepsilon}{2} \Bigg)\Bigg] dF_\varphi dF_\alpha dF_\varepsilon\\
&= \exp\Bigg[\frac{1}{1+\sigma}\log(1 - \tau) - \frac{1}{\hat \sigma(1-\tau)} \Bigg( \frac{(1-\tau)(1-\tau(1+\hat\sigma))}{\hat \sigma}\frac{v_\varepsilon}{2} \Bigg)\Bigg] \int \exp(\alpha) dF_\alpha \int \exp(-\varphi) dF_\varphi \\ &\cdot \int \exp\Bigg[ \frac{\hat \sigma + 1}{\hat\sigma} \varepsilon \Bigg] dF_\varepsilon\\
&= (1 - \tau)^{\frac{1}{1+\sigma}}\exp \Bigg[- \frac{1}{\hat \sigma(1-\tau)} \Bigg( \frac{(1-\tau)(1-\tau(1+\hat\sigma))}{\hat \sigma}\frac{v_\varepsilon}{2} \Bigg)\Bigg]   \exp\Bigg[ \frac{\hat \sigma + 1}{\hat\sigma} \frac{-v_\varepsilon}{2} + \frac{(\hat \sigma + 1)^2}{\hat\sigma^2}\frac{v_\varepsilon}{2} \Bigg]\\
&= (1-\tau)^{\frac{1}{1+\sigma}} \exp\Bigg(\frac{\tau(1 + \hat \sigma) + \hat \sigma}{\hat \sigma^2}\frac{v_\varepsilon}{2}\Bigg)\\
&= H(\tau) \exp\Bigg(\frac{1}{\hat\sigma} v_\varepsilon\Bigg)
\end{align*}
Thus, we get (\ref{cor2_n}). 
\item Aggregate output is equal to aggregate labor earnings:\footnote{If $X \sim Pareto(x_m, \alpha)$, then $E[X] =\frac{\alpha}{\alpha-1} x_m$ (Casella and Berger, \textit{Statistical Inference})}
\begin{align*}
Y(\tau) 
&= \int \int \int \int p(s, \tau)\exp(\alpha + \varepsilon)h(\varphi, \varepsilon; \tau) dF_s dF_\varphi dF_\alpha dF_\varepsilon\\
&= \int p(s, \tau) dF_s\int \int \int \exp(\alpha + \varepsilon)h(\varphi, \varepsilon; \tau)  dF_\varphi dF_\alpha dF_\varepsilon\\
&= \int p(s, \tau) dF_s N(\tau)\\
&= \frac{\theta}{\theta-1} \exp(\pi_0(\tau)) \cdot N(\tau)
\end{align*}
Thus, we get (\ref{cor2_y}). 
\end{itemize}
$\square$

\subsection{Efficiency}

\begin{itemize}
\item $\tau = 0$ (i.e., flat taxes or no progressivity) is generally not efficient for two reasons: (1) there are no private markets to insure $\alpha$ shocks and (2) there's a free-riding problem, in the sense, higher labor supply means more tax revenue and higher $g$, but private agents take $g$ as exogenous, so labor supply is too low.
\item Proposition 3 proves that without $\alpha$ shocks (i.e., $v_\omega = 0$) and without free-riding problem (i.e., $\chi = 0$), then $\tau = 0$ is efficient. The associated Pareto weights put more weight on agents with higher learning ability $\kappa$ and lower disutility of work effort $\varphi$.
\end{itemize}

\pagebreak

\section{Welfare Effects of Tax Reform}

\begin{itemize}
\item Here, we compare steady state equilibria (one associated with $(g_{-1}, \tau_{-1})$ and one associated with $(g, \tau)$) and assuming away transitional dynamics (or, ``skill investment is reversible"). The paper considers polar opposite of this with ``irreversible skill investment" in section 6.3.
\end{itemize}

\subsection{Social Welfare Function}

\begin{itemize}
\item Baseline is utilitarian social paper who cares equally about the utility of all agents
\item Assume that planner discounts the lifetime utility of future generations at rate $\gamma$
\item Social welfare evaluated as of date 0 is
\begin{align}
\mathcal{W}(g, \tau; \tau_{-1}) \equiv (1-\gamma) \Gamma \sum_{j = -\infty}^\infty \gamma^y U_{j,0} (g, \tau; \tau_{-1}) \label{swf}
\end{align}
where $U_{j,0} (g, \tau; \tau_{-1})$ is remaining expected lifetime utility as of date 0 for the cohort that entered the economy at date $j$ (discounted back to date of birth) and $\Gamma \equiv \frac{\gamma - \beta \sigma}{\gamma(1-\beta\delta)}$ provides convenient normalization.
\end{itemize}

\begin{customthm}{4}\label{prop4}
In the model with fully reversible investment, when the social welfare function is given by (\ref{swf}), welfare from implementing policy $(g, \tau)$ is
\begin{align}
\mathcal{W}(g, \tau; \tau_{-1}) =
\begin{cases}
\log(1-g) + \chi \log g + (1+\chi) \frac{\log(1-\tau)}{(1+\hat\sigma)(1-\tau)}- \frac{1}{1+\hat\sigma} 
& (a)\\
+(1+\chi)\frac{1}{(1+\psi)(\theta-1)} [ \phi \log(1-\tau) + \log ( \frac{1}{\eta\theta^\psi} ( \frac{\theta}{\theta - 1} )^{\theta(1+\psi)} ) ]
& (b)\\
-\frac{\psi}{(1+\psi)\theta} [ (1-\tau) - \frac{\beta\delta}{\gamma} \frac{(1-\gamma)}{(1-\beta\delta)}(1-\tau_{-1}) ]
& (c)\\
-[ - \log(1-(\frac{1-\tau}{\theta})) - (\frac{1-\tau}{\theta}) ]
& (d)\\
-(1-\tau)^2\frac{v_\varphi}{2}
& (e)\\
-[(1-\tau)(\frac{\beta\delta}{\gamma - \beta\delta})\frac{v_{\omega}}{2} - \log(\frac{1-\delta \exp(\frac{-\tau(1-\tau)}{2}v_\omega)}{1-\delta})]
& (f)\\
+ (1 + \chi) [\frac{1}{\hat\sigma} v_\varepsilon - \sigma \frac{1}{\hat \sigma^2}\frac{v_\varepsilon}{2}]
& (g)
\end{cases}
\label{cf_swf}
\end{align}
\end{customthm}

\bigskip

\textbf{Proof of Proposition 4:}

\begin{itemize}
\item Two steps: (1) derive a closed-form solution for the residual fiscal instrument $\lambda$ and (2) substitute allocations into social welfare function to derive (\ref{cf_swf})
\item \textbf{Step 1}
\item Starting from government budget constraint (\ref{gbc}),
\begin{align*}
gY &= \int_0^1 (y_i - \lambda y_i^{1-\tau}) di\\
&= \int_0^1 y_i di - \lambda \int_0^1y_i^{1-\tau} di\\
&= Y - \lambda \tilde Y\\
\implies
\lambda &= \frac{(1-g) Y}{\tilde Y}
\end{align*}
where $\tilde Y \equiv \int_0^1 y_i^{1-\tau}di$
\item To compute $\tilde Y$, it is useful to aggregate by age group. Let $\tilde Y^a$ be average per capita disposable income for agents in age group $a$:
\begin{align*}
\tilde Y^a
&= \int \int \int \int [y(s, \varphi, \varepsilon, \alpha)]^{1-\tau} m(s) ds dF_\alpha^a dF_\varphi dF_\varepsilon\\
&= \int \int \int \int [ \exp(\log h(\varepsilon)+ \log p(s) + \alpha_a + \varepsilon)]^{1-\tau} m(s) ds dF_\alpha^a dF_\varphi dF_\varepsilon\\
&= \int \int \int \int \Bigg[ \exp\Bigg(\Big(\frac{1}{1 + \sigma} \log ( 1 - \tau) - \varphi + \frac{1}{\hat{\sigma}} \varepsilon - \frac{1}{\hat \sigma (1- \tau)} \M \Big)+  \pi_0(\tau) + \pi_1(\tau)  s + \alpha_a + \varepsilon\Bigg)\Bigg]^{1-\tau} \\ 
&\cdot\zeta \exp (-\zeta s ) ds dF_\alpha^a dF_\varphi dF_\varepsilon\\
&= (1-\tau)^{\frac{1-\tau}{1+\sigma}} \exp\Big(-\frac{1}{\hat\sigma} \M\Big)\exp((1-\tau)\pi_0(\tau))
\int \exp(-\varphi(1-\tau)) dF_\varphi  \\
& \cdot\int \exp\Big(\frac{(1+\hat\sigma)(1-\tau)}{\hat \sigma} \varepsilon\Big) dF_\varepsilon  \int \exp((1-\tau)\alpha_a) dF_\alpha^a \int \exp[  \pi_1(\tau)  (1-\tau)s ] m(s)ds  \\
&= (1-\tau)^{\frac{1-\tau}{1+\sigma}} \exp\Big(-\frac{1}{\hat\sigma} \M\Big)\exp((1-\tau)\pi_0(\tau))
\exp\Big(-\tau(1-\tau)\frac{v_\varphi}{2}\Big) \\
& \cdot \exp\Big( \Big( \frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma}\Big(\frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma} - 1 \Big)\Big) \frac{v_\varepsilon}{2} \Big)  \exp\Big( -\tau(1-\tau) \frac{v_{\alpha}^a}{2} \Big) \cdot \frac{\theta}{\theta - 1 + \tau} 
\end{align*}
because
\begin{align*}
\int \exp[  \pi_1(\tau)  (1-\tau)s ] m(s)ds 
&= \int \exp[  \pi_1(\tau)  (1-\tau)s ] \zeta \exp(-\zeta s) ds \\
&= \int \zeta \exp[(\pi_1(\tau)  (1-\tau)-\zeta) s] ds \\
&= \int \zeta \exp\Bigg[\Bigg(\Bigg( \frac{\eta}{\theta} \Bigg)^{\frac{1}{1+\psi}}(1-\tau)^{-\frac{\psi}{1+\psi}}  (1-\tau)-\Big[(1-\tau)\Bigg( \frac{\eta}{\theta} \Bigg)^{\frac{1}{1+\psi}}(1-\tau)^{-\frac{\psi}{1+\psi}}\Big]^{-\psi}\Bigg) s\Bigg] ds \\
&= \int \zeta \exp\Bigg[\Bigg(\Bigg( \frac{\eta}{\theta} \Bigg)^{\frac{1}{1+\psi}}(1-\tau)^{\frac{1}{1+\psi}}  -\Bigg( \frac{\eta}{\theta} \Bigg)^{\frac{-\psi}{1+\psi}}(1-\tau)^{\frac{ - \psi}{1+\psi}}\Bigg) s\Bigg] ds \\
&= \int \zeta \exp\Bigg[- \frac{\theta - 1 + \tau}{\theta}\eta[(1-\tau)\pi_1(\tau)]^{-\psi} s\Bigg] ds \\
&= \int \zeta \exp\Bigg[- \frac{\theta - 1 + \tau}{\theta}\zeta s\Bigg] ds \\
&= \frac{\theta}{\theta - 1 + \tau} \int \frac{\theta - 1 + \tau}{\theta}\zeta \exp\Bigg[- \frac{\theta - 1 + \tau}{\theta}\zeta s\Bigg] ds \\
&= \frac{\theta}{\theta - 1 + \tau} \cdot 1
\end{align*}
\item Note that $v_\alpha^a = Var(\alpha_a) = Var(\alpha_0 + \omega_{1} + ... +\omega_{a}) = v_\alpha^0 + a v_\omega$. (I thought everyone started at $\alpha_0 = 0$, so $v_\alpha^0 = 0$, but they keep it around in the proof, so I'll keep it too.)
\item Define $\mathcal{K}$ such that
\begin{align*}
\tilde Y^a &= \mathcal{K} \cdot \exp \Big(-\tau(1-\tau)\frac{v_\alpha^a}{2}\Big)\\
\mathcal{K}  &\equiv  (1-\tau)^{\frac{1-\tau}{1+\sigma}} \exp\Big(-\frac{1}{\hat\sigma} \M\Big)\exp((1-\tau)\pi_0(\tau))
\exp\Big(-\tau(1-\tau)\frac{v_\varphi}{2}\Big) \\
& \cdot \exp\Big( \Big( \frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma}\Big(\frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma} - 1 \Big)\Big) \frac{v_\varepsilon}{2} \Big)  \frac{\theta}{\theta - 1 + \tau}\\
\implies
\log \mathcal{K} &=  \frac{1-\tau}{1+\sigma} \log(1-\tau) -\frac{1}{\hat\sigma} \M + (1-\tau)\pi_0(\tau) -\tau(1-\tau)\frac{v_\varphi}{2} \\
& + \Big( \frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma}\Big(\frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma} - 1 \Big)\Big) \frac{v_\varepsilon}{2} + \log\Bigg(  \frac{\theta}{\theta - 1 + \tau}\Bigg)
\end{align*}
\item Now sum across age groups
\begin{align*}
\tilde Y 
&= (1-\delta) \sum_{a = 0}^\infty \delta^a \tilde Y^a\\
&= (1-\delta) \sum_{a = 0}^\infty \delta^a \cdot \mathcal{K} \cdot \exp \Big(-\tau(1-\tau)\frac{v_\alpha^a}{2}\Big)\\
&= \mathcal{K} \cdot (1-\delta) \sum_{a = 0}^\infty \delta^a \cdot \exp \Big(-\tau(1-\tau)\frac{v_\alpha^0 +  av_\omega}{2}\Big)\\
&= \mathcal{K} \cdot (1-\delta) \exp \Big(-\tau(1-\tau)\frac{v_\alpha^0}{2}\Big) \sum_{a = 0}^\infty \cdot \exp \Big(a \Big[\log(\delta)-\tau(1-\tau)\frac{v_\omega}{2} \Big] \Big)\\
&= \mathcal{K} \cdot (1-\delta) \exp \Big(-\tau(1-\tau)\frac{v_\alpha^0}{2}\Big) \frac{1}{1-\exp \Big(\Big[\log(\delta)-\tau(1-\tau)\frac{v_\omega}{2} \Big] \Big)}\\
&= \mathcal{K} \cdot  \frac{(1-\delta) \exp \Big(-\tau(1-\tau)\frac{v_\alpha^0}{2}\Big)}{1-\delta\exp \Big(-\tau(1-\tau)\frac{v_\omega}{2} \Big)}\\
\implies
\log \tilde Y
&= \log \mathcal{K} + \log(1-\delta) - \tau(1-\tau)\frac{v_\alpha^0}{2} - \log\Big[ 1 - \delta \exp\Big( \frac{-\tau(1-\tau)}{2}v_\omega \Big) \Big]\\
&= \frac{1-\tau}{1+\sigma} \log(1-\tau) -\frac{1}{\hat\sigma} \M + (1-\tau)\pi_0(\tau) -\tau(1-\tau)\frac{v_\varphi}{2} \\
& + \Big( \frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma}\Big(\frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma} - 1 \Big)\Big) \frac{v_\varepsilon}{2} + \log\Bigg(  \frac{\theta}{\theta - 1 + \tau}\Bigg) \\&+ \log(1-\delta) - \tau(1-\tau)\frac{v_\alpha^0}{2} - \log\Big[ 1 - \delta \exp\Big( \frac{-\tau(1-\tau)}{2}v_\omega \Big) \Big]
\end{align*}
\item Recall that $Y$ from Corollary 2:
\begin{align*}
Y &= (1-\tau)^{\frac{1}{1+\sigma}} \exp\Bigg( \frac{\tau(1+\hat\sigma) - \hat \sigma}{\hat \sigma^2}\frac{v_\varepsilon}{2}\Bigg)\cdot \exp\Bigg(\frac{1}{\hat\sigma} v_\varepsilon\Bigg)\cdot \Bigg(\frac{\theta}{\theta-1}\Bigg)^{\frac{\theta}{\theta-1}} \eta^{\frac{-1}{(\theta-1)(1+\psi)}} \Bigg( \frac{1-\tau}{\theta}\Bigg)^{\frac{\psi}{(\theta-1)(1+\psi}} \\ 
\implies
\log Y &=\frac{1}{1+\sigma} \log (1-\tau) + \frac{\tau(1+\hat\sigma) - \hat \sigma}{\hat \sigma^2}\frac{v_\varepsilon}{2} + \frac{1}{\hat\sigma} v_\varepsilon + \frac{\theta}{\theta-1}\log\Big( \frac{\theta}{\theta-1} \Big) + \frac{-1}{(\theta-1)(1+\psi)} \log \eta\\ &+ \frac{\psi}{(\theta-1)(1+\psi} \log \Big( \frac{1-\tau}{\theta} \Big)
\end{align*}
\item Substituting into the modified GBC:
\begin{align*}
\log \lambda 
&= \log (1-g) + \log Y - \log \tilde Y\\
&= \log (1-g) + \frac{1}{1+\sigma} \log (1-\tau) + \frac{\tau(1+\hat\sigma) - \hat \sigma}{\hat \sigma^2}\frac{v_\varepsilon}{2} + \frac{1}{\hat\sigma} v_\varepsilon + \frac{\theta}{\theta-1}\log\Big( \frac{\theta}{\theta-1} \Big) + \frac{-1}{(\theta-1)(1+\psi)} \log \eta\\ &+ \frac{\psi}{(\theta-1)(1+\psi} \log \Big( \frac{1-\tau}{\theta} \Big) - \frac{1-\tau}{1+\sigma} \log(1-\tau) + \frac{1}{\hat\sigma} \M - (1-\tau)\pi_0(\tau) + \tau(1-\tau)\frac{v_\varphi}{2} \\
& - \Big( \frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma}\Big(\frac{(1-\tau)(1+\hat\sigma)}{\hat \sigma} - 1 \Big)\Big) \frac{v_\varepsilon}{2} - \log\Bigg(  \frac{\theta}{\theta - 1 + \tau}\Bigg) \\
&- \log(1-\delta) + \tau(1-\tau)\frac{v_\alpha^0}{2} + \log\Big[ 1 - \delta \exp\Big( \frac{-\tau(1-\tau)}{2}v_\omega \Big) \Big]\\
&= \log (1-g) + \frac{\tau(1-\tau)}{\sigma + \tau} \Big( \frac{1+\sigma}{\sigma + \tau} + 2 + \sigma \Big)\frac{v_\varepsilon}{2} + \frac{\tau}{1+\sigma} \log(1-\tau) + \tau(1-\tau)\frac{v_\varphi}{2} - \log(1-\delta) + \tau(1-\tau)\frac{v_\alpha^0}{2} \\
&+ \log \Big[ 1 - \delta \exp\Big( \frac{-\tau(1-\tau)}{2}v_\omega \Big) \Big] + \frac{\psi}{1+\psi}\frac{\tau}{\theta-1}\log \Big( \frac{1-\tau}{\theta}\Big) - \frac{1}{1+\psi}\frac{\tau}{\theta-1} \log \eta + \frac{\theta + \tau - 1}{\theta - 1} \log \Big( \frac{\theta}{\theta - 1} \Big) \\
&+ \log \Big( \frac{\theta - 1 + \tau}{\theta} \Big)
\end{align*}
Thus, we have an expression for $\lambda$.
\pagebreak
\item \textbf{Step 2}
\item Period utility at age $a \ge 0$ is
\begin{align*}
u(c_a, h, G) 
&= 
\log c_a - \frac{\exp[(1+\sigma)\varphi]}{1+\sigma} h^{1+\sigma} + \chi \log G\\
&= \Bigg[ \log \lambda + \frac{1-\tau}{1+\sigma} \log (1-\tau) + (1-\tau)[\log p(s) + \alpha_a - \varphi] + \M \Bigg]\\
&+\frac{\exp[(1+\sigma)\varphi]}{1+\sigma} \exp\Big( (1+\sigma) \log h \Big) + \chi \log G\\
&=  \log \lambda + \frac{1-\tau}{1+\sigma} \log (1-\tau) + (1-\tau)[\pi_0(\pi) + \pi_1(\tau)s] + (1-\tau)(\alpha - \varphi) + \M \\
&+\frac{\exp[(1+\sigma)\varphi]}{1+\sigma} \exp\Big(  \log (1-\tau) - (1+\sigma)\varphi
+ \frac{(1-\tau)(1+\sigma)}{\sigma+\tau} \varepsilon
- \frac{(1+\sigma)}{(\sigma+\tau)} \M \Big) + \chi \log G\\
&=  \log \lambda + \frac{1-\tau}{1+\sigma} \log (1-\tau) + (1-\tau)\Bigg[ \frac{1}{(\theta- 1)(1+\psi)}\Bigg[\psi \log\Bigg(\frac{1-\tau}{\theta} - \log (\eta) \Bigg)\Bigg] + \frac{1}{\theta - 1}\log\Bigg(\frac{\theta}{\theta-1}\Bigg)\Bigg] \\&+ (1-\tau)\frac{\eta}{\theta}\kappa + (1-\tau)(\alpha_a - \varphi) + \M \\
&+\frac{1-\tau}{1+\sigma} \exp\Big( \frac{(1-\tau)(1+\sigma)}{\sigma+\tau} \varepsilon
- \frac{(1+\sigma)}{(\sigma+\tau)} \M \Big) + \chi \log G\\
&=  \log \lambda + \frac{1-\tau}{1+\sigma} \log (1-\tau)   - (1-\tau)\varphi + \frac{1-\tau}{(\theta- 1)(1+\psi)} \Bigg[\psi \log(1-\tau) + \log\Bigg(\frac{\theta}{\eta (\theta - 1)^{1+\psi}}\Bigg)\Bigg] + \M\\
&- \frac{1-\tau}{1+\sigma}\exp\Bigg(-\frac{1+\sigma}{\hat \sigma(1-\tau)} \M \Bigg) \exp\Bigg(\frac{1+\sigma}{\hat\sigma} \varepsilon \Bigg) + (1-\tau) \kappa \frac{\eta}{\theta}+ \chi \log G + (1-\tau)\alpha_a
\end{align*}
\item Denote average utility at age $a$ with $\bar u_a$:
\begin{align*}
\bar u_a = \int \int \int \int u(c_a, g, G) dF_\kappa dF_\varepsilon dF_\varphi dF_\alpha^a
\end{align*}
\item Disutility from skill investment
\begin{align*}
v(s(\kappa)) 
&= \frac{-\kappa^{-1/\psi}}{1+\frac{1}{\psi}} s(\kappa,\tau)^{1+1/\psi}\\
&= \frac{-\kappa^{-1/\psi}}{1+\frac{1}{\psi}}\Bigg[\Big( \frac{\eta}{\theta}(1-\tau)\Big)^{\frac{\psi}{1 + \psi}}\kappa \Bigg]^{1+1/\psi}\\
&= -(1-\tau)\kappa\frac{\eta}{(1+\frac{1}{\psi})\theta}
\end{align*}
\end{itemize}


$\square$

{
\corollary Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

\subsection{Decomposition of the Social Welfare Function}

\subsubsection{Welfare of the Representative Agent}

\begin{customthm}{5}\label{prop5}
Hello
\end{customthm}

\subsubsection{Welfare from Skill Investment}

\subsubsection{Welfare from Preference Heterogeneity and Uninsurable Wage Risk}

\subsubsection{Welfare from Insurable Wage Risk}

\subsection{When Should Taxes Be Progressive?}

\begin{customthm}{6}\label{prop6}
Hello
\end{customthm}

\subsection{Optimal Marginal Tax Rate at the Top}

\section{Quantitative Analysis}

\subsection{Parameterization}

\subsection{Results}

\subsection{Progressivity When Past Skill Investment is Fixed}

\subsection{Modeling Public Consumption}

\subsection{Inequality Aversion}

\subsection{Political-Economic Determination of Progressivity}

\section{Skill Investment Constraints}

\section{Empirical Evidence}

\section{Conclusions}

\pagebreak

\section*{Appendix: Lecture Notes on HSV (2014) and BK (2021)}

Job presented a simplified version of HSV (2014) and BK (2021), which are closely related papers. I have included these lecture notes because I found them helpful in understanding the more complicated HSV (2017). 

\bigskip

\textbf{Question:} We have data on consumption, hours, and wages $\{c_i, h_i, w_i\}_i$. Can we perfectly rationalize these data?

\subsection*{Environment}

\begin{enumerate}

\item Demography

\begin{itemize}
\item HHs
\item Time: $t=0,1,...$
\item Perpetual youth: $P(death) = 1 - \delta$ and $P(survival) = \delta$
\item Every time $t$, mass $1-\delta$ is born
\item Age $a = 0, 1,...$
\item Cohort $j \in (-\infty, \infty)$
\end{itemize}

\item Preferences

\begin{align*}
E_j \sum_{t=j}^\infty (\beta \delta)^{t-j} u^j(c_t^j, h_t^j) 
&= 
E_j \sum_{t=j}^\infty (\beta \delta)^{t-j} \Bigg[\frac{(c_t^j)^{1-\gamma}-1}{1-\gamma} - \frac{[\exp(B^j) h_t^j]^{1+\frac{1}{\eta}}}{1+\frac{1}{\eta}} \Bigg]
\end{align*}
\begin{itemize}
\item $\eta$ is the Frisch elasticity of labor supply
\item Here, we generally focus on $\gamma \to 1 \implies \log$ preferences over consumption
\end{itemize}
\begin{align*}
u^j(c_t^j, h_t^j) 
&= 
\log c_t^j - \frac{[\exp(B^j) h_t^j]^{1+\frac{1}{\eta}}}{1+\frac{1}{\eta}}
\end{align*}

\item Technology

\begin{itemize}
\item Production
\item $y = zh$ where $y$ is earnings, $z$ is wage rate per hour, and $h$ is hours
\item $z = \exp(\alpha + \varepsilon)$ where $\alpha^j$ is permanent, $\varepsilon_t^j = \nu_t^\varepsilon$ varies in every time period and across agent (idiosyncratic and iid across time and agents)
\item Distributions are $\nu_t^\varepsilon \sim \Phi_t^\varepsilon$, $\alpha^j \sim \Phi_j^\alpha$, $B^j \sim \Phi_j^B$ 
\end{itemize}

\item Information structure

\begin{itemize}
\item Perfect foresight: $\{ \Phi_t^\varepsilon, \Phi_j^\alpha, \Phi_j^B \}$ are known
\end{itemize}


\item Equilibrium

\begin{itemize}
\item A HH denoted by $i = \{j, B^j, \alpha^j, \{ \nu_t^j \}\}$
\item Define island $\ell$ as the collection of households with identical $\{j, B^j, \alpha^j\}$
\item Define states $s_t^j := \varepsilon_t^j$ and histories $s^{j,t} = (s_j^j, ..., s_t^j)$
\item Agents can trade one-period bonds with people on their islands. Arrow securities with corresponding prices $q_b^\ell(\varepsilon_{t+1}^j)$
\item Agents can also trade one-period bonds across islands. Arrow securities with corresponding prices $q_x(\zeta_{t+1}^j)$  where $\zeta_t^j := \varepsilon_t^j$
\item HH problem:
\begin{align*}
\max_{\{c_t^j, h_t^j, b^\ell(s_{t+1}^j), x (\zeta_{t+1}^j)\}_{t=j}^\infty} & E_j \sum_{t=j}^\infty (\beta \delta)^{t-j} u^j(c_t^j, h_t^j)\\
\text{s.t. } c_t^j + \int_{s_{t+1}^j} q_b^\ell(s_{t+1}^j) b^\ell(s_{t+1}^j) ds_{t+1}^j &+ \int_{\zeta_{t+1}^j} q_x(s_{t+1}^j) x(\zeta_{t+1}^j) d\zeta_{t+1}^j \le y_t^j + b^\ell(s_t^j) + x(\zeta_t^j)
\end{align*}
\item An equilibrium is an allocation is $x_j$ and prices $\{q_b^\ell(s_{t+1}^j\}_{\ell, t}$ and $\{q_x(\zeta_{t+1}^j\}_t$ such that
\begin{itemize}
\item HH solves HH problem given prices
\item Asset markets clear
\begin{align*}
\int b^\ell(s_{t+1}^j) d \Phi_t(i) &= 0 \;\;\; \forall s_{t+1}^j, \ell\\
\int x(\zeta_{t+1}^j) d \Phi_t(i) &= 0 \;\;\; \forall \zeta_{t+1}^j
\end{align*}
\end{itemize}
\item Steps: (1) formulate auxiliary problem (island planner problem) and (2) verify that this auxiliary problem satisfy the conditions of an competitive equilibrium
\end{itemize}

\subsection*{Island planner problem (auxiliary problem)}

\begin{itemize}
\item For every island $\ell$, the island planner solves static problem
\begin{align*}
\max_{\{c, h\}_{\varepsilon^j_t}} & \int u^j(c_t^j, h_t^j) d \Phi_t (\varepsilon_t)\\
\text{s.t. } & \int c(\varepsilon_t^j) d \Phi = \int z(\varepsilon_t^j) h (\varepsilon_t^j) d \Phi 
\end{align*}
\item Attach $\lambda$ on the RC
\item FOC  wrt $c(\varepsilon_t^j)$:
$$
c(\varepsilon_t^j)^{-1} = \lambda 
$$
Thus, there is perfect insurance on an island
\item FOC wrt $h(\varepsilon_t^j)$:
\begin{align*}
(\exp(B_j))^{\frac{1}{\eta} + 1} h_j^{1/\eta} = z(\varepsilon_t^j) \lambda
\end{align*}
Thus, hours change with $\varepsilon_t^j$. High $\varepsilon_t^j$ work more.
\item The RC and consumption FOC imply
\begin{align*}
\frac{1}{\lambda} 
&= \int z^{1 + \eta} \lambda^\eta \exp(-(1+\eta)B) d \Phi\\
&= \lambda^\eta \exp(-(1+\eta) B) \exp((1+\eta)\alpha) \int \exp((1+\eta)\varepsilon) d \Phi\\
\implies
1 &= \lambda \exp(-B) \exp(\alpha) \Bigg[\int \exp((1 + \eta)\varepsilon)d\Phi \Bigg]^{\frac{1}{1+\eta}}\\
\implies
c &= \exp(\alpha - B) \underbrace{\Bigg[\int \exp((1 + \eta)\varepsilon)d\Phi \Bigg]^{\frac{1}{1+\eta}}}_{\equiv \mathcal{C}}\\
\exp((1+\eta)B)h(\varepsilon) &= [\exp(\alpha + \varepsilon - \alpha + B)]^\eta / \mathcal{C}^\eta\\
h(\varepsilon) &= \frac{\varepsilon \eta}{\mathcal{C}^\eta \exp(B)}
\end{align*}
\item Comparative statistics:$\uparrow \varepsilon \implies \uparrow h(\varepsilon)$ and $\uparrow B \implies \downarrow h(\varepsilon)$
\item $\alpha$ doesn't show up in $h$ (kind of weird). Why? Income and substitution effects perfectly cancel out.
\begin{align*}
q_\ell(\varepsilon_{t+1}^j) 
&= \frac{u_c(c_{t+1}(\varepsilon_{t+1}^j))}{u_c(c_{t}(\varepsilon_{t}^j))} \beta \delta \underbrace{\pi_t(\varepsilon_{t+1})}_{\text{Doesn't vary by islands}}\\
&= \frac{c_t^j(\varepsilon_t^j)}{c_{t+1}^j(\varepsilon_{t+1}^j)} \beta \delta \pi_t(\varepsilon_{t+j})\\
&= \exp(\alpha - B -\alpha + B) \frac{\mathcal{C}_t}{\mathcal{C}_{t+1}} \beta \delta \pi_t(\varepsilon_{t+1})\\
&= \frac{\mathcal{C}_t}{\mathcal{C}_{t+1}} \beta \delta \pi_t(\varepsilon_{t+1})
\end{align*}
Price is the same across islands.
\item Risk-free asset price (let $\mathcal{E}_{t+1}$ be the support of $\varepsilon_{t+1}^j$):
\begin{align*}
q_\ell(\mathcal{E}_{t+1}) 
&= \int \frac{u_c^j(c_{t+1}^j(\varepsilon_{t+1}^j))}{u_c^j(c_{t}^j(\varepsilon_{t}^j))} \beta \delta d \Phi_j^\varepsilon\\
&= \beta \delta \frac{\mathcal{C}_t}{\mathcal{C}_{t+1}}
\end{align*}

\subsection*{Equilibrium Characterization}
\item From the equilibrium conditions, we can map data on wages, hours, and consumption $(\hat w_i, \hat h_i, \hat c_i)$ to structural parameters $(\alpha_i, \varepsilon_i, B_i)$:
\begin{align*}
\underbrace{\hat w_i}_{\text{data}} &= \underbrace{\exp(\alpha_i + \varepsilon_i)}_{\text{fn of structural  parameter}}\\
\underbrace{\hat h_i}_{\text{data}} &= \underbrace{\frac{\exp(\eta \varepsilon_i)}{\mathcal{C}^\eta \exp(B_i)} }_{\text{fn of structural  parameter}}\\
\underbrace{\hat c_i}_{\text{data}} &= \underbrace{\exp(\alpha_i - B_i) \mathcal{C}}_{\text{fn of structural  parameter}}
\end{align*}
\item We can rewrite structural parameters $(\alpha_i, \varepsilon_i, B_i)$ as functions of data $(\hat w_i, \hat h_i, \hat c_i)$:
\begin{align}
\frac{\hat c_i\hat w_i^\eta}{\hat h_i} &= \frac{\exp(\alpha_i - B_i) \exp(\eta(\alpha_i + \varepsilon_i)
)}{\exp(-B_i)\exp(\eta \varepsilon_i)} \nonumber \\
&= \exp((1+\eta)\alpha_i) \nonumber \\
\implies
\underbrace{\frac{1}{1+\eta} \log\Bigg[\frac{\hat c_i \hat w_i^\eta}{\hat h_i}\Bigg]}_{\text{fn of data}} &= \underbrace{\alpha_i}_{\text{structural parameter}} \\
\log (\hat w_i) - \alpha_i &= \varepsilon_i \nonumber \\
\implies
\underbrace{\log (\hat w_i) - \frac{1}{1+\eta} \log\Bigg[\frac{\hat c_i \hat w_i^\eta}{\hat h_i}\Bigg]}_{\text{fn of data}} &= \underbrace{\varepsilon_i}_{\text{structural parameter}} \\
\log(\hat c_i) &= \alpha_i - B_i + \log(\mathcal{C}) \nonumber \\
\implies
\underbrace{\frac{1}{1+\eta} \log\Bigg[\frac{\hat c_i \hat w_i^\eta}{\hat h_i}\Bigg] + \log(\mathcal{C}) - \log(\hat c_i)}_{\text{fn of data}}  &=  \underbrace{B_i}_{\text{structural parameter}} \label{B_mapping}
\end{align}
\item We can use common estimates of the Frisch elasticity of labor supply $\eta$ from the literature
\item (\ref{B_mapping}) Recall that 
\begin{align*}
\mathcal{C} = \Bigg[\int \exp((1 + \eta)\varepsilon)d\Phi \Bigg]^{\frac{1}{1+\eta}}
\end{align*}
Which can be estimated as
\begin{align*}
\mathcal{C} 
&\approx \Bigg[ \frac{1}{n} \sum \exp((1 + \eta)\varepsilon_i) \Bigg]^{\frac{1}{1+\eta}}\\
&= \Bigg[ \frac{1}{n} \sum \exp\Bigg((1 + \eta) \Bigg( \log (\hat w_i) - \frac{1}{1+\eta} \log\Bigg[\frac{\hat c_i \hat w_i^\eta}{\hat h_i}\Bigg] \Bigg) \Bigg) \Bigg]^{\frac{1}{1+\eta}}
\end{align*}


\end{itemize}

\end{enumerate}

\end{document}

