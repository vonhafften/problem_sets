\documentclass{article}
\usepackage{amsmath,amsthm,amssymb,amsfonts}
\usepackage{setspace,enumitem}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{natbib}
\usepackage{afterpage}
\usepackage{xcolor}
\usepackage{etoolbox}
\usepackage{bbm}
\usepackage{booktabs}
\usepackage{pdfpages}
\usepackage{multicol}
\usepackage{soul}
\usepackage{geometry}
\usepackage{accents}
\usepackage{accents}
\hypersetup{
	colorlinks,
	linkcolor={blue!90!black},
	citecolor={red!90!black},
	urlcolor={blue!90!black}
}
\usepackage{setspace}

\newtheorem{theorem}{Theorem}
\newtheorem{assumption}{Assumption}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{lemma}{Lemma}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Lfn}{\mathcal{L}}
\newcommand{\M}{\mathcal{M}}
\newcommand{\one}{\mathbbm{1}}
\newcommand{\Int}{\text{Int}}
\newcommand{\ubar}[1]{\underaccent{\bar}{#1}}
\newcommand{\xbf}{\mathbf{x}}
\newcommand{\Abf}{\mathbf{A}}
\newcommand{\Bbf}{\mathbf{B}}
\newcommand{\Gbf}{\mathbf{G}}
\newcommand{\bbf}{\mathbf{b}}
\newcommand{\Ebf}{\mathbf{E}}
\setlength\parindent{0pt}

\title{Notes on Heathcote, Storesletten, and Violante (2017)}
\author{Alex von Hafften}
\date{\today}

\begin{document}

\maketitle

My notes follow the organization of the paper. Initial focus particularly on sections 3, 4, and 5. Appendix has notes from Job's lecture on related papers, Heathcote, Storesletten, and Violante (2014) and Boerma and Karabarbounis (2021).



\section{Introduction}



\begin{itemize}
\item What is the optimal degree of progressivity of tax/transfer system?
\item Reasons for more progressivity
\begin{itemize}
\item Counteracts inequality in initial conditions
\item Substitutes for imperfect private insurance against idiosyncratic earnings risk
\end{itemize}
\item Reasons for less progressivity
\begin{itemize}
\item Reduces incentives to work
\item Reduces incentives to invest in skills
\end{itemize}
\item Develop general equilibrium model with these four trade-offs
\item Results for U.S. calibration:
\begin{itemize}
\item Baseline model indicates current system is too progressive
\item Adding that poverty constrains skill investment indicates the current system is close to optimal
\end{itemize}
\end{itemize}



\section{Tax Function}



\begin{itemize}
\item Tax revenue for pre-tax income $y$ is
\begin{align}
T(y) &= y - \lambda y^{1 - \tau} \label{tax_function}
\end{align}
\item After-tax income $\tilde y_i$ for pre-tax income $y_i$
\begin{align}
\tilde y_i 
&= y_i - T(y_i) \nonumber \\
&= y_i - y_i + \lambda y_i^{1 - \tau} \nonumber \\
&= \lambda y_i^{1-\tau} 
\end{align}
Thus, $1-\tau$ is elasticity of after-tax income to pre-tax income.
\item If $\tau > 0$ then marginal rates exceed average rates (progressive), if $\tau < 0$, marginal rates are smaller than average rates (regressive), and, if $\tau = 0$, marginal rates and average are the same $\implies$ flat tax.
\begin{align}
\frac{1 - T'(y_i)}{1 - \frac{T(y_i)}{y_i}} 
&= \frac{1 - (1 - \lambda (1-\tau)y^{- \tau}) }{1 - (1-\lambda y^{-\tau})} \nonumber \\
&=1 - \tau
\end{align}
\item With balanced budget $g Y = \int T(y_i)di$, so income-weighted marginal rate is
\begin{align}
\int T'(y_i) \Bigg( \frac{y_i}{Y} \Bigg) di 
&= \int (1 - (1-\tau)\lambda y_i^{-\tau}) \Bigg( \frac{y_i}{Y} \Bigg) di   \nonumber \\
&= \frac{1}{Y}\int y_i di - (1-\tau)\frac{1}{Y}\int \lambda y_i^{1-\tau} di   \nonumber \\
&= 1 - (1-\tau)\frac{1}{Y}\int y_i -T(y_i) di   \nonumber \\
&= 1 - (1-\tau)\frac{1}{Y}(Y - gY)   \nonumber \\
&= 1 - (1-\tau)(1-g)
\end{align}
\end{itemize}

\subsection{Empirical Fit}

\subsection{Robustness}

\subsection{Discussion}

\section{Economic Environment}



\begin{itemize}
\item Economy is steady state, so time subscripts omitted.
\end{itemize}



\subsection{Demographics}


\begin{itemize}
\item Agents indexed by $i = [0,1]$.
\item Yaari perpetual youth structure: 
\begin{itemize}
\item At every age $a$, an agent survives to next period with probability $\delta < 1$.
\item Each period newborn agents of size $1-\delta$ enter economy.
\end{itemize}
\end{itemize}


\subsection{Life Cycle}


\begin{itemize}
\item At beginning of live, agent $i$ chooses initial investment in skills $s_i$.
\item Agent $i$ then enters labor market and faces random  fluctuations in labor productivity $z_i$.
\item Every period, agent $i$ chooses hours of work $h_i \ge 0$ and consumption of private good $c_i$.
\end{itemize}



\subsection{Technology}



\begin{itemize}
\item $\theta > 1$ denotes elasticity of substitution across skill types
\item $N(s)$ denotes average effective hours worked by individuals with skill type $s$
\item $m(s)$ denotes the density of individuals with skill type $s$
\item Output $Y$ is constant elasticity of substitution aggregate of effective hours supplied by continuum of skill types $s \in [0,\infty)$:
\begin{align}
Y = \Bigg( \int_0^\infty [N(s) \cdot m(s)]^{\frac{\theta - 1}{\theta}} ds \Bigg)^{\frac{\theta}{\theta - 1}} \label{fg_production}
\end{align}
\item Marginal product from an additional unit of effective hours of skill type $s$ is
\begin{align*}
\frac{\partial Y}{\partial N(s)} &= \frac{\theta}{\theta - 1}\Bigg( \int_0^\infty [N(s) \cdot m(s)]^{\frac{\theta - 1}{\theta}} ds \Bigg)^{\frac{\theta}{\theta - 1} - 1}\\
&= \Bigg( \frac{Y}{N(s)\cdot m(s)} \Bigg)^{\frac{1}{\theta}}
\end{align*}
\item Resource constraint is
\begin{align}
Y &= \int_0^1 c_i di + G \label{rc}
\end{align}
\end{itemize}



\subsection{Preferences}



\begin{itemize}
\item $\beta$ is the ``pure" discount factor
\item Agent $i$ has preferences over private consumption, hours worked, public goods, and skill investment effort:
\begin{align}
U_i = - v_i(s_i) + (1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a u_i(c_{ia}, h_{ia}, G) \label{utility}
\end{align}
where expectations are taken over the future idiosyncratic productivity shocks.
\item $\psi \ge 0$ denotes the elasticity of skill investment wrt to the return to skill
\item $\kappa_i \ge 0$ is an individual-specific parameter that determine the utility cost of acquiring skills (larger $\kappa_i \implies$ the skills are cheaper, so $\kappa_i$ can be thought of as learning ability); $\kappa_i$ is assumed to be distributed exponential with parameter $\eta$: $\kappa_i \sim Exp(\eta)$
\item The disutility of the initial skill investment $s_i \ge 0$ is
\begin{align}
v_i(s_i) = \frac{\psi}{1 + \psi} \kappa_i^{-\frac{1}{\psi}} s_i^\frac{1 + \psi}{\psi} \label{disutility_skill}
\end{align}
\item Let $\exp[(1+\sigma) \varphi_i]$ be the disutility of work effort with $\varphi_i \sim N(\frac{v_\varphi}{2}, v_\varphi)$ and $\kappa_i$ and $\varphi_i$ are uncorrelated.
\item Let $\sigma > 0$ determine aversion to hours fluctuations
\item Let $\chi \ge 0$ measure the taste for public goods relative to private consumption goods
\item The period utility function
\begin{align}
u_i(c_{ia}, h_{ia}, G) = \log c_{ia} - \frac{\exp [(1+\sigma) \varphi_i] }{1 + \sigma} (h_{ia})^{1 + \sigma} + \chi \log G
\end{align}
\item Define the tax-modified Frisch elasticity $\hat \sigma$ as:
\begin{align}
\frac{1}{\hat \sigma} \equiv \frac{1 - \tau}{\sigma + \tau}
\end{align}
\end{itemize}



\subsection{Labor Productivity and Earnings}




\begin{itemize}
\item Log labor efficiency $z_{ia}$ is sum of a random walk and orthogonal white noise
\begin{align}
\log z_{ia} &= \alpha_{ia} + \varepsilon_{ia} \\
\text{where }
\alpha_{ia} &= \alpha_{i, a - 1} + \omega_{ia} \nonumber\\
\omega_{ia} &\sim^{iid} N(-\frac{v_w}{2}, v_w) \nonumber \\
\alpha_{i0} &= 0 \nonumber\\
\varepsilon_{ia} &\sim^{iid} N(-\frac{v_\varepsilon}{2}, v_\varepsilon) \nonumber
\end{align}
\item Individual earnings $y_{ia}$ is the product of the equilibrium price for labor from skill type $s_i$, individual labor productivity, and the number of hours worked.
\begin{align}
y_{ia} &= p(s_i) \times \exp( \alpha_{ia} + \varepsilon_{ia}) \times h_{ia}
\end{align}
\end{itemize}



\subsection{Financial Assets}



\begin{itemize}
\item Partial insurance structure with $\varepsilon$ shocks fully insurable but $\alpha$ shocks are not
\item Full set of state-contingent claims indexed by the $\varepsilon$ shocks.
\item Let $B(\Ebf)$ and $Q(\Ebf)$ denote the quantity and the price of insurance claims purchased that pay one unit of consumption iff $\varepsilon \in \Ebf \subset \R$.
\item Insurance claims in zero net supply and newborn agents start with zero initial holdings
\item Notice special cases of autarky with $v_\varepsilon = 0$ and full insurance with $v_\omega = 0$
\end{itemize}



\subsection{Markets}

\begin{itemize}
\item Competitive market for final consumption good, all types of labor services, and financial claims.
\item Final consumption good is numeraire
\end{itemize}



\subsection{Government}



\begin{itemize}
\item Government chooses $(g,\tau)$ where $g$ is government consumption as fraction of aggregate output and $\tau$ determines the degree of progressivity of the tax system.
\item Given $(g, \tau)$, the average level of taxation $\lambda$ balances its budget:
\begin{align}
G \equiv gY = g \int_0^1 y_i di = \int_0^1 (y_i - \lambda y_i^{1-\tau}) di \label{gbc}
\end{align}
\end{itemize}



\subsection{Agent's Problem}


\begin{itemize}
\item At $a = 0$, given $(\kappa_i, \varphi_i)$, agent chooses a skill level given. FOC of (\ref{utility}) wrt $s_i$
\begin{align*}
\frac{\partial v_i(s_i)}{\partial s_i} = (1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a \frac{\partial u_i(c_{ia}, h_{ia}, G)}{\partial s_i}
\end{align*}
In words, the marginal disutility of skill investment must equal the present discounted value of the higher associated expected lifetime wages. The derivative of (\ref{disutility_skill}) is
\begin{align*}
\frac{\partial v_i(s_i)}{\partial s_i} = \frac{\psi}{1 + \psi} \frac{1 + \psi}{\psi}\kappa_i^{-\frac{1}{\psi}} s_i^\frac{1}{\psi} = \Bigg(\frac{s_i}{\kappa_i}\Bigg)^{\frac{1}{\psi}}
\end{align*}
Combining
\begin{align}
\Bigg(\frac{s_i}{\kappa_i}\Bigg)^{\frac{1}{\psi}} = (1 - \beta \delta) E_0 \sum_{a = 0}^\infty (\beta \delta)^a \frac{\partial u_i(c_{ia}, h_{ia}, G)}{\partial s_i}
\end{align}
\item At $a > 0$, timing is: 
\begin{enumerate}
\item $\omega_{ia}$ realized
\item Insurance market for $\varepsilon$ shocks opens and individual buys claims $B(\cdot)$
\item $\varepsilon_{ia}$ is realized
\item Chooses hours $h_{ia}$, receives $y_{ia}$, pays taxes, and chooses private consumption $c_{ia}$
\end{enumerate}
\item When insurance purchases are made (middle of period), budget constraint is
\begin{align}
\int_E Q(\varepsilon) B(\varepsilon) d\varepsilon = 0
\end{align}
\item When paying taxes and choosing consumption (end of period), budget constraint is
\begin{align}
c_{ia} 
&= y_{ia} - T(y_{ia})  + B(\varepsilon_{ia})\nonumber \\
&= y_{ia} - y_{ia} + \lambda y_{ia}^{1-\tau}  + B(\varepsilon_{ia})\nonumber \\
&= \lambda [p(s_i) \exp(\alpha_{ia} + \varepsilon_{ia}) h_{ia}]^{1-\tau} + B(\varepsilon_{ia})
\end{align}
\item Thus, given $s_i$, an agent solves
\begin{align*}
\max_{\{c_{ia}, h_{ia}\}_{a = 1, ..., \infty}} &
 E_0 \sum_{a = 0}^\infty (\beta \delta)^a u_i(c_{ia}, h_{ia}, G)\\
\text{s.t. }
0 &= \int_E Q(\varepsilon) B(\varepsilon) d\varepsilon \\
c_{ia} &= \lambda [p(s_i) \exp(\alpha_{ia} + \varepsilon_{ia}) h_{ia}]^{1-\tau} + B(\varepsilon_{ia})
\end{align*}
\end{itemize}



\subsection{A Special Case: The Representative Agent's Problem}




\begin{itemize}
\item Consider the representative agent case of this model.
\item The rep agent problem entails no cross-sectional dispersion in disutility of work effort ($v_\varphi = 0$), no idiosyncratic labor efficiency permanent shocks ($v_\omega = 0$), no idiosyncratic labor efficiency transitory shocks ($v_\varepsilon = 0$), and perfectly elastic production across skill types ($\theta = \infty$).
\item The relevant state variable for the general model is the skill investment and the current level of the productivity random walk, but the rep agent both are degenerate, thus the rep agent problem a static consumption/leisure choice where $(\lambda, g, \tau)$ are given:
\begin{align}
\max_{C, H} \log C &- \frac{H^{1 + \sigma}}{1 + \sigma} + \chi \log G\\
\text{s.t. } C &= \lambda H^{1-\tau} \nonumber \\
\implies \max_{H} \log (\lambda H^{1-\tau}) &- \frac{H^{1 + \sigma}}{1 + \sigma} + \chi \log G \nonumber
\end{align}
\item FOC wrt $H$
\begin{align}
\frac{(1-\tau)\lambda H^{-\tau}}{\lambda H^{1-\tau}} &= H^\sigma  \nonumber \\
\implies
(1-\tau) &= H^{\sigma+1} \nonumber \\
\implies \log H^{RA}(\tau) &= \frac{1}{1 + \sigma} \log ( 1 - \tau)
\end{align}
Taking logs of both sides of the budget constraint and substituting:
\begin{align}
\log C^{RA}(g, \tau, \lambda) 
&= \log \lambda + (1-\tau) \log H^{RA}(\tau) \nonumber \\
&= \log \lambda +  \frac{1-\tau}{1 + \sigma} \log ( 1 - \tau) \label{c_ra_lambda}
\end{align}
\item With degenerate skill distribution, aggregate output equals aggregate hours $Y=H$. The government budget constraint implies
\begin{align*}
G &= gY = gH = Y - \lambda Y^{1-\tau} = H - \lambda H^{1-\tau} \\
\implies
g &= 1 - \lambda H^{-\tau}\\
\implies
\lambda(g, \tau)  &= H^{\tau}(1 - g)
\end{align*}
Substituting into (\ref{c_ra_lambda}),
\begin{align*}
\log C^{RA}(g, \tau) 
&= 
\log C^{RA}(g, \tau, \lambda(g, \tau)) \\
&= \log (H^{\tau}(1 - g)) +  \frac{1-\tau}{1 + \sigma} \log ( 1 - \tau) \\
&=\tau \log (H) + \log (1 - g) +  \frac{1-\tau}{1 + \sigma} \log ( 1 - \tau) \\
&=\tau \frac{1}{1 + \sigma} \log (1 - \tau) + \log (1 - g) +  \frac{1-\tau}{1 + \sigma} \log ( 1 - \tau) \\
&= \log (1 - g) +  \frac{1}{1 + \sigma} \log ( 1 - \tau)
\end{align*}
\item More progressivity lowers rep agent labor supply:
\begin{align*}
\frac{\partial \log H^{RA}(\tau)}{\partial \tau} &= \frac{-1}{(1 + \sigma)(1 - \tau)} < 0
\end{align*}
\item More progressivity lowers rep agent consumption:
\begin{align*}
\frac{\partial \log C^{RA}(\tau)}{\partial \tau} &=  \frac{-1}{(1 + \sigma)( 1 - \tau)} < 0
\end{align*}
\item At high enough levels of progressivity, the rep agent stops working
\begin{align*}
\lim_{\tau \to 1} H^{RA} (\tau) 
&= \lim_{\tau \to 1} \max\{0, \frac{1}{1 + \sigma} \log ( 1 - \tau)\}\\
&= \max\{0, -\infty\}\\
&= 0
\end{align*}
\end{itemize}




\section{Equilibrium}



\begin{itemize}
\item Recursive formulation to define stationary competitive equilibrium
\item Individual state variables:
\begin{itemize}
\item $(\kappa, \varphi)$ for skill accumulation decision at $a = 0$
\item $(\varphi, \alpha, s)$ for beginning-of-period insurance claims purchasing decisions
\item $(\varphi, \alpha, \varepsilon, \bar B)$ for end-of-period consumption and labor supply decisions where $\bar B = B(\varepsilon; \varphi, \alpha, s)$
\end{itemize}
\item Given $(g, \tau)$, a \underline{stationary recursive competitive equilibrium} is a tax level $\lambda$; asset prices $Q(\cdot)$; skill prices $p(s)$; decision rules $s(\kappa, \varepsilon), c(\varphi, \alpha, \varepsilon, s), h(\varphi, \alpha, \varepsilon, s)$, and $B(\cdot; \varphi, \alpha, s)$; and aggregate quantities $N(s)$ such that:
\begin{enumerate}
\item HHs solve their problem and $s(\kappa, \varepsilon), c(\varphi, \alpha, \varepsilon, s), h(\varphi, \alpha, \varepsilon, s)$, and $B(\cdot; \varphi, \alpha, s)$ are the associated decision rules.
\item Labor markets for each skill type clear and $p(s)$ is the value of the marginal product from an additional unit of effective hours of skill type $s$:
$$
p(s) = \Bigg( \frac{Y}{N(s)\cdot m(s)} \Bigg)^{\frac{1}{\theta}}
$$
\item Asset markets clear, and the prices $Q(\cdot)$ of insurance claims are actuarially fair.
\item Government budget constraint holds (i.e., $\lambda$ satisfies ($\ref{gbc}$)).
\end{enumerate}
\end{itemize}



{
\proposition The equilibrium hours-worked allocation is
\begin{align}
\log h(\varphi, \varepsilon; \tau) = \log H^{RA}(\tau) - \varphi + \frac{1}{\hat{\sigma}} \varepsilon - \frac{1}{\hat \sigma (1- \tau)} \M (v_\varepsilon; \tau) \label{prop1_h}
\end{align}
where $\M ( v_\varepsilon; \tau) = \frac{(1-\tau)(1 - \tau(1+\hat \sigma))}{\hat \sigma} \frac{v_\varepsilon}{2}$. The consumption allocation is 
\begin{align}
\log c(\varphi, \alpha, s; g, \tau) = \log [C^{RA}(\tau)\vartheta(\tau)] + (1 - \tau) [\log p(s; \tau) + \alpha - \varphi] + \M (v_\varepsilon; \tau) \label{prop1_c}
\end{align}
where $\vartheta(\tau)$ is common across agents.
}



\bigskip



\textbf{Proof of Proposition 1:} 



\begin{itemize}
\item The roadmap of the proof is to (1) separate the economy into ``island" for each $(\varphi, s, \alpha)$, (2) solve the static ``island planner problem", and (3) verify that this allocation satisfies the conditions of the CE. The intuition behind this result is that, since the market is complete wrt to $\varepsilon$, so the CE allocation is efficient, so it can be computed as the solution to an island-specific planner problem. 
\item Since each island transfers zero net financial wealth between periods and preferences are time separable, each island-specific planner problem is static.
\item Island-specific resource constraint is island-aggregate consumption equals island-aggregate after-tax income:
\begin{align*}
\int_E c(\varepsilon) dF_\varepsilon 
&= \lambda \int_E [ p(s)\exp (\alpha + \varepsilon) h(\varepsilon)]^{1-\tau} dF_\varepsilon\\
&= \lambda \int_E \exp [(1-\tau)(\log p(s)+ \alpha + \varepsilon)] h(\varepsilon)^{1-\tau} dF_\varepsilon\\
&= \lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \int_E \exp [(1-\tau) \varepsilon] h(\varepsilon)^{1-\tau} dF_\varepsilon
\end{align*}
\item Taking $(\varphi, s, \alpha)$, $(G, \lambda, \tau)$, and $p(s)$ as given, the island planner problem is
\begin{align*}
\max_{\{c(\varepsilon), h(\varepsilon)\}} \int_E \Bigg\{ \log c(\varepsilon) &- \frac{\exp[(1+\sigma)\varphi]}{1 + \sigma} h(\varepsilon)^{1+\sigma} + \chi \log G \Bigg\} dF_\varepsilon\\
\text{s.t. } \int_E c(\varepsilon) dF_\varepsilon 
&= \lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \int_E \exp [(1-\tau) \varepsilon] h(\varepsilon)^{1-\tau} dF_\varepsilon
\end{align*}
\item Let $\gamma$ be the multiplier on the resource constraint. The lagrangian is
\begin{align*}
\Lfn = \int_E \Bigg\{ \log c(\varepsilon) &- \frac{\exp[(1+\sigma)\varphi]}{1 + \sigma} h(\varepsilon)^{1+\sigma} + \chi \log G \Bigg\} dF_\varepsilon \\
&+ \gamma \Bigg[\lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \int_E \exp [(1-\tau) \varepsilon] h(\varepsilon)^{1-\tau} dF_\varepsilon - \int_E c(\varepsilon) dF_\varepsilon \Bigg]
\end{align*}
\item FOC wrt $c(\varepsilon)$:
\begin{align*}
\frac{1}{c(\varepsilon)} = \gamma \implies c(\varepsilon) = c = \frac{1}{\gamma} \;\;\; \forall \varepsilon
\end{align*}
Thus, consumption is the same across agents on an island regardless of their realization of $\varepsilon \implies$ perfect consumption risk sharing
\item FOC wrt $h(\varepsilon)$:
\begin{align*}
\exp[(1+\sigma) \varphi] h(\varepsilon)^{\sigma} &= \gamma \lambda (1-\tau) \exp [(1-\tau)(\log p(s)+ \alpha)]  \exp [(1-\tau) \varepsilon] h(\varepsilon)^{-\tau} \\
\implies
h(\varepsilon)^{\sigma+\tau} &= \gamma \lambda (1-\tau) \exp [(1-\tau)(\log p(s)+ \alpha)-(1+\sigma) \varphi]  \exp [(1-\tau) \varepsilon] \\
\implies
h(\varepsilon) &= \gamma^{\frac{1}{\sigma+\tau}} [\lambda (1-\tau)]^{\frac{1}{\sigma+\tau}} \exp \Bigg[\frac{1-\tau}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{1+\sigma}{\sigma+\tau} \varphi \Bigg]  \exp  \Bigg[\frac{1-\tau}{\sigma+\tau} \varepsilon  \Bigg]
\end{align*}
\item Substituting both conditions into the resource constraint
The resource constraint can be expressed as
\begin{align*}
c
&= \lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \int_E \exp [(1-\tau) \varepsilon] h(\varepsilon)^{1-\tau} dF_\varepsilon \\
\implies
\gamma^{-1}
&= \lambda \exp [(1-\tau)(\log p(s)+ \alpha)] \\
&\cdot \int_E \exp [(1-\tau) \varepsilon]  \gamma^{\frac{1 - \tau}{\sigma+\tau}} [\lambda (1-\tau)]^{\frac{1 - \tau}{\sigma+\tau}} \\&\exp \Bigg[\frac{(1-\tau)^2}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{(1+\sigma)(1-\tau)}{\sigma+\tau} \varphi \Bigg]  \exp  \Bigg[\frac{(1-\tau)^2}{\sigma+\tau} \varepsilon  \Bigg] dF_\varepsilon\\
\implies
\gamma^{\frac{-\sigma -1 }{\sigma+\tau}}
&= \lambda^{\frac{1+\sigma}{\sigma +\tau}}  (1-\tau)^{\frac{1 - \tau}{\sigma+\tau}} \exp [(1-\tau)( \log p(s)+ \alpha)]   \exp \Bigg[\frac{(1-\tau)^2}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{(1+\sigma)(1-\tau)}{\sigma+\tau} \varphi \Bigg]\\
&\cdot \int_E  \exp  \Bigg[\Bigg(\frac{(1-\tau)^2 + (1 -\tau)(\sigma+\tau)}{\sigma+\tau} \Bigg) \varepsilon  \Bigg] dF_\varepsilon\\
\gamma^{\frac{-\sigma -1 }{\sigma+\tau}}
&= \lambda^{\frac{1+\sigma}{\sigma +\tau}}  (1-\tau)^{\frac{1 - \tau}{\sigma+\tau}}  \exp \Bigg[\frac{(1-\tau)(1+\sigma)}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{(1+\sigma)(1-\tau)}{\sigma+\tau} \varphi \Bigg]\\
&\cdot \int_E  \exp  \Bigg[\Bigg(\frac{(1-\tau)(1+\sigma)}{\sigma+\tau} \Bigg) \varepsilon  \Bigg] dF_\varepsilon
\end{align*}
\item Focusing in on the last term, we can solve using MGF of normal distribution:\footnote{If $X \sim N(\mu, \sigma^2)$, then $E[\exp(aX)] = \exp(a\mu + \frac{a^2\sigma^2}{2})$.}
\begin{align*}
\int_E  \exp  \Bigg[\frac{(1-\tau)(1+\sigma)}{\sigma+\tau}  \varepsilon  \Bigg] dF_\varepsilon
&= \exp  \Bigg[ \frac{(1-\tau)(1+\sigma)}{\sigma+\tau}\frac{-v_\varepsilon}{2} +   \frac{1}{2}\frac{(1-\tau)^2(1+\sigma)^2}{(\sigma+\tau)^2} v_\varepsilon \Bigg]\\
&= \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)^2(1+\sigma)^2}{(\sigma+\tau)^2} - \frac{(1-\tau)(1+\sigma)}{\sigma+\tau}\Bigg) \Bigg]\\
&= \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)^2(1+\sigma)^2 - (1-\tau)(1+\sigma)(\sigma+\tau)}{(\sigma+\tau)^2}\Bigg) \Bigg]\\
&= \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1+\sigma)[(1-\tau)(1+\sigma) - (\sigma+\tau)]}{(\sigma+\tau)^2}\Bigg) \Bigg]\\
&= \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1+\sigma)(1-2\tau-\tau\sigma)}{(\sigma+\tau)^2}\Bigg) \Bigg]
\end{align*}
Plugging back into resource constraint:
\begin{align*}
\gamma^{\frac{-\sigma -1 }{\sigma+\tau}}
&= \lambda^{\frac{1+\sigma}{\sigma +\tau}}  (1-\tau)^{\frac{1 - \tau}{\sigma+\tau}}  \exp \Bigg[\frac{(1-\tau)(1+\sigma)}{\sigma +\tau}(\log p(s)+ \alpha - \varphi) \Bigg]\\
&\cdot \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1+\sigma)(1-2\tau-\tau\sigma)}{(\sigma+\tau)^2}\Bigg) \Bigg]\\
\implies
\gamma^{-1}
&= \lambda (1-\tau)^{\frac{1 - \tau}{1+\sigma}}  \exp \Bigg[(1-\tau)(\log p(s)+ \alpha -\varphi) \Bigg] \exp  \Bigg[\frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1-2\tau-\tau\sigma)}{(\sigma+\tau)}\Bigg) \Bigg]\\
\log c &= \log \lambda + \frac{1-\tau}{1 +\sigma}\log(1-\tau) + (1-\tau)[\log p(s) + \alpha - \varphi] + \frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1-2\tau-\tau\sigma)}{(\sigma+\tau)}\Bigg)
\end{align*}
\item Defining the last term as $\M ( v_\varepsilon; \tau)$:
\begin{align*}
\M ( v_\varepsilon; \tau) 
&= \frac{v_\varepsilon}{2}\Bigg( \frac{(1-\tau)(1-2\tau-\tau\sigma)}{(\sigma+\tau)}\Bigg)\\
&= \frac{v_\varepsilon}{2}\Bigg( \frac{1-2\tau-\tau\sigma}{\hat \sigma}\Bigg)\\
&= \frac{v_\varepsilon}{2}\Bigg( \frac{1-\tau-\tau(1+\sigma)}{\hat \sigma}\Bigg)\\
&= \frac{(1-\tau)(1 - \tau(1+\hat \sigma))}{\hat \sigma} \frac{v_\varepsilon}{2}
\end{align*}
\item Recall that $\log C^{RA} = \log (1 - g) +  \frac{1}{1 + \sigma} \log ( 1 - \tau)$, so we can rewrite consumption as
\begin{align*}
\log c = \log [C^{RA}\vartheta] + (1 - \tau) [\log p(s) + \alpha - \varphi] + \M (v_\varepsilon; \tau)
\end{align*}
where $\log \vartheta \equiv \log \lambda - \log(1-g) - \frac{\tau}{1+\sigma} \log(1-\tau)$. This equation matches (\ref{prop1_c}).
\item Turning back to the intratemporal FOC and taking logs and substituting in consumption:
\begin{align*}
\log h(\varepsilon) 
&= \frac{1}{\sigma+\tau}\log\gamma + \frac{1}{\sigma+\tau} \log \lambda + \frac{1}{\sigma+\tau} \log(1-\tau) + \frac{1-\tau}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{1+\sigma}{\sigma+\tau} \varphi   +  \frac{1-\tau}{\sigma+\tau} \varepsilon  \\
&= \frac{-1}{\sigma+\tau}\Bigg[ \log \lambda + \frac{1-\tau}{1 +\sigma}\log(1-\tau) + (1-\tau)[\log p(s) + \alpha - \varphi] + \M ( v_\varepsilon; \tau) \Bigg] \\
&+ \frac{1}{\sigma+\tau} \log \lambda + \frac{1}{\sigma+\tau} \log(1-\tau) + \frac{1-\tau}{\sigma +\tau}(\log p(s)+ \alpha)-\frac{1+\sigma}{\sigma+\tau} \varphi   +  \frac{1-\tau}{\sigma+\tau} \varepsilon\\
&= \Bigg[\frac{-1}{\sigma + \tau} + \frac{1}{\sigma + \tau}  \Bigg] \log \lambda
+ \Bigg[\frac{-1(1-\tau)}{(\sigma + \tau)(1+\sigma)} + \frac{1}{\sigma + \tau}\Bigg] \log (1-\tau)
\\&+ \Bigg[\frac{-(1-\tau)}{(\sigma + \tau)} + \frac{(1-\tau)}{(\sigma+\tau)}\Bigg] [\log p(s) + \alpha]
+ \Bigg[\frac{-1(1-\tau)}{\sigma+\tau} -\frac{1+\sigma}{\sigma+\tau} \Bigg] \varphi
+ \frac{1-\tau}{\sigma+\tau} \varepsilon
- \frac{1}{\sigma+\tau} \M ( v_\varepsilon; \tau)\\
&=  \frac{1}{1+\sigma} \log (1-\tau) - \varphi
+ \frac{1-\tau}{\sigma+\tau} \varepsilon
- \frac{1}{\sigma+\tau} \M ( v_\varepsilon; \tau)
\end{align*}
\item Recall that $\log H^{RA}(\tau) = \frac{1}{1 + \sigma} \log ( 1 - \tau)$, so this equation can be rewritten to match (\ref{prop1_h}):
$$
\log h(\varepsilon) 
=  \log H^{RA}(\tau) - \varphi
+ \frac{1-\tau}{\sigma+\tau} \varepsilon
- \frac{1}{\sigma+\tau} \M ( v_\varepsilon; \tau)
$$
$\square$

\end{itemize}

{
\proposition Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

\subsection{Efficiency}

{
\proposition Hello

}

\section{Welfare Effects of Tax Reform}



\subsection{Social Welfare Function}



{
\proposition Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

{
\corollary Hello

}

\subsection{Decomposition of the Social Welfare Function}

\subsubsection{Welfare of the Representative Agent}

{
\proposition Hello

}

\subsubsection{Welfare from Skill Investment}

\subsubsection{Welfare from Preference Heterogeneity and Uninsurable Wage Risk}

\subsubsection{Welfare from Insurable Wage Risk}


\subsection{When Should Taxes Be Progressive?}

{
\proposition Hello

}

\subsection{Optimal Marginal Tax Rate at the Top}

\section{Quantitative Analysis}

\subsection{Parameterization}

\subsection{Results}

\subsection{Progressivity When Past Skill Investment is Fixed}

\subsection{Modeling Public Consumption}

\subsection{Inequality Aversion}

{
\proposition Hello

}

\subsection{Political-Economic Determination of Progressivity}

{
\proposition Hello

}

{
\proposition Hello

}

\section{Skill Investment Constraints}

\section{Empirical Evidence}

\section{Conclusions}

\pagebreak

\section*{Appendix: Lecture Notes on HSV (2014) and BK (2021)}

Job presented a simplified version of HSV (2014) and BK (2021), which are closely related papers. I have included these lecture notes because I found them helpful in understanding the more complicated HSV (2017). 

\bigskip

\textbf{Question:} We have data on consumption, hours, and wages $\{c_i, h_i, w_i\}_i$. Can we perfectly rationalize these data?

\subsection*{Environment}

\begin{enumerate}

\item Demography

\begin{itemize}
\item HHs
\item Time: $t=0,1,...$
\item Perpetual youth: $P(death) = 1 - \delta$ and $P(survival) = \delta$
\item Every time $t$, mass $1-\delta$ is born
\item Age $a = 0, 1,...$
\item Cohort $j \in (-\infty, \infty)$
\end{itemize}

\item Preferences

\begin{align*}
E_j \sum_{t=j}^\infty (\beta \delta)^{t-j} u^j(c_t^j, h_t^j) 
&= 
E_j \sum_{t=j}^\infty (\beta \delta)^{t-j} \Bigg[\frac{(c_t^j)^{1-\gamma}-1}{1-\gamma} - \frac{[\exp(B^j) h_t^j]^{1+\frac{1}{\eta}}}{1+\frac{1}{\eta}} \Bigg]
\end{align*}
\begin{itemize}
\item $\eta$ is the Frisch elasticity of labor supply
\item Here, we generally focus on $\gamma \to 1 \implies \log$ preferences over consumption
\end{itemize}
\begin{align*}
u^j(c_t^j, h_t^j) 
&= 
\log c_t^j - \frac{[\exp(B^j) h_t^j]^{1+\frac{1}{\eta}}}{1+\frac{1}{\eta}}
\end{align*}

\item Technology

\begin{itemize}
\item Production
\item $y = zh$ where $y$ is earnings, $z$ is wage rate per hour, and $h$ is hours
\item $z = \exp(\alpha + \varepsilon)$ where $\alpha^j$ is permanent, $\varepsilon_t^j = \nu_t^\varepsilon$ varies in every time period and across agent (idiosyncratic and iid across time and agents)
\item Distributions are $\nu_t^\varepsilon \sim \Phi_t^\varepsilon$, $\alpha^j \sim \Phi_j^\alpha$, $B^j \sim \Phi_j^B$ 
\end{itemize}

\item Information structure

\begin{itemize}
\item Perfect foresight: $\{ \Phi_t^\varepsilon, \Phi_j^\alpha, \Phi_j^B \}$ are known
\end{itemize}


\item Equilibrium

\begin{itemize}
\item A HH denoted by $i = \{j, B^j, \alpha^j, \{ \nu_t^j \}\}$
\item Define island $\ell$ as the collection of households with identical $\{j, B^j, \alpha^j\}$
\item Define states $s_t^j := \varepsilon_t^j$ and histories $s^{j,t} = (s_j^j, ..., s_t^j)$
\item Agents can trade one-period bonds with people on their islands. Arrow securities with corresponding prices $q_b^\ell(\varepsilon_{t+1}^j)$
\item Agents can also trade one-period bonds across islands. Arrow securities with corresponding prices $q_x(\zeta_{t+1}^j)$  where $\zeta_t^j := \varepsilon_t^j$
\item HH problem:
\begin{align*}
\max_{\{c_t^j, h_t^j, b^\ell(s_{t+1}^j), x (\zeta_{t+1}^j)\}_{t=j}^\infty} & E_j \sum_{t=j}^\infty (\beta \delta)^{t-j} u^j(c_t^j, h_t^j)\\
\text{s.t. } c_t^j + \int_{s_{t+1}^j} q_b^\ell(s_{t+1}^j) b^\ell(s_{t+1}^j) ds_{t+1}^j &+ \int_{\zeta_{t+1}^j} q_x(s_{t+1}^j) x(\zeta_{t+1}^j) d\zeta_{t+1}^j \le y_t^j + b^\ell(s_t^j) + x(\zeta_t^j)
\end{align*}
\item An equilibrium is an allocation is $x_j$ and prices $\{q_b^\ell(s_{t+1}^j\}_{\ell, t}$ and $\{q_x(\zeta_{t+1}^j\}_t$ such that
\begin{itemize}
\item HH solves HH problem given prices
\item Asset markets clear
\begin{align*}
\int b^\ell(s_{t+1}^j) d \Phi_t(i) &= 0 \;\;\; \forall s_{t+1}^j, \ell\\
\int x(\zeta_{t+1}^j) d \Phi_t(i) &= 0 \;\;\; \forall \zeta_{t+1}^j
\end{align*}
\end{itemize}
\item Steps: (1) formulate auxiliary problem (island planner problem) and (2) verify that this auxiliary problem satisfy the conditions of an competitive equilibrium
\end{itemize}

\subsection*{Island planner problem (auxiliary problem)}

\begin{itemize}
\item For every island $\ell$, the island planner solves static problem
\begin{align*}
\max_{\{c, h\}_{\varepsilon^j_t}} & \int u^j(c_t^j, h_t^j) d \Phi_t (\varepsilon_t)\\
\text{s.t. } & \int c(\varepsilon_t^j) d \Phi = \int z(\varepsilon_t^j) h (\varepsilon_t^j) d \Phi 
\end{align*}
\item Attach $\lambda$ on the RC
\item FOC  wrt $c(\varepsilon_t^j)$:
$$
c(\varepsilon_t^j)^{-1} = \lambda 
$$
Thus, there is perfect insurance on an island
\item FOC wrt $h(\varepsilon_t^j)$:
\begin{align*}
(\exp(B_j))^{\frac{1}{\eta} + 1} h_j^{1/\eta} = z(\varepsilon_t^j) \lambda
\end{align*}
Thus, hours change with $\varepsilon_t^j$. High $\varepsilon_t^j$ work more.
\item The RC and consumption FOC imply
\begin{align*}
\frac{1}{\lambda} 
&= \int z^{1 + \eta} \lambda^\eta \exp(-(1+\eta)B) d \Phi\\
&= \lambda^\eta \exp(-(1+\eta) B) \exp((1+\eta)\alpha) \int \exp((1+\eta)\varepsilon) d \Phi\\
\implies
1 &= \lambda \exp(-B) \exp(\alpha) \Bigg[\int \exp((1 + \eta)\varepsilon)d\Phi \Bigg]^{\frac{1}{1+\eta}}\\
\implies
c &= \exp(\alpha - B) \underbrace{\Bigg[\int \exp((1 + \eta)\varepsilon)d\Phi \Bigg]^{\frac{1}{1+\eta}}}_{\equiv \mathcal{C}}\\
\exp((1+\eta)B)h(\varepsilon) &= [\exp(\alpha + \varepsilon - \alpha + B)]^\eta / \mathcal{C}^\eta\\
h(\varepsilon) &= \frac{\varepsilon \eta}{\mathcal{C}^\eta \exp(B)}
\end{align*}
\item Comparative statistics:$\uparrow \varepsilon \implies \uparrow h(\varepsilon)$ and $\uparrow B \implies \downarrow h(\varepsilon)$
\item $\alpha$ doesn't show up in $h$ (kind of weird). Why? Income and substitution effects perfectly cancel out.
\begin{align*}
q_\ell(\varepsilon_{t+1}^j) 
&= \frac{u_c(c_{t+1}(\varepsilon_{t+1}^j))}{u_c(c_{t}(\varepsilon_{t}^j))} \beta \delta \underbrace{\pi_t(\varepsilon_{t+1})}_{\text{Doesn't vary by islands}}\\
&= \frac{c_t^j(\varepsilon_t^j)}{c_{t+1}^j(\varepsilon_{t+1}^j)} \beta \delta \pi_t(\varepsilon_{t+j})\\
&= \exp(\alpha - B -\alpha + B) \frac{\mathcal{C}_t}{\mathcal{C}_{t+1}} \beta \delta \pi_t(\varepsilon_{t+1})\\
&= \frac{\mathcal{C}_t}{\mathcal{C}_{t+1}} \beta \delta \pi_t(\varepsilon_{t+1})
\end{align*}
Price is the same across islands.
\item Risk-free asset price (let $\mathcal{E}_{t+1}$ be the support of $\varepsilon_{t+1}^j$):
\begin{align*}
q_\ell(\mathcal{E}_{t+1}) 
&= \int \frac{u_c^j(c_{t+1}^j(\varepsilon_{t+1}^j))}{u_c^j(c_{t}^j(\varepsilon_{t}^j))} \beta \delta d \Phi_j^\varepsilon\\
&= \beta \delta \frac{\mathcal{C}_t}{\mathcal{C}_{t+1}}
\end{align*}

\subsection*{Equilibrium Characterization}
\item From the equilibrium conditions, we can map data on wages, hours, and consumption $(\hat w_i, \hat h_i, \hat c_i)$ to structural parameters $(\alpha_i, \varepsilon_i, B_i)$:
\begin{align*}
\underbrace{\hat w_i}_{\text{data}} &= \underbrace{\exp(\alpha_i + \varepsilon_i)}_{\text{fn of structural  parameter}}\\
\underbrace{\hat h_i}_{\text{data}} &= \underbrace{\frac{\exp(\eta \varepsilon_i)}{\mathcal{C}^\eta \exp(B_i)} }_{\text{fn of structural  parameter}}\\
\underbrace{\hat c_i}_{\text{data}} &= \underbrace{\exp(\alpha_i - B_i) \mathcal{C}}_{\text{fn of structural  parameter}}
\end{align*}
\item We can rewrite structural parameters $(\alpha_i, \varepsilon_i, B_i)$ as functions of data $(\hat w_i, \hat h_i, \hat c_i)$:
\begin{align}
\frac{\hat c_i\hat w_i^\eta}{\hat h_i} &= \frac{\exp(\alpha_i - B_i) \exp(\eta(\alpha_i + \varepsilon_i)
)}{\exp(-B_i)\exp(\eta \varepsilon_i)} \nonumber \\
&= \exp((1+\eta)\alpha_i) \nonumber \\
\implies
\underbrace{\frac{1}{1+\eta} \log\Bigg[\frac{\hat c_i \hat w_i^\eta}{\hat h_i}\Bigg]}_{\text{fn of data}} &= \underbrace{\alpha_i}_{\text{structural parameter}} \\
\log (\hat w_i) - \alpha_i &= \varepsilon_i \nonumber \\
\implies
\underbrace{\log (\hat w_i) - \frac{1}{1+\eta} \log\Bigg[\frac{\hat c_i \hat w_i^\eta}{\hat h_i}\Bigg]}_{\text{fn of data}} &= \underbrace{\varepsilon_i}_{\text{structural parameter}} \\
\log(\hat c_i) &= \alpha_i - B_i + \log(\mathcal{C}) \nonumber \\
\implies
\underbrace{\frac{1}{1+\eta} \log\Bigg[\frac{\hat c_i \hat w_i^\eta}{\hat h_i}\Bigg] + \log(\mathcal{C}) - \log(\hat c_i)}_{\text{fn of data}}  &=  \underbrace{B_i}_{\text{structural parameter}} \label{B_mapping}
\end{align}
\item We can use common estimates of the Frisch elasticity of labor supply $\eta$ from the literature
\item (\ref{B_mapping}) Recall that 
\begin{align*}
\mathcal{C} = \Bigg[\int \exp((1 + \eta)\varepsilon)d\Phi \Bigg]^{\frac{1}{1+\eta}}
\end{align*}
Which can be estimated as
\begin{align*}
\mathcal{C} 
&\approx \Bigg[ \frac{1}{n} \sum \exp((1 + \eta)\varepsilon_i) \Bigg]^{\frac{1}{1+\eta}}\\
&= \Bigg[ \frac{1}{n} \sum \exp\Bigg((1 + \eta) \Bigg( \log (\hat w_i) - \frac{1}{1+\eta} \log\Bigg[\frac{\hat c_i \hat w_i^\eta}{\hat h_i}\Bigg] \Bigg) \Bigg) \Bigg]^{\frac{1}{1+\eta}}
\end{align*}


\end{itemize}

\end{enumerate}

\end{document}

