---
title: "ECON 712 - PS 3"
author: "Alex von Hafften^[I worked on this problem set with a study group of Michael Nattinger, Andrew Smith, and Ryan Mather. I also discussed problems with Emily Case, Sarah Bass, and Danny Edgel.]"
date: "9/24/2020"
output: pdf_document
header-includes:
- \newcommand{\N}{\mathbb{N}}
- \newcommand{\Z}{\mathbb{Z}}
- \newcommand{\R}{\mathbb{R}}
- \newcommand{\Q}{\mathbb{Q}}
- \usepackage{bm}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. Consider the following overlapping generations problem. In each period $t = 1, 2, 3, ...$ a new generation of 2 period lived households are born.  Each generation has a unitary mass.  There is a unit measure of initial old who are endowed with $\bar{M} > 0$ units of fiat money. Each generation is endowed with $w_1$ in youth and $w_2$ in old age of non-storable consumption goods where $w_1 > w_2$.  There is no commitment technology to enforce trades. The utility function of a household of generation $t \ge 1$ is $U(c_t^t, c_{t+1}^t) = \ln(c_t^t) + \ln(c_{t+1}^t)$ where $(c_t^t, c_{t+1}^t)$ is consumption of a household of generation $t$ in youth (i.e., in period $t$) and old age (i.e., in period $t+1$).  The preference of the initial old are given by $U(c_1^0) = \ln(c_1^0)$ where $c_1^0$ is consumption by a household of the initial old.

(a) State and solve the planner problem.

In any period $t$, the social planner weights agents alive equally and optimally allocates resources between them given preferences and technologies:

\begin{align*}
\max_{(c_t^t, c_t^{t-1}) \in \R^2_+} & \ln(c_t^t) + \ln(c_{t}^{t-1})\\
\text{s.t. } c_t^t + c_t^{t-1} &\le w_1 + w_2
\end{align*}

Since utility is strictly increasing in consumption, we know that the maximum will occur at $c_t^t + c_t^{t-1} = w_1 + w_2 \implies c_t^{t-1} = w_1 + w_2 - c_t^t$. Thus, we can write the social planner's problem as an unconstrained maximization problem:

$$
\max_{c_t^t \in \R_+} \ln(c_t^t) + \ln(w_1 + w_2 - c_t^t)
$$

Setting the first order condition to zero:

$$
\frac{1}{c_t^t} - \frac{1}{w_1 + w_2 - c_t^t} = 0 \implies c_t^t  = \frac{w_1 + w_2}{2}
$$

Plugging the solution into the equation for the consumption of old agents:

$$
c_t^{t-1} = w_1 + w_2 - \frac{w_1 + w_2}{2} = \frac{w_1 + w_2}{2}
$$

Thus, the solution to the social planner's problem is the allocation $\Big\{\Big(\frac{w_1 + w_2}{2}, \frac{w_1 + w_2}{2} \Big)\Big\}_{\forall t}$.

\pagebreak

(b) State the representative household's problem in period $t \ge 0$. Try to write the budget constraints in real terms.

I break the household problem into the problem facing an initial old agent and the problem facing agents born in period $t > 0$.  Let $p_t$ be the number of dollar per unit of consumption good in period $t$.  Define $M_{t+1}^t \in \R_+$ as the monetary holdings of the generation born in $t$ between periods $t$ and $t+1$.

The problem facing the initial old agents is:

\begin{align*}
\max_{c_1^0 \in \R_+} & \ln(c_1^0) \\
\text{s.t. } c_1^0 & \le w_2 + \frac{\bar{M}}{p_1}
\end{align*}

The problem facing agents born in period $t > 0$ is:

\begin{align*}
\max_{(c_t^t, c_{t+1}^t, M_{t+1}^t) \in \R^3_+} & \ln(c_t^t) + \ln(c_{t+1}^{t})\\
\text{s.t. } c_t^t & \le w_1 - \frac{M_{t+1}^t}{p_t}\\ 
             c_{t+1}^t & \le w_2 + \frac{M_{t+1}^t}{p_{t+1}} 
\end{align*}

(c) Define and solve for an autarkic equilibrium, assuming that it exists.

In an autarky, money has no value. Thus, agents do not forego consumption to hold money, or $M_{t+1}^t=0$ $\forall t$. Thus, in period 1, young agents do not trade with old agents because they believe that money will not be valued in period 2. Thus, the stock of fiat currency disappears with the death of the initial old agents.  

In an autarky, the problem facing the initial old agents collapses to:

\begin{align*}
\max_{c_1^0 \in \R_+} & \ln(c_1^0) \\
\text{s.t. } c_1^0 & \le w_2
\end{align*}

Trivially, $c_1^0 = w_2$.

In an autarky, the problem facing agents born in period $t > 0$ collapses to:

\begin{align*}
\max_{(c_t^t, c_{t+1}^t) \in \R^2_+} & \ln(c_t^t) + \ln(c_{t+1}^{t})\\
\text{s.t. } c_t^t & \le w_1\\ 
             c_{t+1}^t & \le w_2
\end{align*}

So, $(c_t^t, c_{t+1}^{t})=(w_1, w_2)$.  Thus, the autarkic equilibrium is the allocation $\{(w_1, w_2)\}_{\forall t}$.

\pagebreak

(d) Define and solve for a competitive equilibrium assuming valued money but with $w_2=0$.

A competitive equilibrium is the allocation $\{(c_t^t, c_t^{t-1}\}_{\forall t}$ and prices $\{p_t\}_{\forall t}$ such that agents optimize and markets clear:

\begin{align*}
c_t^t+c_t^{t-1} &= w_1 + w_2 & \text{(Goods Market)}\\
M_{t+1}^t &= \bar{M} & \text{(Money Market)}
\end{align*}

We can rewrite the problem of agents born in period $t > 0$ with $w_2 = 0$, since utility is strictly increasing in consumption.

$$
\max_{M_{t+1}^t \in \R_+} \ln\Bigg(w_1 - \frac{M_{t+1}^t}{p_t}\Bigg) + \ln\Bigg(\frac{M_{t+1}^t}{p_{t+1}}\Bigg)
$$

Setting the first order condition to zero:

\begin{align*}
\Bigg(w_1 - \frac{M_{t+1}^t}{p_t}\Bigg)^{-1} (-p_t)^{-1} + \Bigg(\frac{M_{t+1}^t}{p_{t+1}}\Bigg)^{-1} (p_{t+1})^{-1} &= 0 
\implies M_{t+1}^t = \frac{p_t w_1}{2} \\
\end{align*}

Plugging back in for $c_t^t$ and $c_{t+1}^t$:

\begin{align*}
c_t^t &= w_1 - \frac{(p_t w_1)/2}{p_t} = \frac{w_1}{2} \\
c_{t+1}^t &= \frac{(p_t w_1)/2}{p_{t+1}} = \Bigg(\frac{p_t}{p_{t+1}}\Bigg) \frac{w_1}{2}
\end{align*}

Setting $w_2=0$ and substituting in the household's optimization conditions, the goods market clearing condition becomes:

\begin{align*}
c_t^t + c_t^{t-1} &= w_1 + 0
\implies \frac{w_1}{2} + \Bigg(\frac{p_t}{p_{t+1}}\Bigg) \frac{w_1}{2} = w_1
\implies p_t = p_{t+1}
\end{align*}

The money market condition implies:

\begin{align*}
\frac{p_t w_1}{2} &= \bar{M}
\implies
p_t = \frac{2\bar{M}}{w_1}
\end{align*}

Thus, the competitive equilibrium is the allocation $\Big\{\Big(\frac{w_1}{2}, \frac{w_1}{2} \Big)\Big\}_{\forall t}$ and prices $\Big\{\frac{2\bar{M}}{w_1}\Big\}_{\forall t}$

\pagebreak

(e) Compare the solutions to the planners problem, the autarky equilibrium and the stationary monetary competitive equilibrium with valued money, all with $w_2 = 0$.

With $w_2 = 0$,

* The solution to the planners problem is the allocation $\Big\{\Big(\frac{w_1}{2}, \frac{w_1}{2} \Big)\Big\}_{\forall t}$.
* The autarky equilibrium is the allocation $\{(w_1, 0)\}_{\forall t}$.
* The stationary monetary competitive equilibrium with valued money is the allocation $\Big\{\Big(\frac{w_1}{2}, \frac{w_1}{2} \Big)\Big\}_{\forall t}$ and prices $\Big\{\frac{2\bar{M}}{w_1}\Big\}_{\forall t}$.

We see that the stationary monetary competitive equilibrium with valued money achieves the solution to the planners problem with agents consuming half their endowment in each period.  The autarky equilibrium results in agents consuming their entire endowment when young and nothing when old.  The autarky equilibrium is clearly worse because all agents have negative infinity utility due to consuming nothing when old.

(f) What happens to consumption, money demand and prices in a competitive equilibrium with valued money if the initial money supply is halved, i.e. $\bar{M}' = \frac{\bar{M}}{2}$. Keep the assumption that $w_2 = 0$.

In (d), we found that the consumption allocation under the competitive equilibrium with valued money does not depend on the money supply, so the consumption allocation would stay the same at $\Big\{\Big(\frac{w_1}{2}, \frac{w_1}{2} \Big)\Big\}_{\forall t}$ if the initial money supply is halved.  In contrast, prices on the other hand would also halve: 

$$\Big\{\frac{2 \bar{M}' }{w_1}\Big\}_{\forall t} =\Big\{\frac{2(\bar{M}/2)}{w_1}\Big\}_{\forall t} = \Big\{\frac{\bar{M}}{w_1}\Big\}_{\forall t} $$

Price dropping by a half would cause money demand to halve as well: $(M_{t+1}^t)' = \frac{(p_t'/2) w_1}{2} = \frac{p_t' w_1}{4}$ $\forall t$.

\pagebreak

2. Plot the trade offer curves for the following utility functions where the endowment is $(w_1, w_2)$ for goods 1 and 2, respectively.

(a) $U = 10 c_1 - 4 c_1^2 + 4 c_2 - c_2^2, (w_1, w_2) = (0, 2)$

Notice that $U$ has a global maximum in $\R$. Setting the first order conditions to zero:

\begin{align*}
\frac{dU}{dc_1} &= 10 - 8 c_1 \implies c_1^* = 5/4 \\
\frac{dU}{dc_1} &= 4 - 2 c_2 \implies c_2^* = 2 \\
\end{align*}


Set $U = \bar{u}$,

\begin{align*}
\bar{u} &= 10 c_1 - 4 c_1^2 + 4 c_2 - c_2^2 \\
\implies  0 &= (-1)c_2^2 + (4) c_2 + (10 c_1 - 4 c_1^2 - \bar{u})   \\
\implies    c_2 &= \frac{-4 \pm \sqrt{4^2-4(-1)(10 c_1 - 4 c_1^2 - \bar{u})}}{2(-1)} \\
    &= 2 \pm \sqrt{4+10c_1-4c_1^{2}-\bar{u}}
\end{align*}

```{r, echo=FALSE, warning=FALSE, fig.width=5, fig.height=5}
library(shape)

xlim <- c(0, 6)
ylim <- c(0, 6)

plot(1, type="n", xlim = xlim, ylim = ylim, xaxs="i", yaxs="i", xlab = "c_1", ylab = "c_2", main = "Indifference Curves and Budget Constraints")

c_1 <- (xlim[1]:(xlim[2]*1000))/1000
u_bar <- 1:10

for (u in u_bar) {
  y <- c(2 + sqrt(4+10*c_1-4*c_1^2-u), rev(2 - sqrt(4+10*c_1-4*c_1^2-u)))
  x <- c(c_1, rev(c_1))[is.finite(y)]
  y <- y[is.finite(y)]
  
  lines(x= c(x, x), y= c(y, y), col = "blue")
}

Arrows(x0=c(5/4, 2.5, 1/4), 
       x1=c(5/4, 2, 3/4), 
       y0=c(4.5, 2.5, 2.5), 
       y1=c(3.5, 2.5, 2.5), 
       col="blue")

points(y=c(2, 2, 1), x=c(0, 5/4, 1), pch = 19, col = "yellow", cex =2)

abline(h=2, col = "red")

segments(x0 = 0, y0 = 6,
         x1 = 0, y1 = 0, col = "red", lwd = 3)

segments(x0 = 0, y0 = 2,
         x1 = 2, y1 = 0, col = "red")

points(y=2, x=0, pch=4, col = "red", cex = 2)

points(y=2, x=5/4, pch = 8, col = "blue", cex = 2)

abline(v=0, h=0)

text("p_1/p_2 = infty", x=1, y=5.5, col = "red")
text("p_1/p_2 = 0", x=5, y=2.5, col = "red")
text("p_1/p_2 = 1", x=3.5, y=.5, col = "red")
text("Indifference Curves", x=4, y=4, col = "blue")

legend("topright",
       c("Max Utility",
         "Endowment Point",
         "Optimal Points"),
       col=c("blue", "red", "yellow"),
       pch = c(8, 4, 19))

```

We see that the trade offer curve will trace the points on the bottom of each ellipsoid tangent to the budget constraint with slopes ranging from zero to negative infinity:

\begin{align*}
\frac{d}{dc_1}\Big(2-\sqrt{4+10c_1-4c_1^{2}-\bar{u}}\Big) = \frac{p_1}{p_2}
\end{align*}

\pagebreak

(b) $U = \min\{2c_1 + c_2, c_1 + 2c_2\}, (w_1, w_2) = (1, 0)$

```{r, echo=FALSE, fig.width=5, fig.height=5}
library(shape)

plot(1, type="n", xlim = c(0, 4), ylim = c(0, 4), xaxs="i", yaxs="i", xlab = "c_1", ylab = "c_2", main = "Indifference Curves and Budget Constraints")

abline(a=0, b=1, lty=2, col="blue")

u_bars <- 1:20

for (u_bar in u_bars) {
  segments(x0=0, y0=u_bar*2, x1=u_bar/3,  y1=u_bar/3, col = "blue")
  segments(y0=0, x0=u_bar*2, y1=u_bar/3,  x1=u_bar/3, col = "blue")
}

Arrows(x0=c(1.5, 2.5), 
       x1=c(2.5, 3.5), 
       y0=c(2.5, 1.5), 
       y1=c(3.5, 2.5), 
       col="blue")

points(y=0, x=1, pch=4, col = "red", cex = 2)

abline(h=0, col = "red", lwd=3)
abline(v=1, a=1, b= -1, col = "red")



```

\pagebreak

(c) $U = \min\{2c_1 + c_2, c_1 + 2c_2\}, (w_1, w_2) = (1, 10)$

```{r, echo=FALSE, fig.width=5, fig.height=5}
plot(1, type="n", xlim = c(0, 12), ylim = c(0, 12), xaxs="i", yaxs="i", xlab = "c_1", ylab = "c_2", main = "Indifference Curves and Budget Constraints")

abline(a=0, b=1, lty=2, col="blue")

u_bars <- 1:40

for (u_bar in u_bars) {
  segments(x0=0, y0=u_bar*2, x1=u_bar/3,  y1=u_bar/3, col = "blue")
  segments(y0=0, x0=u_bar*2, y1=u_bar/3,  x1=u_bar/3, col = "blue")
  
  segments(x0=0, y0=u_bar*2, x1=u_bar,  y1=0, col = "blue")
  segments(y0=0, x0=u_bar*2, y1=u_bar,  x1=0, col = "blue")
}

Arrows(x0=c(.5, 10.5), 
       x1=c(1.5, 11.5), 
       y0=c(10.5, .5), 
       y1=c(11.5, 1.5), 
       col="blue")

points(y=10, x=1, pch=4, col = "red", cex = 2)
abline(h=10, v=1)
abline(a=11, b=-1)
abline(a=10.5, b=-1/2)

```