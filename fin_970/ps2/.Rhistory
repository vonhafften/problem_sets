library(janitor)
library(lubridate)
library(zoo)
data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQTfzNMym06q46buDYyRdjXGj3CZaParAI72Jy9xek7t6UsPOnUB4NEQdvQNm_qP4-FK9r3uFTS_6_H/pub?output=csv") %>%
clean_names() %>%
filter(!is.na(morning)) %>%
mutate(date = mdy(date))
full_data <- tibble(date = seq(min(data$date), max(data$date), by = "day")) %>%
left_join(data, by = "date") %>%
mutate(morning = na.approx(morning),
change = (morning - lag(morning))/as.numeric(date - lag(date)))
# Last Month
window <- 90
data %>%
filter(date > today()-window) %>%
ggplot() +
geom_smooth(aes(y=morning, x=date)) +
geom_point(aes(y=morning, x=date)) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 210, ymax = 252,
fill = "blue", alpha = 0) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2)
full_data %>%
filter(date > today()-window) %>%
ggplot() +
geom_smooth(aes(y=change, x=date)) +
geom_point(aes(y=change, x=date))
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 210, ymax = 252,
fill = "dodgerblue", alpha = 0.0) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2020"), xmax = mdy("12-23-2020"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2021"), xmax = mdy("05-13-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2021"), xmax = mdy("12-23-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2022"), xmax = max(data$date),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 260, col = "black",
label = "Obsese", hjust = 0) +
annotate("text", x=min(data$date), y = 230, col = "black",
label = "Overweight", hjust = 0) +
annotate("text", x=min(data$date), y = 180, col = "black",
label = "Normal", hjust = 0)
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 275, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 250, ymax = 275,
fill = "yellow", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 225, ymax = 250,
fill = "green", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 200, ymax = 225,
fill = "blue", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 295, col = "red",
label = "First Year", hjust = 0) +
annotate("text", x=min(data$date), y = 262.5, col = "orange",
label = "Pandemic", hjust = 0) +
annotate("text", x=min(data$date), y = 237.5, col = "green",
label = "Applications", hjust = 0)
full_data %>%
ggplot() +
geom_smooth(aes(y=change, x=date)) +
geom_point(aes(y=change, x=date))
starting_weight <- 290
goal_weight <- 230
current_weight <- data %>% filter(date == today()) %>% pull(morning)
print(paste("Pounds lost:", starting_weight - current_weight))
print(paste("Pounds to go:", current_weight - goal_weight))
print(paste0("Progress made: ", round((starting_weight - current_weight)/(starting_weight - goal_weight) * 100), "%"))
starting_weight <- 290
goal_weight <- 250
current_weight <- data %>% filter(date == today()) %>% pull(morning)
print(paste("Pounds lost:", starting_weight - current_weight))
print(paste("Pounds to go:", current_weight - goal_weight))
print(paste0("Progress made: ", round((starting_weight - current_weight)/(starting_weight - goal_weight) * 100), "%"))
print(paste0("Progress to go: ", round((current_weight - goal_weight)/(starting_weight - goal_weight) * 100), "%"))
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 210, ymax = 252,
fill = "dodgerblue", alpha = 0.0) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2020"), xmax = mdy("12-23-2020"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2021"), xmax = mdy("05-13-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2021"), xmax = mdy("12-23-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2022"), xmax = max(data$date),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 260, col = "black",
label = "Obsese", hjust = 0) +
annotate("text", x=min(data$date), y = 230, col = "black",
label = "Overweight", hjust = 0) +
annotate("text", x=min(data$date), y = 180, col = "black",
label = "Normal", hjust = 0)
library(tidyverse)
library(tidyverse)
library(janitor)
library(lubridate)
library(zoo)
data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQTfzNMym06q46buDYyRdjXGj3CZaParAI72Jy9xek7t6UsPOnUB4NEQdvQNm_qP4-FK9r3uFTS_6_H/pub?output=csv") %>%
clean_names() %>%
filter(!is.na(morning)) %>%
mutate(date = mdy(date))
library(tidyverse)
library(janitor)
library(lubridate)
library(zoo)
data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQTfzNMym06q46buDYyRdjXGj3CZaParAI72Jy9xek7t6UsPOnUB4NEQdvQNm_qP4-FK9r3uFTS_6_H/pub?output=csv") %>%
clean_names() %>%
filter(!is.na(morning)) %>%
mutate(date = mdy(date))
full_data <- tibble(date = seq(min(data$date), max(data$date), by = "day")) %>%
left_join(data, by = "date") %>%
mutate(morning = na.approx(morning),
change = (morning - lag(morning))/as.numeric(date - lag(date)))
# Last Month
window <- 90
data %>%
filter(date > today()-window) %>%
ggplot() +
geom_smooth(aes(y=morning, x=date)) +
geom_point(aes(y=morning, x=date)) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 210, ymax = 252,
fill = "blue", alpha = 0) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2)
full_data %>%
filter(date > today()-window) %>%
ggplot() +
geom_smooth(aes(y=change, x=date)) +
geom_point(aes(y=change, x=date))
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 210, ymax = 252,
fill = "dodgerblue", alpha = 0.0) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2020"), xmax = mdy("12-23-2020"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2021"), xmax = mdy("05-13-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2021"), xmax = mdy("12-23-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2022"), xmax = max(data$date),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 260, col = "black",
label = "Obsese", hjust = 0) +
annotate("text", x=min(data$date), y = 230, col = "black",
label = "Overweight", hjust = 0) +
annotate("text", x=min(data$date), y = 180, col = "black",
label = "Normal", hjust = 0)
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 275, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 250, ymax = 275,
fill = "yellow", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 225, ymax = 250,
fill = "green", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 200, ymax = 225,
fill = "blue", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 295, col = "red",
label = "First Year", hjust = 0) +
annotate("text", x=min(data$date), y = 262.5, col = "orange",
label = "Pandemic", hjust = 0) +
annotate("text", x=min(data$date), y = 237.5, col = "green",
label = "Applications", hjust = 0)
full_data %>%
ggplot() +
geom_smooth(aes(y=change, x=date)) +
geom_point(aes(y=change, x=date))
starting_weight <- 290
goal_weight <- 250
current_weight <- data %>% filter(date == today()) %>% pull(morning)
print(paste("Pounds lost:", starting_weight - current_weight))
print(paste("Pounds to go:", current_weight - goal_weight))
print(paste0("Progress made: ", round((starting_weight - current_weight)/(starting_weight - goal_weight) * 100), "%"))
print(paste0("Progress to go: ", round((current_weight - goal_weight)/(starting_weight - goal_weight) * 100), "%"))
data %>%
filter(date > today()-window) %>%
ggplot() +
geom_smooth(aes(y=morning, x=date)) +
geom_point(aes(y=morning, x=date)) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 210, ymax = 252,
fill = "blue", alpha = 0) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2)
full_data %>%
filter(date > today()-window) %>%
ggplot() +
geom_smooth(aes(y=change, x=date)) +
geom_point(aes(y=change, x=date))
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 210, ymax = 252,
fill = "dodgerblue", alpha = 0.0) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2020"), xmax = mdy("12-23-2020"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2021"), xmax = mdy("05-13-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2021"), xmax = mdy("12-23-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2022"), xmax = max(data$date),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 260, col = "black",
label = "Obsese", hjust = 0) +
annotate("text", x=min(data$date), y = 230, col = "black",
label = "Overweight", hjust = 0) +
annotate("text", x=min(data$date), y = 180, col = "black",
label = "Normal", hjust = 0)
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 275, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 250, ymax = 275,
fill = "yellow", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 225, ymax = 250,
fill = "green", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 200, ymax = 225,
fill = "blue", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 295, col = "red",
label = "First Year", hjust = 0) +
annotate("text", x=min(data$date), y = 262.5, col = "orange",
label = "Pandemic", hjust = 0) +
annotate("text", x=min(data$date), y = 237.5, col = "green",
label = "Applications", hjust = 0)
full_data %>%
ggplot() +
geom_smooth(aes(y=change, x=date)) +
geom_point(aes(y=change, x=date))
library(tidyverse)
library(readxl)
library(lubridate)
library(stargazer)
setwd("Documents/UW Madison/problem_sets/fin_970/ps2/")
data <- read_excel("p1_data.xlsx", skip = 1) %>%
as_tibble() %>%
filter(month(Date) == 12) %>% # reduce to annual data
transmute(date = year(Date), pd, r, delta_d) %>% # pull out variables to use below
mutate(delta_d_1 = lead(delta_d),
delta_d_2 = (lead(delta_d) + lead(delta_d, 2L))/2,
delta_d_3 = (lead(delta_d) + lead(delta_d, 2L) + lead(delta_d, 3L))/3,
delta_d_4 = (lead(delta_d) + lead(delta_d, 2L) + lead(delta_d, 3L) + lead(delta_d, 4L))/4,
delta_d_5 = (lead(delta_d) + lead(delta_d, 2L) + lead(delta_d, 3L) + lead(delta_d, 4L) + lead(delta_d, 5L))/5,
r_1 = lead(r),
r_2 = (lead(r) + lead(r, 2L))/2,
r_3 = (lead(r) + lead(r, 2L) + lead(r, 3L))/3,
r_4 = (lead(r) + lead(r, 2L) + lead(r, 3L) + lead(r, 4L))/4,
r_5 = (lead(r) + lead(r, 2L) + lead(r, 3L) + lead(r, 4L) + lead(r, 5L))/5)
# dividend regressions
delta_d_1_lm <- lm(delta_d_1 ~ pd, data=data)
delta_d_2_lm <- lm(delta_d_2 ~ pd, data=data)
delta_d_3_lm <- lm(delta_d_3 ~ pd, data=data)
delta_d_4_lm <- lm(delta_d_4 ~ pd, data=data)
delta_d_5_lm <- lm(delta_d_5 ~ pd, data=data)
# return regressions
r_1_lm <- lm(r_1 ~ pd, data=data)
r_2_lm <- lm(r_2 ~ pd, data=data)
r_3_lm <- lm(r_3 ~ pd, data=data)
r_4_lm <- lm(r_4 ~ pd, data=data)
r_5_lm <- lm(r_5 ~ pd, data=data)
sink("p1_delta_d_table.tex")
stargazer(delta_d_1_lm, delta_d_2_lm, delta_d_3_lm, delta_d_4_lm, delta_d_5_lm,
omit.stat = c("f", "ser", "adj.rsq"),
title = "Dividends")
sink()
sink("p1_r_table.tex")
stargazer(r_1_lm, r_2_lm, r_3_lm, r_4_lm, r_5_lm,
omit.stat = c("f", "ser", "adj.rsq"),
title = "Market Returns")
sink()
mean(data$pd)
starting_weight <- 290
library(tidyverse)
library(janitor)
library(lubridate)
library(zoo)
data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQTfzNMym06q46buDYyRdjXGj3CZaParAI72Jy9xek7t6UsPOnUB4NEQdvQNm_qP4-FK9r3uFTS_6_H/pub?output=csv") %>%
clean_names() %>%
filter(!is.na(morning)) %>%
mutate(date = mdy(date))
full_data <- tibble(date = seq(min(data$date), max(data$date), by = "day")) %>%
left_join(data, by = "date") %>%
mutate(morning = na.approx(morning),
change = (morning - lag(morning))/as.numeric(date - lag(date)))
# Last Month
window <- 90
data %>%
filter(date > today()-window) %>%
ggplot() +
geom_smooth(aes(y=morning, x=date)) +
geom_point(aes(y=morning, x=date)) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 210, ymax = 252,
fill = "blue", alpha = 0) +
annotate("rect",
xmin = today()-window, xmax = today(),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2)
full_data %>%
filter(date > today()-window) %>%
ggplot() +
geom_smooth(aes(y=change, x=date)) +
geom_point(aes(y=change, x=date))
# Full plot - BMI
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 252, ymax = 300,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 210, ymax = 252,
fill = "dodgerblue", alpha = 0.0) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 156, ymax = 210,
fill = "blue", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2020"), xmax = mdy("12-23-2020"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2021"), xmax = mdy("05-13-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("09-08-2021"), xmax = mdy("12-23-2021"),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = mdy("01-22-2022"), xmax = max(data$date),
ymin = 150, ymax = 300,
fill = "red", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 260, col = "black",
label = "Obsese", hjust = 0) +
annotate("text", x=min(data$date), y = 230, col = "black",
label = "Overweight", hjust = 0) +
annotate("text", x=min(data$date), y = 180, col = "black",
label = "Normal", hjust = 0)
# Full plot - Stresses
data %>%
ggplot() +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 275, ymax = 300,
fill = "red", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 250, ymax = 275,
fill = "yellow", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 225, ymax = 250,
fill = "green", alpha = 0.2) +
annotate("rect",
xmin = min(data$date), xmax = max(data$date),
ymin = 200, ymax = 225,
fill = "blue", alpha = 0.2) +
geom_point(aes(y=morning, x=date)) +
annotate("text", x=min(data$date), y = 295, col = "red",
label = "First Year", hjust = 0) +
annotate("text", x=min(data$date), y = 262.5, col = "orange",
label = "Pandemic", hjust = 0) +
annotate("text", x=min(data$date), y = 237.5, col = "green",
label = "Applications", hjust = 0)
full_data %>%
ggplot() +
geom_smooth(aes(y=change, x=date)) +
geom_point(aes(y=change, x=date))
# Current status
starting_weight <- 290
goal_weight <- 250
current_weight <- data %>% filter(date == today()) %>% pull(morning)
print(paste("Pounds lost:", starting_weight - current_weight))
print(paste("Pounds to go:", current_weight - goal_weight))
print(paste0("Progress made: ", round((starting_weight - current_weight)/(starting_weight - goal_weight) * 100), "%"))
print(paste0("Progress to go: ", round((current_weight - goal_weight)/(starting_weight - goal_weight) * 100), "%"))
