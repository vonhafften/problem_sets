\documentclass{article}
\usepackage{amsmath,amsthm,amssymb,amsfonts}
\usepackage{setspace,enumitem}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{natbib}
\usepackage{afterpage}
\usepackage{xcolor}
\usepackage{etoolbox}
\usepackage{booktabs}
\usepackage{pdfpages}
\usepackage{multicol}
\usepackage{geometry}
\usepackage{accents}
\usepackage{bbm}
\usepackage{placeins}
\usepackage{verbatim}
\hypersetup{
	colorlinks,
	linkcolor={blue!90!black},
	citecolor={red!90!black},
	urlcolor={blue!90!black}
}

\newtheorem{theorem}{Theorem}
\newtheorem{assumption}{Assumption}
\newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}
\setlength{\parindent}{0cm}
\geometry{margin = 1in}

\newcommand{\R}{\mathbb{R}}
\newcommand{\ubar}[1]{\underaccent{\bar}{#1}}
\newcommand{\Int}{\text{Int}}
\newcommand{\xbf}{\mathbf{x}}
\newcommand{\Abf}{\mathbf{A}}
\newcommand{\Bbf}{\mathbf{B}}
\newcommand{\Gbf}{\mathbf{G}}
\newcommand{\bbf}{\mathbf{b}}
\newcommand{\one}{\mathbbm{1}}

\newtoggle{extended}
\settoggle{extended}{false}

\title{FIN 970: Final Exam}
\author{Alex von Hafften}

\begin{document}

\maketitle

\section{Problem 1a}

\begin{enumerate}

\item Using SDF approach:

Conjecture $P_t^n = \exp(A_n + B_n'X_t)$. Proof by induction.

For $n=0$,

\begin{align*}
P_t^1 
&= 
E_t[M_{t+1} \cdot 1]\\
\implies\exp(A_1 + B_1'X_t) 
&= 
E_t \Bigg[ \exp \Bigg(-\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t - \lambda_t' \varepsilon_{t+1}\Bigg) \Bigg]\\
\implies E_t \Bigg[ -\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t - \lambda_t' \varepsilon_{t+1} \Bigg]
&= -\delta_0 -\delta_1 X_t - \frac{1}{2}\lambda_t'\lambda_t \\
Var_t\Bigg[ -\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t - \lambda_t' \varepsilon_{t+1} \Bigg]
&= \lambda_t'\lambda_t\\
\implies
\exp(A_1 + B_1'X_t) 
&= 
\exp \Bigg(-\delta_0 - \delta_1 X_t\Bigg) \\
\implies
\begin{cases}
A_1 = -\delta_0\\
B_1 = -\delta_1'
\end{cases}
\end{align*}

For some $n$, the Euler equation holds:

\begin{align*}
P_t^n &= E_t[M_{t+1} P_{t+1}^{n-1}]\\
\exp(A_{n} + B_{n}'X_{t})
&= E_t \Bigg[\exp \Bigg(-r_t - \frac{1}{2} \lambda_t'\lambda_t - \lambda_t' \varepsilon_{t+1}\Bigg) \exp(A_{n-1} + B_{n-1}'X_{t+1})\Bigg]\\
&= E_t \Bigg[\exp \Bigg(-\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t - \lambda_t' \varepsilon_{t+1} + A_{n-1} + B_{n-1}'(\mu + \Phi X_t + \Sigma \varepsilon_{t+1} ) \Bigg)\Bigg]\\
&= E_t \Bigg[\exp \Bigg(-\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t  + A_{n-1} + B_{n-1}'\mu + B_{n-1}'\Phi X_t + [B_{n-1}'\Sigma - \lambda_t'] \varepsilon_{t+1}  \Bigg)\Bigg]
\end{align*}

\begin{align*}
& E_t \Bigg[-\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t  + A_{n-1} + B_{n-1}'\mu + B_{n-1}'\Phi X_t + [B_{n-1}'\Sigma - \lambda_t'] \varepsilon_{t+1}  \Bigg] \\
&=  -\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t  + A_{n-1} + B_{n-1}'\mu + B_{n-1}'\Phi X_t\\
& Var_t\Bigg[-\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t  + A_{n-1} + B_{n-1}'\mu + B_{n-1}'\Phi X_t + [B_{n-1}'\Sigma - \lambda_t'] \varepsilon_{t+1}  \Bigg] \\
&= [B_{n-1}'\Sigma - \lambda_t'][B_{n-1}'\Sigma - \lambda_t']'\\
&= B_{n-1}'\Sigma \Sigma' B_{n-1} + \lambda_t' \lambda_t - 2 B_{n-1}'\Sigma \lambda_t
\end{align*}

\begin{align*}
\exp(A_{n} + B_{n}'X_{t})
&= \exp\Bigg(-\delta_0 - \delta_1 X_t - \frac{1}{2} \lambda_t'\lambda_t  + A_{n-1} + B_{n-1}'\mu + B_{n-1}'\Phi X_t \\&+ \frac{1}{2} B_{n-1}'\Sigma \Sigma' B_{n-1} + \frac{1}{2}\lambda_t' \lambda_t - B_n'\Sigma (\lambda_0 + \lambda_1 X_t) \Bigg)\\
&= \exp\Bigg(-\delta_0   + A_{n-1} + B_{n-1}'\mu - B_{n-1}'\Sigma \lambda_0 + \frac{1}{2} B_{n-1}'\Sigma \Sigma' B_{n-1}+ (- \delta_1  + B_{n-1}'\Phi - B_{n-1}'\Sigma \lambda_1 )X_t  ) \Bigg)\\
\implies
&
\begin{cases}
A_n = - \delta_0 + A_{n-1} + B_{n-1}'(\mu - \Sigma \lambda_0) + \frac{1}{2} B_{n-1}'\Sigma \Sigma' B_{n-1}\\
B_n = - \delta_1  + (\Phi - \Sigma \lambda_1)' B_{n-1}
\end{cases}
\end{align*}

\item Conjecture $P_t^n = \exp(C_n + D_n'X_t)$. Proof by induction.

For $n=0$,

\begin{align*}
P_t^1 
&= 
e^{-r_t}E_t^Q[1]\\
\exp(C_1 + D_1'X_t) 
&= 
\exp (-\delta_0 - \delta_1 X_t) \\
\implies&
\begin{cases}
C_1 = -\delta_0\\
D_1 = -\delta_1'
\end{cases}
\end{align*}

For some $n$, the Euler equation holds:

\begin{align*}
P_t^n 
&= e^{-r_t} E_t^Q [P_{t+1}^{n-1}]\\
\exp(C_n + D_n'X_t)
&= e^{-r_t} E_t^Q [\exp(C_{n-1} + D_{n-1}'X_{t+1})]\\
&= e^{-r_t} E_t^Q [\exp(C_{n-1} + D_{n-1}'(\mu^Q + \Phi^Q X_t + \Sigma \varepsilon_{t+1}^Q))]\\
&= e^{-r_t} E_t^Q [\exp(C_{n-1} + D_{n-1}'\mu^Q + D_{n-1}'\Phi^Q X_t + D_{n-1}'\Sigma \varepsilon_{t+1}^Q)]
\end{align*}

\begin{align*}
E_t^Q[C_{n-1} + D_{n-1}'\mu^Q + D_{n-1}'\Phi^Q X_t + D_{n-1}'\Sigma \varepsilon_{t+1}^Q] 
&= E_t[C_{n-1} + D_{n-1}'\mu^Q + D_{n-1}'\Phi^Q X_t]\\
Var_t^Q [C_{n-1} + D_{n-1}'\mu^Q + D_{n-1}'\Phi^Q X_t + D_{n-1}'\Sigma \varepsilon_{t+1}^Q]
&= D'_{n-1} \Sigma \Sigma' D_{n-1}
\end{align*}

\begin{align*}
\exp(C_n + D_n'X_t)
&=  \exp \Bigg(-\delta_0 - \delta_1 X_t + C_{n-1} + D_{n-1}'\mu^Q + D_{n-1}'\Phi^Q X_t + \frac{1}{2} D'_{n-1} \Sigma \Sigma' D_{n-1} \Bigg)\\
& \begin{cases}
C_n = -\delta_0  + C_{n-1} + D_{n-1}'\mu^Q  + \frac{1}{2} D'_{n-1} \Sigma \Sigma' D_{n-1}\\
D_n = - \delta_1' + \Phi^{Q'} D_{n-1}
\end{cases}
\end{align*}

\item Show that this is a one-to-one mapping between the risk-neutral parameters $(\mu^Q,  \Phi^Q)$ and the market prices of risk $(\lambda_0, \lambda_1)$.

\bigskip

Clearly, parts (1) and (2) are equivalent iff

\begin{align*}
\mu^Q &= \mu - \Sigma \lambda_0  \iff \lambda_0 = \Sigma^{-1}(\mu - \mu^Q)\\
\Phi^Q &= \Phi - \Sigma \lambda_1 \iff \lambda_1 = \Sigma^{-1}(\Phi - \Phi^Q)
\end{align*}

with $A_n = C_n$ and $B_n = D_n$. Thus, we can go back and forth from SDF to risk-neutral densities to price bonds of any maturity.

\end{enumerate}


\end{document}