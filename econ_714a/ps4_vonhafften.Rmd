---
title: "ECON 714A - Problem Set 4"
author: "Alex von Hafften^[I worked on this problem set with a study group of Michael Nattinger, Andrew Smith, and Ryan Mather. I also discussed problems with Sarah Bass, Emily Case, Danny Edgel, and Katherine Kwok.]"
date: "2/22/2021"
output: pdf_document
header-includes:
- \newcommand{\N}{\mathbb{N}}
- \newcommand{\Z}{\mathbb{Z}}
- \newcommand{\R}{\mathbb{R}}
- \newcommand{\Q}{\mathbb{Q}}
- \newcommand{\Lf}{\mathcal{L}}
- \newcommand{\graph}{\text{graph}}
- \usepackage{bm}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

This problem asks you to solve a model of oligopolistic competition from Atkeson and Burstein (AER 2008), which extends the Dixit-Stiglitz setup and is widely used to analyze heterogeneous markups and incomplete pass-through.

Consider a static model with a continuum of sectors $k\in[0,1]$ and $i= 1,..N_k$ firms in sector $k$, each producing a unique variety of the good. Households supply inelastically one unit of labor and have nested-CES preferences:

$$
C = \Bigg( \int C_k^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{\rho}{\rho - 1}}, 
C_k = \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}}, 
\theta > \rho \ge 1.
$$

Production function of firm $i$ in sector $k$ is given by $Y_{ik} = A_{ik} L_{ik}$.

1. Solve household cost minimization problem for the optimal demand $C_{ik}$, the sectoral price index $P_k$, and the aggregate price index $P$ as functions of producers’ prices.

Notice that labor is inelastically supplied.  The household cost minization problem is:

$$
\min_{\{C_{ik}\}}
\int \sum_{i=1}^{N_k} P_{ik} C_{ik} dk
$$
$$
\text{s.t. }
C = \Bigg( \int C_k^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{\rho}{\rho - 1}} \\
$$
$$
\text{and }
C_k = \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}}
$$

Define the legrange multiplers with $P$ and $P_k$:

$$
\Lf 
= \int \sum_{i=1}^{N_k} P_{ik} C_{ik} dk +
P \Bigg[C - \Bigg( \int C_k^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{\rho}{\rho - 1}}\Bigg] +
\int P_k  \Bigg[C_k - \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}} \Bigg] dk
$$

\pagebreak

FOC [$C_{k}$]:

\begin{align*}
P_{k} &= P \frac{\rho}{\rho - 1}\Bigg( \int C_{k}^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{1}{\rho - 1}} \frac{\rho - 1}{\rho}C_{k}^{\frac{- 1}{\rho}} \\
\implies
P_{k} &= P\Bigg( \int C_{k}^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{1}{\rho - 1}}  C_{k}^{\frac{- 1}{\rho}} \\
\implies
P_{k} &= P C^{\frac{1}{\rho}}  C_{k}^{\frac{- 1}{\rho}} \\
\implies
C_{k} &= \Bigg( \frac{P_{k}}{P} \Bigg)^{-\rho} C
\end{align*}

Substituting into the constraint, we get the aggregate price index and aggregate consumption in terms of the sectoral price indexes:

\begin{align*}
C &= \Bigg( \int \Bigg(\Bigg( \frac{P_{k}}{P} \Bigg)^{-\rho} C\Bigg)^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{\rho}{\rho - 1}}\\
\implies
1 &= \Bigg( \int \Bigg( \frac{P_{k}}{P} \Bigg)^{1-\rho} dk \Bigg)^{\frac{\rho}{\rho - 1}}\\
\implies
1 &= P^{-\rho}\Bigg( \int P_k ^{1-\rho} dk \Bigg)^{\frac{\rho}{\rho - 1}}\\
\implies
P &= \Bigg(\int P_k^{1-\rho} dk \Bigg)^{\frac{1}{1-\rho}} \\
\implies 
C_{k} &= \Bigg( \frac{P_{k}}{(\int P_k^{1-\rho} dk )^{\frac{1}{1-\rho}}} \Bigg)^{-\rho} C
\end{align*}

We can rewrite the legrangian as:

$$
\Lf 
= \int \sum_{i=1}^{N_k} P_{ik} C_{ik} dk +
P \Bigg[C - \Bigg( \int \Bigg( \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}} \Bigg)^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{\rho}{\rho - 1}}\Bigg] +
\int P_k  \Bigg[C_k - \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}} \Bigg] dk
$$

\pagebreak

FOC [$C_{ik}$]:

\begin{align*}
P_{ik} &=
P \frac{\rho}{\rho - 1}\Bigg( \int \Bigg( \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}} \Bigg)^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{\rho}{\rho - 1} - 1}
\frac{\rho - 1}{\rho}\Bigg( \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}} \Bigg)^{\frac{\rho - 1}{\rho}-1} \\
&\times  \frac{\theta}{\theta - 1} \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}-1} 
\frac{\theta - 1}{\theta}C_{ik}^{\frac{\theta - 1}{\theta}-1} +
P_k  \frac{\theta}{\theta - 1} \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}-1} 
\frac{\theta - 1}{\theta} C_{ik}^{\frac{\theta - 1}{\theta}-1}\\
\implies
P_{ik} &=
P \Bigg( \int C_k^{\frac{\rho - 1}{\rho}} dk \Bigg)^{\frac{\rho}{\rho - 1}\frac{1}{\rho}}
\Bigg( C_k \Bigg)^{\frac{- 1}{\rho}}
\Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}\frac{1}{\theta}} 
C_{ik}^{\frac{- 1}{\theta}}
+
P_k  \Bigg( \sum_{i=1}^{N_k} C_{ik}^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}\frac{1}{\theta}} 
C_{ik}^{\frac{- 1}{\theta}}\\
\implies
P_{ik} &=
P C^{\frac{1}{\rho}}
C_k^{\frac{- 1}{\rho}}
C_k ^{\frac{1}{\theta}} 
C_{ik}^{\frac{- 1}{\theta}}
+
P_k  C_k^{\frac{1}{\theta}} 
C_{ik}^{\frac{- 1}{\theta}}\\
\implies
P_{ik} &=
C_{ik}^{\frac{- 1}{\theta}}
C_k^{\frac{1}{\theta}}
(P C^{\frac{1}{\rho}}
C_k^{- \frac{1}{\rho}}
+
P_k  )\\
\implies
C_{ik} &=
\Bigg(
\frac{P_{ik}}
{P (\frac{C_k}{C})^{- \frac{1}{\rho}}+P_k}
\Bigg)^{-\theta} C_k
\end{align*}

Substituting in the FOC based on $C_k$:

$$
C_{ik} 
=
\Bigg(
\frac{P_{ik}}
{P (\frac{( \frac{P_{k}}{P} )^{-\rho} C}{C})^{- \frac{1}{\rho}}+P_k}
\Bigg)^{-\theta} C_k \\
\implies 
C_{ik} =
\Bigg(
\frac{P_{ik}}
{2P_k}
\Bigg)^{-\theta} C_k
$$

Substituting into the constraint:

\begin{align*}
C_k &= \Bigg( \sum_{i=1}^{N_k} \Bigg( \Bigg(
\frac{P_{ik}}
{2P_k}
\Bigg)^{-\theta} C_k\Bigg)^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}} \\
\implies
1 &= \Bigg( \sum_{i=1}^{N_k} \Bigg( \Bigg(
\frac{P_{ik}}
{2P_k}
\Bigg)^{-\theta} \Bigg)^{\frac{\theta - 1}{\theta}} \Bigg)^{\frac{\theta}{\theta - 1}} \\
\implies
(2P_k)^{1-\theta} &=  \sum_{i=1}^{N_k} \Bigg(
P_{ik}
\Bigg)^{1-\theta}  \\
\implies
P_k &= \frac{1}{2}\Bigg( \sum_{i=1}^{N_k}
P_{ik}^{1-\theta} \Bigg)^{\frac{1}{1-\theta}}
\end{align*}

2. Assume that firms compete a la Bertrand, i.e. choose $P_{ik}$ taking the prices of other firms in a sector $P_{jk}, j\neq i$ as given. Derive demand elasticity for a given firm and the optimal price.

...

3. Prove that other things equal, firms with higher $A_{ik}$ set higher markups.

...

4. Assume that $\rho=1 , \theta= 5,N_k= 20, and \log A_{ik} \sim i.i.d. N(0,1)$. Solve the model numerically by approximating the number of sectors with $K= 100,000$. You will need an efficient algorithm to compute a sectoral equilibrium (search for a fixed point, do not use “solve”) nested in a general equilibrium loop solving for real wages.

...

5. Compute the aggregate output $C$ of the economy and compare it to the first-best value.

...

6. Bonus task: Does the sectoral equilibrium converge to the one under Betrand competition with homogeneous goods in the limit $\infty \to \infty$?

...

