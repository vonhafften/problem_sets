data = sample_25_17)
probit_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"),
data = sample_25_17)
coeftest(probit, vcov. = vcovHC, type = "HC1")
margins_summary(probit) %>% kable(digits = 4)
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(age_2 = age^2,
age_3 = age^3,
age_4 = age^4,,
y_1 = predict(probit_1, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_2 = predict(probit_2, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_3 = predict(probit_3, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_4 = predict(probit_4, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"))
sample_25_17 %>%
group_by(age) %>%
summarise(y = mean(y)) %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x) +
geom_line(data = prediction, aes(x = age, y=y_1), color = "red")+
geom_line(data = prediction, aes(x = age, y=y_2), color = "red")+
geom_line(data = prediction, aes(x = age, y=y_3), color = "red")+
geom_line(data = prediction, aes(x = age, y=y_4), color = "red")
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(age_2 = age^2,
age_3 = age^3,
age_4 = age^4,
y_1 = predict(probit_1, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_2 = predict(probit_2, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_3 = predict(probit_3, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_4 = predict(probit_4, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response")) %>%
pivot_longer(-c(age, age_2, age_3, age_4))
prediction
prediction %>%
ggplot(aes(y = value, x = age, color = name)) +
geom_line()+
prediction %>%
ggplot(aes(y = value, x = age, color = name)) +
geom_line()
prediction %>%
ggplot(aes(y = value, x = age, color = name)) +
geom_line()
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y=y, x = age))
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y=y, x = age)) +
geom_line(aes(y = value, x = age, color = name)) +
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y=y, x = age)) +
geom_line(aes(y = value, x = age, color = name))
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y=y, x = age)) +
geom_line(aes(y = value, x = age, color = name))
stargazer(probit_1, probit_2, probit_3, probit_4,
se = list(NULL, robust_se_1, robust_se_2, robust_se_3, robust_se_4),
omit.stat = "f")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(xlsx)
library(lmtest)
library(sandwich)
library(margins)
library(stargazer)
sample_25_17 <- cps09mar %>%
filter(female == 1,
education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3),
age_40 = age * as.numeric(age > 40))
empirical_probabilities  <- sample_25_17 %>%
group_by(age) %>%
summarise(y = mean(y))
empirical_probabilities %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x)
probit_1 <- glm(y ~ age,
family = binomial(link = "probit"),
data = sample_25_17)
probit_2 <- glm(y ~ age + I(age^2),
family = binomial(link = "probit"),
data = sample_25_17)
probit_3 <- glm(y ~ age + I(age^2) + I(age^3),
family = binomial(link = "probit"),
data = sample_25_17)
probit_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"),
data = sample_25_17)
robust_se_1 <- sqrt(diag(vcovHC(probit_1, type = "HC1")))
robust_se_2 <- sqrt(diag(vcovHC(probit_2, type = "HC1")))
robust_se_3 <- sqrt(diag(vcovHC(probit_3, type = "HC1")))
robust_se_4 <- sqrt(diag(vcovHC(probit_4, type = "HC1")))
stargazer(probit_1, probit_2, probit_3, probit_4,
se = list(NULL, robust_se_1, robust_se_2, robust_se_3, robust_se_4),
omit.stat = "f")
coeftest(probit_1, vcov. = vcovHC, type = "HC1")
margins_summary(probit) %>% kable(digits = 4)
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(age_2 = age^2,
age_3 = age^3,
age_4 = age^4,
y_1 = predict(probit_1, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_2 = predict(probit_2, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_3 = predict(probit_3, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response"),
y_4 = predict(probit_4, list(age = age, `I(age^2)` = age_2, `I(age^3)` = age_3,`I(age^4)` = age_4), type = "response")) %>%
pivot_longer(-c(age, age_2, age_3, age_4))
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y=y, x = age)) +
geom_line(aes(y = value, x = age, color = name))
margins_summary(probit_1)
bind_rows(margins_summary(probit_1), margins_summary(probit_1), margins_summary(probit_1), margins_summary(probit_1)) %>% kable(digits = 4)
bind_rows(margins_summary(probit_1),
margins_summary(probit_2),
margins_summary(probit_3),
margins_summary(probit_4)) %>%
mutate(order = 1:4) %>%
kable(digits = 4)
order_2 = predict(series_2, list(age = age,
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(age_2 = age^2,
age_3 = age^3,
age_4 = age^4,
order_1 = predict(series_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age),
type = "response"),
order_3 = predict(series_3, list(age = age, `I(age^2)` = age_2,
`I(age^3)` = age_3),
type = "response"),
order_4 = predict(series_4, list(age = age, `I(age^2)` = age_2,
`I(age^3)` = age_3, `I(age^4)` = age_4),
type = "response")) %>%
pivot_longer(-c(age, age_2, age_3, age_4))
prediction %>%
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(age_2 = age^2,
age_3 = age^3,
age_4 = age^4,
order_1 = predict(series_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age),
type = "response"),
order_3 = predict(series_3, list(age = age, `I(age^2)` = age_2,
`I(age^3)` = age_3),
type = "response"),
order_4 = predict(series_4, list(age = age, `I(age^2)` = age_2,
`I(age^3)` = age_3, `I(age^4)` = age_4),
type = "response")) %>%
pivot_longer(-c(age, age_2, age_3, age_4))
sample_25_17 <- cps09mar %>%
filter(female == 1,
education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3),
age_40 = age * as.numeric(age > 40))
empirical_probabilities  <- sample_25_17 %>%
group_by(age) %>%
summarise(y = mean(y))
empirical_probabilities %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x)
series_1 <- glm(y ~ age, family = binomial(link = "probit"), data = sample_25_17)
series_2 <- glm(y ~ age + I(age^2), family = binomial(link = "probit"),
data = sample_25_17)
series_3 <- glm(y ~ age + I(age^2) + I(age^3), family = binomial(link = "probit"),
data = sample_25_17)
series_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"), data = sample_25_17)
se_1 <- sqrt(diag(vcovHC(series_1, type = "HC1")))
se_2 <- sqrt(diag(vcovHC(series_2, type = "HC1")))
se_3 <- sqrt(diag(vcovHC(series_3, type = "HC1")))
se_4 <- sqrt(diag(vcovHC(series_4, type = "HC1")))
stargazer(series_1, series_2, series_3, series_4,
se = list(se_1, se_2, se_3, se_4),
omit.stat = c("f", "aic", "ll"),
header = FALSE)
bind_rows(margins_summary(series_1),
margins_summary(series_2),
margins_summary(series_3),
margins_summary(series_4)) %>%
mutate(order = 1:4) %>%
kable(digits = 4)
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(age_2 = age^2,
age_3 = age^3,
age_4 = age^4,
order_1 = predict(series_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age),
type = "response"),
order_3 = predict(series_3, list(age = age, `I(age^2)` = age_2,
`I(age^3)` = age_3),
type = "response"),
order_4 = predict(series_4, list(age = age, `I(age^2)` = age_2,
`I(age^3)` = age_3, `I(age^4)` = age_4),
type = "response")) %>%
pivot_longer(-c(age, age_2, age_3, age_4))
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y = y, x = age)) +
geom_line(aes(y = value, x = age, color = name))
sample_25_17 <- cps09mar %>%
filter(female == 1,
education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3),
age_40 = age * as.numeric(age > 40))
empirical_probabilities  <- sample_25_17 %>%
group_by(age) %>%
summarise(y = mean(y))
empirical_probabilities %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x)
series_1 <- glm(y ~ age, family = binomial(link = "probit"), data = sample_25_17)
series_2 <- glm(y ~ age + I(age^2), family = binomial(link = "probit"),
data = sample_25_17)
series_3 <- glm(y ~ age + I(age^2) + I(age^3), family = binomial(link = "probit"),
data = sample_25_17)
series_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"), data = sample_25_17)
se_1 <- sqrt(diag(vcovHC(series_1, type = "HC1")))
se_2 <- sqrt(diag(vcovHC(series_2, type = "HC1")))
se_3 <- sqrt(diag(vcovHC(series_3, type = "HC1")))
se_4 <- sqrt(diag(vcovHC(series_4, type = "HC1")))
stargazer(series_1, series_2, series_3, series_4,
se = list(se_1, se_2, se_3, se_4),
omit.stat = c("f", "aic", "ll"),
header = FALSE)
bind_rows(margins_summary(series_1),
margins_summary(series_2),
margins_summary(series_3),
margins_summary(series_4)) %>%
mutate(order = 1:4) %>%
kable(digits = 4)
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(age_2 = age^2,
age_3 = age^3,
age_4 = age^4,
order_1 = predict(series_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age), type = "response"),
order_3 = predict(series_3, list(age = age), type = "response"),
order_4 = predict(series_4, list(age = age), type = "response")) %>%
pivot_longer(-c(age, age_2, age_3, age_4))
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y = y, x = age)) +
geom_line(aes(y = value, x = age, color = name))
spline_1 <- glm(y ~ age + I(age*(age>40)), family = binomial(link = "probit"), data = sample_25_17)
spline_1
se_1 <- sqrt(diag(vcovHC(spline_1, type = "HC1")))
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(order_1 = predict(spline_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age), type = "response"),
order_3 = predict(series_3, list(age = age), type = "response"),
order_4 = predict(series_4, list(age = age), type = "response")) %>%
pivot_longer(-c(age, age_2, age_3, age_4))
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(order_1 = predict(spline_1, list(age = age), type = "response")) %>%
pivot_longer(-c(age))
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y = y, x = age)) +
geom_line(aes(y = value, x = age, color = name))
sample_25_17 %>% mutate(age_40 = age * as.numeric(age > 40))
sample_25_17 %>% mutate(age_40 = age * as.numeric(age > 40)) %>% glm(y ~ age + age_40, family = binomial(link = "probit"), data = .)
sample_25_17 <- cps09mar %>%
filter(female == 1,
education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3),
age_40 = age * as.numeric(age > 40))
empirical_probabilities  <- sample_25_17 %>%
group_by(age) %>%
summarise(y = mean(y))
empirical_probabilities %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x)
series_1 <- glm(y ~ age, family = binomial(link = "probit"), data = sample_25_17)
series_2 <- glm(y ~ age + I(age^2), family = binomial(link = "probit"),
data = sample_25_17)
series_3 <- glm(y ~ age + I(age^2) + I(age^3), family = binomial(link = "probit"),
data = sample_25_17)
series_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"), data = sample_25_17)
se_1 <- sqrt(diag(vcovHC(series_1, type = "HC1")))
se_2 <- sqrt(diag(vcovHC(series_2, type = "HC1")))
se_3 <- sqrt(diag(vcovHC(series_3, type = "HC1")))
se_4 <- sqrt(diag(vcovHC(series_4, type = "HC1")))
stargazer(series_1, series_2, series_3, series_4,
se = list(se_1, se_2, se_3, se_4),
omit.stat = c("f", "aic", "ll"),
header = FALSE)
bind_rows(margins_summary(series_1),
margins_summary(series_2),
margins_summary(series_3),
margins_summary(series_4)) %>%
mutate(order = 1:4) %>%
kable(digits = 4)
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(age_2 = age^2,
age_3 = age^3,
age_4 = age^4,
order_1 = predict(series_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age), type = "response"),
order_3 = predict(series_3, list(age = age), type = "response"),
order_4 = predict(series_4, list(age = age), type = "response")) %>%
pivot_longer(-c(age, age_2, age_3, age_4))
prediction %>%
ggplot() +
geom_point(data = empirical_probabilities, aes(y = y, x = age)) +
geom_line(aes(y = value, x = age, color = name))
sample_25_17 <- cps09mar %>%
filter(female == 1, education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3),
age_40 = age * as.numeric(age > 40))
erp  <- sample_25_17 %>% group_by(age) %>% summarise(y = mean(y))
erp %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x) +
ggtitle("Estimated Response Probabilities")
series_1 <- glm(y ~ age, family = binomial(link = "probit"), data = sample_25_17)
series_2 <- glm(y ~ age + I(age^2), family = binomial(link = "probit"),
data = sample_25_17)
series_3 <- glm(y ~ age + I(age^2) + I(age^3), family = binomial(link = "probit"),
data = sample_25_17)
series_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"), data = sample_25_17)
se_1 <- sqrt(diag(vcovHC(series_1, type = "HC1")))
se_2 <- sqrt(diag(vcovHC(series_2, type = "HC1")))
se_3 <- sqrt(diag(vcovHC(series_3, type = "HC1")))
se_4 <- sqrt(diag(vcovHC(series_4, type = "HC1")))
stargazer(series_1, series_2, series_3, series_4,
se = list(se_1, se_2, se_3, se_4),
omit.stat = c("f", "aic", "ll"),
header = FALSE, title = "Series Probit Estimates")
bind_rows(margins_summary(series_1),
margins_summary(series_2),
margins_summary(series_3),
margins_summary(series_4)) %>%
mutate(order = 1:4) %>%
kable(digits = 4,
caption = "Average Marginal Effects")
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(order_1 = predict(series_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age), type = "response"),
order_3 = predict(series_3, list(age = age), type = "response"),
order_4 = predict(series_4, list(age = age), type = "response")) %>%
pivot_longer(-age)
prediction %>%
ggplot() +
geom_point(data = erp, aes(y = y, x = age)) +
geom_line(aes(y = value, x = age, color = name)) +
ggtitle("Series Probit Model Comparison")
erp %>%
ggplot(aes(y = count, x = age)) +
geom_point() +
geom_line() +
ggtitle("Number of Observations")
erp  <- sample_25_17 %>% group_by(age) %>% summarise(y = mean(y), count = n())
erp %>%
ggplot(aes(y = count, x = age)) +
geom_point() +
geom_line() +
ggtitle("Number of Observations")
sample_25_17 <- cps09mar %>%
filter(female == 1, education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3))
erp  <- sample_25_17 %>% group_by(age) %>% summarise(y = mean(y), count = n())
erp %>%
ggplot(aes(y = count, x = age)) +
geom_line() +
ggtitle("Number of Observations")
erp %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x) +
ggtitle("Estimated Response Probabilities")
series_1 <- glm(y ~ age, family = binomial(link = "probit"), data = sample_25_17)
series_2 <- glm(y ~ age + I(age^2), family = binomial(link = "probit"),
data = sample_25_17)
series_3 <- glm(y ~ age + I(age^2) + I(age^3), family = binomial(link = "probit"),
data = sample_25_17)
series_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"), data = sample_25_17)
se_1 <- sqrt(diag(vcovHC(series_1, type = "HC1")))
se_2 <- sqrt(diag(vcovHC(series_2, type = "HC1")))
se_3 <- sqrt(diag(vcovHC(series_3, type = "HC1")))
se_4 <- sqrt(diag(vcovHC(series_4, type = "HC1")))
stargazer(series_1, series_2, series_3, series_4,
se = list(se_1, se_2, se_3, se_4),
omit.stat = c("f", "aic", "ll"),
header = FALSE, title = "Series Probit Estimates")
bind_rows(margins_summary(series_1),
margins_summary(series_2),
margins_summary(series_3),
margins_summary(series_4)) %>%
mutate(order = 1:4) %>%
kable(digits = 4,
caption = "Average Marginal Effects")
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(order_1 = predict(series_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age), type = "response"),
order_3 = predict(series_3, list(age = age), type = "response"),
order_4 = predict(series_4, list(age = age), type = "response")) %>%
pivot_longer(-age)
prediction %>%
ggplot() +
geom_point(data = erp, aes(y = y, x = age)) +
geom_line(aes(y = value, x = age, color = name)) +
ggtitle("Series Probit Model Comparison")
sample_25_17 <- cps09mar %>%
filter(female == 1, education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3))
erp  <- sample_25_17 %>% group_by(age) %>% summarise(y = mean(y), count = n())
erp %>%
ggplot(aes(y = count, x = age)) +
geom_bar() +
ggtitle("Number of Observations")
sample_25_17 <- cps09mar %>%
filter(female == 1, education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3))
erp  <- sample_25_17 %>% group_by(age) %>% summarise(y = mean(y), count = n())
erp %>%
ggplot(aes(y = count, x = age)) +
geom_line() +
ggtitle("Number of Observations")
erp %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x) +
ggtitle("Estimated Response Probabilities")
series_1 <- glm(y ~ age, family = binomial(link = "probit"), data = sample_25_17)
series_2 <- glm(y ~ age + I(age^2), family = binomial(link = "probit"),
data = sample_25_17)
series_3 <- glm(y ~ age + I(age^2) + I(age^3), family = binomial(link = "probit"),
data = sample_25_17)
series_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"), data = sample_25_17)
se_1 <- sqrt(diag(vcovHC(series_1, type = "HC1")))
se_2 <- sqrt(diag(vcovHC(series_2, type = "HC1")))
se_3 <- sqrt(diag(vcovHC(series_3, type = "HC1")))
se_4 <- sqrt(diag(vcovHC(series_4, type = "HC1")))
stargazer(series_1, series_2, series_3, series_4,
se = list(se_1, se_2, se_3, se_4),
omit.stat = c("f", "aic", "ll"),
header = FALSE, title = "Series Probit Estimates", float = FALSE)
bind_rows(margins_summary(series_1),
margins_summary(series_2),
margins_summary(series_3),
margins_summary(series_4)) %>%
mutate(order = 1:4) %>%
kable(digits = 4,
caption = "Average Marginal Effects")
prediction <- tibble(age = seq(min(sample_25_17$age),max(sample_25_17$age), 0.01)) %>%
mutate(order_1 = predict(series_1, list(age = age), type = "response"),
order_2 = predict(series_2, list(age = age), type = "response"),
order_3 = predict(series_3, list(age = age), type = "response"),
order_4 = predict(series_4, list(age = age), type = "response")) %>%
pivot_longer(-age)
prediction %>%
ggplot() +
geom_point(data = erp, aes(y = y, x = age)) +
geom_line(aes(y = value, x = age, color = name)) +
ggtitle("Series Probit Model Comparison")
sample_25_17 <- cps09mar %>%
filter(female == 1, education >= 14) %>%
mutate(y = as.numeric(marital %in% 1:3))
erp  <- sample_25_17 %>% group_by(age) %>% summarise(y = mean(y), count = n())
erp %>%
ggplot(aes(y = count, x = age)) +
geom_line() +
ggtitle("Number of Observations")
erp %>%
ggplot(aes(y = y, x = age)) +
geom_point() +
geom_smooth(method = 'loess', formula = y ~ x) +
ggtitle("Estimated Response Probabilities")
series_1 <- glm(y ~ age, family = binomial(link = "probit"), data = sample_25_17)
series_2 <- glm(y ~ age + I(age^2), family = binomial(link = "probit"),
data = sample_25_17)
series_3 <- glm(y ~ age + I(age^2) + I(age^3), family = binomial(link = "probit"),
data = sample_25_17)
series_4 <- glm(y ~ age + I(age^2) + I(age^3) + I(age^4),
family = binomial(link = "probit"), data = sample_25_17)
se_1 <- sqrt(diag(vcovHC(series_1, type = "HC1")))
se_2 <- sqrt(diag(vcovHC(series_2, type = "HC1")))
se_3 <- sqrt(diag(vcovHC(series_3, type = "HC1")))
se_4 <- sqrt(diag(vcovHC(series_4, type = "HC1")))
stargazer(series_1, series_2, series_3, series_4,
se = list(se_1, se_2, se_3, se_4),
omit.stat = c("f", "aic", "ll"),
header = FALSE, title = "Series Probit Estimates", float = FALSE)
bind_rows(margins_summary(series_1),
margins_summary(series_2),
margins_summary(series_3),
margins_summary(series_4)) %>%
mutate(order = 1:4) %>%
kable(digits = 4,
caption = "Average Marginal Effects")
erp
erp %>% filter(count < 100)
erp %>% filter(count < 25)
erp %>% filter(count < 10)
erp %>% filter(count > 10) %>% pull(age)
glm(y ~ age, family = binomial(link = "probit"), data = sample_25_17)
glm(I(1-y) ~ age, family = binomial(link = "probit"), data = sample_25_17)
sample_25_17 %>% mutate(y_2 = 1 - y) %>% glm(y_2 ~ age, family = binomial(link = "probit"), data = )
sample_25_17 %>% mutate(y_2 = 1 - y) %>% glm(y_2 ~ age, family = binomial(link = "probit"), data = .)
